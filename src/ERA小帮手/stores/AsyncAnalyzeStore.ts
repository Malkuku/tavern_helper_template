import { defineStore } from 'pinia';export const useAsyncAnalyzeStore = defineStore('KatAsyncAnalyze', () => {  //是否为分布计算  const isAsync = ref(false);  //是否为分析模式  const isUpdateEra = ref(false);  const modelSource = ref('sample'); //sample | external | profile  const customModelSettings = ref({    baseURL :  '',    apiKey : '',    modelName :  '',    temperature: 0.7,    frequencyPenalty: 0,    presencePenalty: 0,    maxTokens: 20000  })  //预设模型设置  const profileSetting = ref('');  /**   * 尝试从变量中获取模型设置   */  const getModelSettings = async () => {    const variables = getVariables({type: 'script', script_id: getScriptId()});    const era_api_config = variables.era_api_config;    if (era_api_config) {      modelSource.value = era_api_config.modelSource;      customModelSettings.value = era_api_config.customModelSettings;      isAsync.value = era_api_config.isAsync;      profileSetting.value = era_api_config.profileSetting;    }    console.log('获取模型设置: ',era_api_config);  }  /**   * 保存模型设置   */  const saveModelSettings = async () => {    const saveVariables = {      isAsync : isAsync.value,      modelSource: modelSource.value,      customModelSettings: customModelSettings.value,      profileSetting: profileSetting.value    };    const cleaned = JSON.parse(JSON.stringify(saveVariables));    await updateVariablesWith(      vars => ({        ...vars,        era_api_config: cleaned      }),      {type: 'script', script_id: getScriptId()}    )  }  /**   * 清空模型设置   */  const clearModelSettings = async () => {    modelSource.value = 'sample';    customModelSettings.value = {      baseURL :  '',      apiKey : '',      modelName :  '',      temperature: 0.7,      frequencyPenalty: 0,      presencePenalty: 0,      maxTokens: 20000    }    profileSetting.value = '';    await saveModelSettings();  }  return {    isAsync,    isUpdateEra,    modelSource,    customModelSettings,    profileSetting,    getModelSettings,    saveModelSettings,    clearModelSettings  };});