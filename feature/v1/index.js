import*as e from'https://testingcf.jsdelivr.net/npm/pinia/+esm';var n={331:(e,n,t)=>{t.r(n),t.d(n,{default:()=>l});var a=t(1314),o=t.n(a),A=t(5378),r=t.n(A)()(o());r.push([e.id,'.stat-data-editor[data-v-d7550ac6]{display:flex;flex-direction:column;height:100%;background:#fff;border-radius:12px;overflow:hidden}input[data-v-d7550ac6],select[data-v-d7550ac6],textarea[data-v-d7550ac6],option[data-v-d7550ac6]{background:#f8fafc !important;color:#1e293b !important;border-color:#e2e8f0 !important}select option[data-v-d7550ac6]{background:#f8fafc !important;color:#1e293b !important}input[data-v-d7550ac6]:focus,select[data-v-d7550ac6]:focus,textarea[data-v-d7550ac6]:focus{border-color:#6366f1 !important;box-shadow:0 0 0 3px rgba(99,102,241,.1) !important}input[data-v-d7550ac6]:disabled,select[data-v-d7550ac6]:disabled,textarea[data-v-d7550ac6]:disabled{background:#f1f5f9 !important;color:#94a3b8 !important;cursor:not-allowed}input[data-v-d7550ac6]::placeholder,textarea[data-v-d7550ac6]::placeholder{color:#94a3b8 !important;opacity:1}.editor-toolbar[data-v-d7550ac6]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:linear-gradient(135deg,#f8fafc 0%,#f1f5f9 100%);border-bottom:1px solid #e2e8f0}.toolbar-left[data-v-d7550ac6]{display:flex;gap:8px}.toolbar-btn[data-v-d7550ac6]{display:flex;align-items:center;gap:4px;padding:6px 10px;border:none;border-radius:6px;background:#fff;color:#475569;font-size:12px;font-weight:500;cursor:pointer;transition:all .2s ease;box-shadow:0 1px 2px rgba(0,0,0,.1)}.toolbar-btn[data-v-d7550ac6]:hover:not(:disabled){background:#f1f5f9;transform:translateY(-1px);box-shadow:0 2px 4px rgba(0,0,0,.15)}.toolbar-btn[data-v-d7550ac6]:disabled{opacity:.5;cursor:not-allowed}.toolbar-btn .icon[data-v-d7550ac6]{width:12px;height:12px}.toolbar-right[data-v-d7550ac6]{display:flex;align-items:center;gap:12px}.change-indicator[data-v-d7550ac6]{display:flex;align-items:center;gap:6px;padding:4px 8px;background:#fef3c7;border:1px solid #f59e0b;border-radius:6px;font-size:12px;color:#92400e}.change-indicator .dot[data-v-d7550ac6]{width:6px;height:6px;background:#f59e0b;border-radius:50%;animation:pulse-d7550ac6 2s infinite}@keyframes pulse-d7550ac6{0%,100%{opacity:1}50%{opacity:.5}}.status-text[data-v-d7550ac6]{font-size:12px;color:#64748b}.status-text.status-loading[data-v-d7550ac6]{color:#6366f1}.data-container[data-v-d7550ac6]{flex:1;overflow:hidden;position:relative}.loading-container[data-v-d7550ac6],.empty-container[data-v-d7550ac6]{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;color:#64748b}.loading-container .spinner[data-v-d7550ac6]{width:40px;height:40px;border:3px solid #e2e8f0;border-top-color:#6366f1;border-radius:50%;animation:spin-d7550ac6 1s linear infinite}@keyframes spin-d7550ac6{to{transform:rotate(360deg)}}.empty-container .empty-icon[data-v-d7550ac6]{width:64px;height:64px;opacity:.5}.empty-text[data-v-d7550ac6]{font-size:14px}.empty-btn[data-v-d7550ac6]{padding:8px 16px;background:#6366f1;color:#fff;border:none;border-radius:6px;font-size:14px;cursor:pointer;transition:all .2s ease}.empty-btn[data-v-d7550ac6]:hover{background:#4f46e5;transform:translateY(-1px)}.json-editor-wrapper[data-v-d7550ac6]{height:100%;display:flex;flex-direction:column;overflow-x:auto}.json-tree[data-v-d7550ac6]{padding:16px;min-width:100%}.edit-mode-selector[data-v-d7550ac6]{padding:12px 16px;background:#f8fafc;border-bottom:1px solid #e2e8f0;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px}.mode-buttons[data-v-d7550ac6]{display:flex;gap:8px}.mode-btn[data-v-d7550ac6]{display:flex;align-items:center;gap:4px;padding:4px 8px;border:1px solid #e2e8f0;background:#fff;border-radius:6px;font-size:11px;color:#475569;cursor:pointer;transition:all .2s ease}.mode-btn[data-v-d7550ac6]:hover{background:#f1f5f9;border-color:#cbd5e1}.mode-btn.active[data-v-d7550ac6]{background:#6366f1;border-color:#6366f1;color:#fff}.mode-btn .mode-icon[data-v-d7550ac6]{width:14px;height:14px}.tool-btn[data-v-d7550ac6]{display:flex;align-items:center;gap:4px;padding:4px 8px;border:1px solid #e2e8f0;background:#fff;border-radius:6px;font-size:11px;color:#475569;cursor:pointer;transition:all .2s ease}.tool-btn[data-v-d7550ac6]:hover:not(:disabled){background:#f1f5f9;border-color:#cbd5e1}.tool-btn[data-v-d7550ac6]:disabled{opacity:.5;cursor:not-allowed}.tool-btn.danger[data-v-d7550ac6]{color:#dc2626;border-color:#fecaca}.tool-btn.danger[data-v-d7550ac6]:hover{background:#fef2f2;border-color:#fca5a5}.tool-btn .tool-icon[data-v-d7550ac6]{width:12px;height:12px}.edit-tools[data-v-d7550ac6]{display:flex;margin-top:5px;margin-bottom:5px;gap:6px}.tree-editor[data-v-d7550ac6]{flex:1;overflow-y:auto;overflow-x:auto;width:100%;padding-top:10px}.tree-editor[data-v-d7550ac6]::-webkit-scrollbar{width:8px;height:8px}.tree-editor[data-v-d7550ac6]::-webkit-scrollbar-track{background:#f1f5f9}.tree-editor[data-v-d7550ac6]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:4px}.tree-editor[data-v-d7550ac6]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.json-tree[data-v-d7550ac6]{padding:16px;width:100%;min-width:-moz-fit-content;min-width:fit-content}.raw-editor[data-v-d7550ac6]{flex:1;display:flex;flex-direction:column;overflow:hidden;background:#f8fafc !important;color:#1e293b !important;min-height:350px}.editor-header[data-v-d7550ac6]{padding:12px 16px;background:#f1f5f9 !important;border-bottom:1px solid #e2e8f0;display:flex;justify-content:space-between;align-items:center;color:#1e293b !important}.editor-info[data-v-d7550ac6]{font-size:14px;color:#64748b !important}.editor-size[data-v-d7550ac6]{font-size:13px;color:#94a3b8 !important;font-family:monospace}.json-editor[data-v-d7550ac6]{flex:1;padding:16px;outline:none;resize:none;font-family:"SF Mono",Monaco,"Cascadia Code",monospace;font-size:14px;line-height:1.5;background:#fff !important;color:#1e293b !important;border:1px solid #e2e8f0 !important;border-radius:6px;margin:16px;box-shadow:inset 0 1px 3px rgba(0,0,0,.1);overflow:auto;white-space:pre;min-width:min-content}.json-editor[data-v-d7550ac6]:focus{border-color:#6366f1 !important;box-shadow:0 0 0 3px rgba(99,102,241,.1) !important}.json-editor[data-v-d7550ac6]::-webkit-scrollbar{width:8px}.json-editor[data-v-d7550ac6]::-webkit-scrollbar-track{background:#f1f5f9}.json-editor[data-v-d7550ac6]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:4px}.json-editor[data-v-d7550ac6]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.json-editor[data-v-d7550ac6]::placeholder{color:#94a3b8 !important}.json-error[data-v-d7550ac6]{padding:12px 16px;background:#fef2f2;border-top:1px solid #fecaca;color:#dc2626;font-size:14px;display:flex;align-items:center;gap:8px}.json-error .error-icon[data-v-d7550ac6]{width:16px;height:16px;flex-shrink:0}.modal-overlay[data-v-d7550ac6]{position:absolute;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1000;backdrop-filter:blur(2px)}.modal[data-v-d7550ac6]{background:#fff;border-radius:12px;width:90%;max-width:450px;max-height:80vh;overflow-y:auto;box-shadow:0 20px 60px rgba(0,0,0,.3);animation:modalSlideIn-d7550ac6 .3s ease}@keyframes modalSlideIn-d7550ac6{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.modal h3[data-v-d7550ac6]{margin:0;padding:24px 24px 16px;font-size:18px;font-weight:600;color:#1e293b;border-bottom:1px solid #e2e8f0}.modal-body[data-v-d7550ac6]{padding:24px}.form-group[data-v-d7550ac6]{margin-bottom:20px}.form-group label[data-v-d7550ac6]{display:block;margin-bottom:6px;font-size:14px;font-weight:500;color:#475569}.form-input[data-v-d7550ac6],.form-select[data-v-d7550ac6],.form-textarea[data-v-d7550ac6]{width:100%;padding:10px 12px;border:1px solid #e2e8f0;border-radius:8px;font-size:14px;color:#1e293b !important;background:#f8fafc !important;transition:all .2s ease}.form-input[data-v-d7550ac6]:focus,.form-select[data-v-d7550ac6]:focus,.form-textarea[data-v-d7550ac6]:focus{outline:none;border-color:#6366f1;box-shadow:0 0 0 3px rgba(99,102,241,.1)}.form-input[data-v-d7550ac6]::placeholder,.form-select[data-v-d7550ac6]::placeholder,.form-textarea[data-v-d7550ac6]::placeholder{color:#94a3b8 !important}.form-select option[data-v-d7550ac6]{background:#f8fafc !important;color:#1e293b !important}.boolean-options[data-v-d7550ac6]{display:flex;gap:16px}.boolean-option[data-v-d7550ac6]{display:flex;align-items:center;gap:6px;cursor:pointer;padding:8px 12px;border-radius:6px;border:1px solid #e2e8f0;background:#f8fafc !important;color:#1e293b !important;transition:all .2s ease}.boolean-option[data-v-d7550ac6]:hover{background:#f1f5f9 !important;border-color:#cbd5e1}.boolean-option input[data-v-d7550ac6]{margin:0}.boolean-option span[data-v-d7550ac6]{font-size:14px;color:#1e293b !important}.null-info[data-v-d7550ac6]{display:flex;align-items:center;gap:8px;padding:12px;background:#f8fafc;border-radius:8px;border:1px dashed #cbd5e1}.null-info .null-icon[data-v-d7550ac6]{width:16px;height:16px;color:#64748b}.null-info span[data-v-d7550ac6]{font-size:14px;color:#64748b}.json-editor-container[data-v-d7550ac6]{border:1px solid #e2e8f0;border-radius:8px;overflow:hidden;background:#f8fafc !important}.json-editor-header[data-v-d7550ac6]{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;background:#f1f5f9 !important;border-bottom:1px solid #e2e8f0}.json-editor-header span[data-v-d7550ac6]{font-size:12px;font-weight:500;color:#1e293b !important}.btn-small[data-v-d7550ac6]{padding:4px 8px;border:1px solid #e2e8f0;border-radius:4px;background:#fff;cursor:pointer;transition:all .2s ease}.btn-small[data-v-d7550ac6]:hover{background:#f1f5f9;border-color:#cbd5e1}.btn-small .format-icon[data-v-d7550ac6]{width:12px;height:12px;color:#64748b}.json-editor-input[data-v-d7550ac6]{width:100%;padding:12px;border:none;outline:none;resize:vertical;font-family:"SF Mono",Monaco,"Cascadia Code",monospace;font-size:13px;line-height:1.5;background:#fff !important;color:#1e293b !important;min-height:120px;background:#fff !important;color:#1e293b !important}.json-editor-input[data-v-d7550ac6]:focus{outline:none}.json-editor-input[data-v-d7550ac6]::placeholder{color:#94a3b8 !important}.json-error[data-v-d7550ac6],.json-success[data-v-d7550ac6]{display:flex;align-items:center;gap:6px;padding:8px 12px;font-size:12px;border-top:1px solid #fecaca}.json-error[data-v-d7550ac6]{background:#fef2f2;color:#dc2626}.json-error .error-icon[data-v-d7550ac6]{width:12px;height:12px;flex-shrink:0}.json-success[data-v-d7550ac6]{background:#f0fdf4;color:#16a34a;border-color:#bbf7d0}.json-success .success-icon[data-v-d7550ac6]{width:12px;height:12px;flex-shrink:0}.modal-actions[data-v-d7550ac6]{padding:16px 24px 24px;border-top:1px solid #e2e8f0;display:flex;justify-content:flex-end;gap:12px}.btn[data-v-d7550ac6]{padding:10px 20px;border:1px solid #e2e8f0;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;background:#fff;color:#475569}.btn[data-v-d7550ac6]:hover{background:#f8fafc;border-color:#cbd5e1}.btn[data-v-d7550ac6]:disabled{opacity:.5;cursor:not-allowed}.btn.primary[data-v-d7550ac6]{background:#6366f1;border-color:#6366f1;color:#fff}.btn.primary[data-v-d7550ac6]:hover:not(:disabled){background:#4f46e5;border-color:#4f46e5}@media (prefers-color-scheme:dark){.stat-data-editor[data-v-d7550ac6],.stat-data-editor[data-v-d7550ac6] *{background:#f8fafc !important;color:#1e293b !important}input[data-v-d7550ac6],select[data-v-d7550ac6],textarea[data-v-d7550ac6],option[data-v-d7550ac6],.form-input[data-v-d7550ac6],.form-select[data-v-d7550ac6],.form-textarea[data-v-d7550ac6],.boolean-option[data-v-d7550ac6]{background:#f8fafc !important;color:#1e293b !important;border-color:#e2e8f0 !important}select option[data-v-d7550ac6],.form-select option[data-v-d7550ac6]{background:#f8fafc !important;color:#1e293b !important}.modal[data-v-d7550ac6]{background:#fff !important;color:#1e293b !important}[data-v-d7550ac6] select option{background:#f8fafc !important;color:#1e293b !important}.json-editor[data-v-d7550ac6],.json-editor-input[data-v-d7550ac6],.raw-editor[data-v-d7550ac6],.tree-editor[data-v-d7550ac6]{background:#fff !important;color:#1e293b !important}.btn[data-v-d7550ac6],.toolbar-btn[data-v-d7550ac6],.mode-btn[data-v-d7550ac6],.tool-btn[data-v-d7550ac6]{background:#fff !important;color:#1e293b !important;border-color:#e2e8f0 !important}.btn.primary[data-v-d7550ac6]{background:#6366f1 !important;color:#fff !important;border-color:#6366f1 !important}.mode-btn.active[data-v-d7550ac6]{background:#6366f1 !important;color:#fff !important}}[data-v-d7550ac6] .json-node-editor input,[data-v-d7550ac6] .json-node-editor select,[data-v-d7550ac6] .json-node-editor textarea,[data-v-d7550ac6] .json-node-editor option{background:#f8fafc !important;color:#1e293b !important;border-color:#e2e8f0 !important}[data-v-d7550ac6] .json-node-editor select option{background:#f8fafc !important;color:#1e293b !important}@media (max-width:640px){.editor-toolbar[data-v-d7550ac6]{flex-direction:column;gap:12px;align-items:stretch}.toolbar-right[data-v-d7550ac6]{justify-content:space-between}.edit-mode-selector[data-v-d7550ac6]{flex-direction:column;align-items:stretch}.mode-buttons[data-v-d7550ac6],.edit-tools[data-v-d7550ac6]{flex-wrap:wrap}.editor-header[data-v-d7550ac6]{flex-direction:column;gap:8px;align-items:flex-start}.modal[data-v-d7550ac6]{width:95%;margin:10px}.modal-actions[data-v-d7550ac6]{flex-direction:column}.btn[data-v-d7550ac6]{width:100%}}','',{version:3,sources:['webpack://./src/ERA助手/UI/view/EraDataEditor.vue'],names:[],mappings:'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',sourcesContent:['\n.stat-data-editor {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  background: white;\n  border-radius: 12px;\n  overflow: hidden;\n}\n\n// 强制所有表单元素使用浅色主题\n/* 强制浅色输入框和选择框 */\ninput,\nselect,\ntextarea,\noption {\n  background: #f8fafc !important;\n  color: #1e293b !important;\n  border-color: #e2e8f0 !important;\n}\n\n/* 选择框选项强制浅色 */\nselect option {\n  background: #f8fafc !important;\n  color: #1e293b !important;\n}\n\n/* 输入框聚焦状态 */\ninput:focus,\nselect:focus,\ntextarea:focus {\n  border-color: #6366f1 !important;\n  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1) !important;\n}\n\n/* 只读和禁用状态 */\ninput:disabled,\nselect:disabled,\ntextarea:disabled {\n  background: #f1f5f9 !important;\n  color: #94a3b8 !important;\n  cursor: not-allowed;\n}\n\n/* 占位符颜色 */\ninput::placeholder,\ntextarea::placeholder {\n  color: #94a3b8 !important;\n  opacity: 1;\n}\n\n// 工具栏\n.editor-toolbar {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 16px;\n  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);\n  border-bottom: 1px solid #e2e8f0;\n}\n\n.toolbar-left {\n  display: flex;\n  gap: 8px;\n}\n\n.toolbar-btn {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  padding: 6px 10px;\n  border: none;\n  border-radius: 6px;\n  background: white;\n  color: #475569;\n  font-size: 12px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n\n  &:hover:not(:disabled) {\n    background: #f1f5f9;\n    transform: translateY(-1px);\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n\n  .icon {\n    width: 12px;\n    height: 12px;\n  }\n}\n\n.toolbar-right {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.change-indicator {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 4px 8px;\n  background: #fef3c7;\n  border: 1px solid #f59e0b;\n  border-radius: 6px;\n  font-size: 12px;\n  color: #92400e;\n\n  .dot {\n    width: 6px;\n    height: 6px;\n    background: #f59e0b;\n    border-radius: 50%;\n    animation: pulse 2s infinite;\n  }\n}\n\n@keyframes pulse {\n  0%,\n  100% {\n    opacity: 1;\n  }\n  50% {\n    opacity: 0.5;\n  }\n}\n\n.status-text {\n  font-size: 12px;\n  color: #64748b;\n\n  &.status-loading {\n    color: #6366f1;\n  }\n}\n\n// 数据容器\n.data-container {\n  flex: 1;\n  overflow: hidden;\n  position: relative;\n}\n\n.loading-container,\n.empty-container {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  gap: 12px;\n  color: #64748b;\n}\n\n.loading-container .spinner {\n  width: 40px;\n  height: 40px;\n  border: 3px solid #e2e8f0;\n  border-top-color: #6366f1;\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n.empty-container .empty-icon {\n  width: 64px;\n  height: 64px;\n  opacity: 0.5;\n}\n\n.empty-text {\n  font-size: 14px;\n}\n\n.empty-btn {\n  padding: 8px 16px;\n  background: #6366f1;\n  color: white;\n  border: none;\n  border-radius: 6px;\n  font-size: 14px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: #4f46e5;\n    transform: translateY(-1px);\n  }\n}\n\n.json-editor-wrapper {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  // 添加横向滚动支持\n  overflow-x: auto;\n}\n\n.json-tree {\n  padding: 16px;\n  // 确保内容宽度适应其子元素\n  min-width: 100%;\n}\n\n// 编辑模式选择器\n.edit-mode-selector {\n  padding: 12px 16px;\n  background: #f8fafc;\n  border-bottom: 1px solid #e2e8f0;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  flex-wrap: wrap;\n  gap: 12px;\n}\n\n.mode-buttons {\n  display: flex;\n  gap: 8px;\n}\n\n.mode-btn {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  padding: 4px 8px;\n  border: 1px solid #e2e8f0;\n  background: white;\n  border-radius: 6px;\n  font-size: 11px;\n  color: #475569;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: #f1f5f9;\n    border-color: #cbd5e1;\n  }\n\n  &.active {\n    background: #6366f1;\n    border-color: #6366f1;\n    color: white;\n  }\n\n  .mode-icon {\n    width: 14px;\n    height: 14px;\n  }\n}\n\n.tool-btn {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  padding: 4px 8px;\n  border: 1px solid #e2e8f0;\n  background: white;\n  border-radius: 6px;\n  font-size: 11px;\n  color: #475569;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover:not(:disabled) {\n    background: #f1f5f9;\n    border-color: #cbd5e1;\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n\n  &.danger {\n    color: #dc2626;\n    border-color: #fecaca;\n\n    &:hover {\n      background: #fef2f2;\n      border-color: #fca5a5;\n    }\n  }\n\n  .tool-icon {\n    width: 12px;\n    height: 12px;\n  }\n}\n\n.edit-tools {\n  display: flex;\n  margin-top: 5px;\n  margin-bottom: 5px;\n  gap: 6px;\n}\n\n// 树形编辑器\n.tree-editor {\n  flex: 1;\n  overflow-y: auto;\n  overflow-x: auto;\n  width: 100%;\n  // 确保有足够的空间显示节点上方的按钮\n  padding-top: 10px;\n\n  // 添加滚动条样式\n  &::-webkit-scrollbar {\n    width: 8px;\n    height: 8px;\n  }\n  &::-webkit-scrollbar-track {\n    background: #f1f5f9;\n  }\n  &::-webkit-scrollbar-thumb {\n    background: #cbd5e1;\n    border-radius: 4px;\n  }\n  &::-webkit-scrollbar-thumb:hover {\n    background: #94a3b8;\n  }\n}\n\n.json-tree {\n  padding: 16px;\n  width: 100%;\n  // 添加最小宽度以支持横向滚动\n  min-width: fit-content;\n}\n\n// 原始JSON编辑器\n.raw-editor {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  background: #f8fafc !important;\n  color: #1e293b !important;\n  min-height: 350px;\n}\n\n.editor-header {\n  padding: 12px 16px;\n  background: #f1f5f9 !important;\n  border-bottom: 1px solid #e2e8f0;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  color: #1e293b !important;\n}\n\n.editor-info {\n  font-size: 14px;\n  color: #64748b !important;\n}\n\n.editor-size {\n  font-size: 13px;\n  color: #94a3b8 !important;\n  font-family: monospace;\n}\n\n.json-editor {\n  flex: 1;\n  padding: 16px;\n  outline: none;\n  resize: none;\n  font-family: \'SF Mono\', Monaco, \'Cascadia Code\', monospace;\n  font-size: 14px;\n  line-height: 1.5;\n  background: #ffffff !important;\n  color: #1e293b !important;\n  border: 1px solid #e2e8f0 !important;\n  border-radius: 6px;\n  margin: 16px;\n  box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);\n  overflow: auto; // 添加滚动\n  white-space: pre; // 保持空白字符\n  min-width: min-content; // 确保内容不会被压缩\n\n  &:focus {\n    border-color: #6366f1 !important;\n    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1) !important;\n  }\n\n  &::-webkit-scrollbar {\n    width: 8px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: #f1f5f9;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: #cbd5e1;\n    border-radius: 4px;\n\n    &:hover {\n      background: #94a3b8;\n    }\n  }\n\n  &::placeholder {\n    color: #94a3b8 !important;\n  }\n}\n\n.json-error {\n  padding: 12px 16px;\n  background: #fef2f2;\n  border-top: 1px solid #fecaca;\n  color: #dc2626;\n  font-size: 14px;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n\n  .error-icon {\n    width: 16px;\n    height: 16px;\n    flex-shrink: 0;\n  }\n}\n\n// 添加字段模态框样式\n.modal-overlay {\n  position: absolute;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n  backdrop-filter: blur(2px);\n}\n\n.modal {\n  background: white;\n  border-radius: 12px;\n  width: 90%;\n  max-width: 450px;\n  max-height: 80vh;\n  overflow-y: auto;\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n  animation: modalSlideIn 0.3s ease;\n}\n\n@keyframes modalSlideIn {\n  from {\n    opacity: 0;\n    transform: translateY(-20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n.modal h3 {\n  margin: 0;\n  padding: 24px 24px 16px;\n  font-size: 18px;\n  font-weight: 600;\n  color: #1e293b;\n  border-bottom: 1px solid #e2e8f0;\n}\n\n.modal-body {\n  padding: 24px;\n}\n\n.form-group {\n  margin-bottom: 20px;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 6px;\n  font-size: 14px;\n  font-weight: 500;\n  color: #475569;\n}\n\n.form-input,\n.form-select,\n.form-textarea {\n  width: 100%;\n  padding: 10px 12px;\n  border: 1px solid #e2e8f0;\n  border-radius: 8px;\n  font-size: 14px;\n  color: #1e293b !important;\n  background: #f8fafc !important;\n  transition: all 0.2s ease;\n\n  &:focus {\n    outline: none;\n    border-color: #6366f1;\n    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);\n  }\n\n  &::placeholder {\n    color: #94a3b8 !important;\n  }\n}\n\n/* 强制选择框选项使用浅色 */\n.form-select option {\n  background: #f8fafc !important;\n  color: #1e293b !important;\n}\n\n// 布尔值选项\n.boolean-options {\n  display: flex;\n  gap: 16px;\n}\n\n.boolean-option {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  cursor: pointer;\n  padding: 8px 12px;\n  border-radius: 6px;\n  border: 1px solid #e2e8f0;\n  background: #f8fafc !important;\n  color: #1e293b !important;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: #f1f5f9 !important;\n    border-color: #cbd5e1;\n  }\n\n  input {\n    margin: 0;\n  }\n\n  span {\n    font-size: 14px;\n    color: #1e293b !important;\n  }\n}\n\n// 空值显示\n.null-info {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px;\n  background: #f8fafc;\n  border-radius: 8px;\n  border: 1px dashed #cbd5e1;\n\n  .null-icon {\n    width: 16px;\n    height: 16px;\n    color: #64748b;\n  }\n\n  span {\n    font-size: 14px;\n    color: #64748b;\n  }\n}\n\n// JSON编辑器容器\n.json-editor-container {\n  border: 1px solid #e2e8f0;\n  border-radius: 8px;\n  overflow: hidden;\n  background: #f8fafc !important;\n}\n\n.json-editor-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 8px 12px;\n  background: #f1f5f9 !important;\n  border-bottom: 1px solid #e2e8f0;\n\n  span {\n    font-size: 12px;\n    font-weight: 500;\n    color: #1e293b !important;\n  }\n}\n\n.btn-small {\n  padding: 4px 8px;\n  border: 1px solid #e2e8f0;\n  border-radius: 4px;\n  background: white;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: #f1f5f9;\n    border-color: #cbd5e1;\n  }\n\n  .format-icon {\n    width: 12px;\n    height: 12px;\n    color: #64748b;\n  }\n}\n\n.json-editor-input {\n  width: 100%;\n  padding: 12px;\n  border: none;\n  outline: none;\n  resize: vertical;\n  font-family: \'SF Mono\', Monaco, \'Cascadia Code\', monospace;\n  font-size: 13px;\n  line-height: 1.5;\n  background: white !important;\n  color: #1e293b !important;\n  min-height: 120px;\n  background: white !important;\n  color: #1e293b !important;\n\n  &:focus {\n    outline: none;\n  }\n\n  &::placeholder {\n    color: #94a3b8 !important;\n  }\n}\n\n.json-error,\n.json-success {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 8px 12px;\n  font-size: 12px;\n  border-top: 1px solid #fecaca;\n}\n\n.json-error {\n  background: #fef2f2;\n  color: #dc2626;\n\n  .error-icon {\n    width: 12px;\n    height: 12px;\n    flex-shrink: 0;\n  }\n}\n\n.json-success {\n  background: #f0fdf4;\n  color: #16a34a;\n  border-color: #bbf7d0;\n\n  .success-icon {\n    width: 12px;\n    height: 12px;\n    flex-shrink: 0;\n  }\n}\n\n.modal-actions {\n  padding: 16px 24px 24px;\n  border-top: 1px solid #e2e8f0;\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n}\n\n.btn {\n  padding: 10px 20px;\n  border: 1px solid #e2e8f0;\n  border-radius: 8px;\n  font-size: 14px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  background: white;\n  color: #475569;\n\n  &:hover {\n    background: #f8fafc;\n    border-color: #cbd5e1;\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n}\n\n.btn.primary {\n  background: #6366f1;\n  border-color: #6366f1;\n  color: white;\n\n  &:hover:not(:disabled) {\n    background: #4f46e5;\n    border-color: #4f46e5;\n  }\n}\n\n/* 深色模式强制覆盖 */\n@media (prefers-color-scheme: dark) {\n  /* 强制整个编辑器使用浅色主题 */\n  .stat-data-editor,\n  .stat-data-editor * {\n    background: #f8fafc !important;\n    color: #1e293b !important;\n  }\n\n  /* 强制所有输入框和选择框使用浅色 */\n  input,\n  select,\n  textarea,\n  option,\n  .form-input,\n  .form-select,\n  .form-textarea,\n  .boolean-option {\n    background: #f8fafc !important;\n    color: #1e293b !important;\n    border-color: #e2e8f0 !important;\n  }\n\n  /* 强制选择框选项使用浅色 */\n  select option,\n  .form-select option {\n    background: #f8fafc !important;\n    color: #1e293b !important;\n  }\n\n  /* 强制模态框使用浅色 */\n  .modal {\n    background: white !important;\n    color: #1e293b !important;\n  }\n\n  /* 强制下拉框选项颜色 */\n  :deep(select option) {\n    background: #f8fafc !important;\n    color: #1e293b !important;\n  }\n\n  /* 强制编辑器区域使用浅色 */\n  .json-editor,\n  .json-editor-input,\n  .raw-editor,\n  .tree-editor {\n    background: #ffffff !important;\n    color: #1e293b !important;\n  }\n\n  /* 强制按钮使用浅色样式 */\n  .btn,\n  .toolbar-btn,\n  .mode-btn,\n  .tool-btn {\n    background: white !important;\n    color: #1e293b !important;\n    border-color: #e2e8f0 !important;\n  }\n\n  .btn.primary {\n    background: #6366f1 !important;\n    color: white !important;\n    border-color: #6366f1 !important;\n  }\n\n  .mode-btn.active {\n    background: #6366f1 !important;\n    color: white !important;\n  }\n}\n\n/* 使用 :deep 选择器穿透子组件样式（如果需要的话） */\n:deep(.json-node-editor) {\n  input,\n  select,\n  textarea,\n  option {\n    background: #f8fafc !important;\n    color: #1e293b !important;\n    border-color: #e2e8f0 !important;\n  }\n\n  select option {\n    background: #f8fafc !important;\n    color: #1e293b !important;\n  }\n}\n\n// 响应式\n@media (max-width: 640px) {\n  .editor-toolbar {\n    flex-direction: column;\n    gap: 12px;\n    align-items: stretch;\n  }\n\n  .toolbar-right {\n    justify-content: space-between;\n  }\n\n  .edit-mode-selector {\n    flex-direction: column;\n    align-items: stretch;\n  }\n\n  .mode-buttons,\n  .edit-tools {\n    flex-wrap: wrap;\n  }\n\n  .editor-header {\n    flex-direction: column;\n    gap: 8px;\n    align-items: flex-start;\n  }\n\n  .modal {\n    width: 95%;\n    margin: 10px;\n  }\n\n  .modal-actions {\n    flex-direction: column;\n  }\n\n  .btn {\n    width: 100%;\n  }\n}\n'],sourceRoot:''}]);const l=r},342:(e,n,t)=>{t.r(n),t.d(n,{default:()=>l});var a=t(1314),o=t.n(a),A=t(5378),r=t.n(A)()(o());r.push([e.id,'.file-import-export[data-v-cf14256c]{display:inline-block}.button-group[data-v-cf14256c]{display:flex;gap:8px;align-items:center}.btn[data-v-cf14256c]{padding:5px 12px;border:none;border-radius:6px;font-size:12px;cursor:pointer;transition:all .2s;background:#f3f4f6;color:#111827;box-shadow:0 1px 2px 0 rgba(0,0,0,.05);font-weight:500;display:inline-flex;align-items:center;gap:4px}.btn[data-v-cf14256c]:hover:not(.disabled){background:#e5e7eb;color:#000}.btn.primary[data-v-cf14256c]{background:#4f46e5;color:#fff;font-weight:500}.btn.primary[data-v-cf14256c]:hover:not(.disabled){background:#4338ca;color:#fff}.btn.disabled[data-v-cf14256c]{opacity:.6;cursor:not-allowed}.loading-spinner[data-v-cf14256c]{display:inline-block;width:12px;height:12px;border:2px solid #f3f4f6;border-top:2px solid #6366f1;border-radius:50%;animation:spin-cf14256c 1s linear infinite}@keyframes spin-cf14256c{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.status-message[data-v-cf14256c]{padding:6px 10px;border-radius:4px;font-size:11px;margin-top:8px}.status-message.success[data-v-cf14256c]{background:#d1fae5;color:#065f46;border:1px solid #a7f3d0}.status-message.error[data-v-cf14256c]{background:#fee2e2;color:#991b1b;border:1px solid #fecaca}.status-message.warning[data-v-cf14256c]{background:#fef3c7;color:#92400e;border:1px solid #fde68a}','',{version:3,sources:['webpack://./src/ERA助手/UI/components/File/FileImportExport.vue'],names:[],mappings:'AACA,qCACE,oBAAA,CAGF,+BACE,YAAA,CACA,OAAA,CACA,kBAAA,CAGF,sBACE,gBAAA,CACA,WAAA,CACA,iBAAA,CACA,cAAA,CACA,cAAA,CACA,kBAAA,CACA,kBAAA,CACA,aAAA,CACA,sCAAA,CACA,eAAA,CACA,mBAAA,CACA,kBAAA,CACA,OAAA,CAGF,2CACE,kBAAA,CACA,UAAA,CAGF,8BACE,kBAAA,CACA,UAAA,CACA,eAAA,CAGF,mDACE,kBAAA,CACA,UAAA,CAGF,+BACE,UAAA,CACA,kBAAA,CAGF,kCACE,oBAAA,CACA,UAAA,CACA,WAAA,CACA,wBAAA,CACA,4BAAA,CACA,iBAAA,CACA,0CAAA,CAGF,yBACE,GACE,sBAAA,CAEF,KACE,wBAAA,CAAA,CAIJ,iCACE,gBAAA,CACA,iBAAA,CACA,cAAA,CACA,cAAA,CAGF,yCACE,kBAAA,CACA,aAAA,CACA,wBAAA,CAGF,uCACE,kBAAA,CACA,aAAA,CACA,wBAAA,CAGF,yCACE,kBAAA,CACA,aAAA,CACA,wBAAA',sourcesContent:['\n.file-import-export {\n  display: inline-block;\n}\n\n.button-group {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n}\n\n.btn {\n  padding: 5px 12px;\n  border: none;\n  border-radius: 6px;\n  font-size: 12px;\n  cursor: pointer;\n  transition: all 0.2s;\n  background: #f3f4f6;\n  color: #111827;\n  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n  font-weight: 500;\n  display: inline-flex;\n  align-items: center;\n  gap: 4px;\n}\n\n.btn:hover:not(.disabled) {\n  background: #e5e7eb;\n  color: #000000;\n}\n\n.btn.primary {\n  background: #4f46e5;\n  color: #ffffff;\n  font-weight: 500;\n}\n\n.btn.primary:hover:not(.disabled) {\n  background: #4338ca;\n  color: #ffffff;\n}\n\n.btn.disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.loading-spinner {\n  display: inline-block;\n  width: 12px;\n  height: 12px;\n  border: 2px solid #f3f4f6;\n  border-top: 2px solid #6366f1;\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n\n.status-message {\n  padding: 6px 10px;\n  border-radius: 4px;\n  font-size: 11px;\n  margin-top: 8px;\n}\n\n.status-message.success {\n  background: #d1fae5;\n  color: #065f46;\n  border: 1px solid #a7f3d0;\n}\n\n.status-message.error {\n  background: #fee2e2;\n  color: #991b1b;\n  border: 1px solid #fecaca;\n}\n\n.status-message.warning {\n  background: #fef3c7;\n  color: #92400e;\n  border: 1px solid #fde68a;\n}\n'],sourceRoot:''}]);const l=r},382:(e,n,t)=>{var a=t(7562);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(4424).A)('c99d54ec',a,!1,{ssrId:!0})},570:(e,n,t)=>{var a=t(4126);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(4424).A)('24c7294f',a,!1,{ssrId:!0})},688:(e,n,t)=>{t.d(n,{n:()=>A});var a=t(3035),o=t(4061);const A=(0,a.defineStore)('KatUI',()=>({showUI:(0,o.ref)(!1),collectedPaths:(0,o.ref)([])}))},1e3:(e,n,t)=>{var a=t(2764);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(4424).A)('1266b5d3',a,!1,{ssrId:!0})},1051:(e,n,t)=>{var a=t(1759);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(4424).A)('3e90b686',a,!1,{ssrId:!0})},1314:e=>{e.exports=function(e){var n=e[1],t=e[3];if(!t)return n;if('function'==typeof btoa){var a=btoa(unescape(encodeURIComponent(JSON.stringify(t)))),o='sourceMappingURL=data:application/json;charset=utf-8;base64,'.concat(a),A='/*# '.concat(o,' */');return[n].concat([A]).join('\n')}return[n].join('\n')}},1400:(e,n)=>{n.A=(e,n)=>{const t=e.__vccOpts||e;for(const[e,a]of n)t[e]=a;return t}},1461:(e,n,t)=>{t.r(n),t.d(n,{default:()=>l});var a=t(1314),o=t.n(a),A=t(5378),r=t.n(A)()(o());r.push([e.id,'.json-tree[data-v-1e416d58]{font-family:monospace;font-size:12px;overflow-x:auto;padding:10px;background-color:#fff}.empty-tree[data-v-1e416d58]{padding:20px;color:#9ca3af;text-align:center}','',{version:3,sources:['webpack://./src/ERA助手/UI/components/JsonNode/JsonTreeEdit.vue'],names:[],mappings:'AACA,4BACE,qBAAA,CACA,cAAA,CACA,eAAA,CACA,YAAA,CACA,qBAAA,CAEF,6BACE,YAAA,CACA,aAAA,CACA,iBAAA',sourcesContent:['\n.json-tree {\n  font-family: monospace;\n  font-size: 12px;\n  overflow-x: auto;\n  padding: 10px;\n  background-color: #fff;\n}\n.empty-tree {\n  padding: 20px;\n  color: #9ca3af;\n  text-align: center;\n}\n'],sourceRoot:''}]);const l=r},1595:(e,n,t)=>{var a=t(6055);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(4424).A)('64a17d5e',a,!1,{ssrId:!0})},1678:(e,n,t)=>{var a=t(9466);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(4424).A)('5953c5e5',a,!1,{ssrId:!0})},1704:(e,n,t)=>{t.d(n,{A:()=>l});var a=t(4061);const o={class:'search-box'},A=['value'],r=(0,a.defineComponent)({__name:'PathSearch',props:{modelValue:{}},emits:['update:modelValue'],setup:e=>(n,t)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',o,[t[2]||(t[2]=(0,a.createElementVNode)('svg',{class:'search-icon',viewBox:'0 0 16 16',fill:'currentColor'},[(0,a.createElementVNode)('path',{d:'M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z'})],-1)),(0,a.createElementVNode)('input',{value:e.modelValue,type:'text',placeholder:'搜索路径或值...',class:'search-input',onInput:t[0]||(t[0]=e=>n.$emit('update:modelValue',e.target.value))},null,40,A),e.modelValue?((0,a.openBlock)(),(0,a.createElementBlock)('button',{key:0,class:'search-clear',onClick:t[1]||(t[1]=e=>n.$emit('update:modelValue',''))},'×')):(0,a.createCommentVNode)('v-if',!0)]))});t(1595);const l=(0,t(1400).A)(r,[['__scopeId','data-v-e21434b2']])},1759:(e,n,t)=>{t.r(n),t.d(n,{default:()=>l});var a=t(1314),o=t.n(a),A=t(5378),r=t.n(A)()(o());r.push([e.id,'.simulation-test[data-v-8bc8f95e]{display:flex;flex-direction:column;gap:12px;height:100%}.section-header[data-v-8bc8f95e]{display:flex;justify-content:space-between;align-items:center;margin:0 0 12px 0}.test-controls[data-v-8bc8f95e]{display:flex;flex-direction:column;gap:12px;margin-bottom:12px}.test-controls .btn[data-v-8bc8f95e]{padding:8px 16px;font-size:14px}.btn[data-v-8bc8f95e]{padding:5px 12px;border:none;border-radius:6px;font-size:12px;cursor:pointer;transition:background .2s,color .2s,transform .15s;background:#f3f4f6;color:#111827;box-shadow:0 1px 2px 0 rgba(0,0,0,.05);font-weight:500}.btn[data-v-8bc8f95e]:hover{background:#e5e7eb;color:#000}.btn.primary[data-v-8bc8f95e]{background:#4f46e5;color:#fff;font-weight:500}.btn.primary[data-v-8bc8f95e]:hover{background:#4338ca;color:#fff}.btn.small[data-v-8bc8f95e]{padding:3px 8px;font-size:11px}','',{version:3,sources:['webpack://./src/ERA助手/UI/components/DSL/SimulationTest.vue'],names:[],mappings:'AACA,kCACE,YAAA,CACA,qBAAA,CACA,QAAA,CACA,WAAA,CAGF,iCACE,YAAA,CACA,6BAAA,CACA,kBAAA,CACA,iBAAA,CAGF,gCACE,YAAA,CACA,qBAAA,CACA,QAAA,CACA,kBAAA,CAGF,qCACE,gBAAA,CACA,cAAA,CAIF,sBACE,gBAAA,CACA,WAAA,CACA,iBAAA,CACA,cAAA,CACA,cAAA,CACA,kDACE,CAGF,kBAAA,CACA,aAAA,CACA,sCAAA,CACA,eAAA,CAGF,4BACE,kBAAA,CACA,UAAA,CAGF,8BACE,kBAAA,CACA,UAAA,CACA,eAAA,CAGF,oCACE,kBAAA,CACA,UAAA,CAGF,4BACE,eAAA,CACA,cAAA',sourcesContent:['\n.simulation-test {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  height: 100%;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin: 0 0 12px 0;\n}\n\n.test-controls {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  margin-bottom: 12px;\n}\n\n.test-controls .btn {\n  padding: 8px 16px;\n  font-size: 14px;\n}\n\n/* 按钮样式 */\n.btn {\n  padding: 5px 12px;\n  border: none;\n  border-radius: 6px;\n  font-size: 12px;\n  cursor: pointer;\n  transition:\n    background 0.2s,\n    color 0.2s,\n    transform 0.15s;\n  background: #f3f4f6;\n  color: #111827;\n  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n  font-weight: 500;\n}\n\n.btn:hover {\n  background: #e5e7eb;\n  color: #000000;\n}\n\n.btn.primary {\n  background: #4f46e5;\n  color: #ffffff;\n  font-weight: 500;\n}\n\n.btn.primary:hover {\n  background: #4338ca;\n  color: #ffffff;\n}\n\n.btn.small {\n  padding: 3px 8px;\n  font-size: 11px;\n}\n'],sourceRoot:''}]);const l=r},1960:(e,n,t)=>{t.d(n,{A:()=>d});var a=t(4061);const o={class:'modal-content'},A={class:'modal-header'},r={class:'modal-body'},l={class:'modal-footer'},i=(0,a.defineComponent)({__name:'EraConfirmModal',props:{visible:{type:Boolean},title:{default:'提示'},content:{default:''},type:{default:'confirm'},confirmText:{default:'确认'},cancelText:{default:'取消'},showClose:{type:Boolean,default:!0}},emits:['confirm','cancel','update:visible'],setup(e,{emit:n}){const t=e,i=n,d=()=>{i('confirm'),i('update:visible',!1)},s=()=>{i('cancel'),i('update:visible',!1)};return(0,a.watch)(()=>t.visible,e=>{document.body.style.overflow=e?'hidden':''}),(n,t)=>((0,a.openBlock)(),(0,a.createBlock)(a.Transition,{name:'modal'},{default:(0,a.withCtx)(()=>[e.visible?((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:0,class:'modal-overlay',onClick:(0,a.withModifiers)(s,['self'])},[(0,a.createElementVNode)('div',o,[(0,a.createElementVNode)('div',A,[(0,a.createElementVNode)('h3',null,(0,a.toDisplayString)(e.title),1),e.showClose?((0,a.openBlock)(),(0,a.createElementBlock)('button',{key:0,class:'modal-close',onClick:s},'×')):(0,a.createCommentVNode)('v-if',!0)]),(0,a.createElementVNode)('div',r,[(0,a.renderSlot)(n.$slots,'default',{},()=>[(0,a.createElementVNode)('p',null,(0,a.toDisplayString)(e.content),1)])]),(0,a.createElementVNode)('div',l,[(0,a.renderSlot)(n.$slots,'footer',{},()=>['confirm'===e.type?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:0},[(0,a.createElementVNode)('button',{class:'btn primary',onClick:d},(0,a.toDisplayString)(e.confirmText),1),(0,a.createElementVNode)('button',{class:'btn',onClick:s},(0,a.toDisplayString)(e.cancelText),1)],64)):'alert'===e.type?((0,a.openBlock)(),(0,a.createElementBlock)('button',{key:1,class:'btn primary',onClick:d},(0,a.toDisplayString)(e.confirmText),1)):(0,a.createCommentVNode)('v-if',!0)])])])])):(0,a.createCommentVNode)('v-if',!0)]),_:3}))}});t(5757);const d=(0,t(1400).A)(i,[['__scopeId','data-v-4b35b177']])},2393:(e,n,t)=>{t.d(n,{w:()=>C});class a{input;position=0;tokens=[];constructor(e){this.input=e}tokenize(){for(this.position=0,this.tokens=[],this.skipWrapperHeader();this.position<this.input.length;){const e=this.input[this.position];if(this.isWhitespace(e))this.position++;else if('>'!==e)if('('!==e)if(')'!==e)if('$'!==e)if('@'!==e)if('&'!==e)if('?'!==e)if('#'!==e){if(']'!==e)throw new Error(`意外的字符: ${e} 位于位置 ${this.position}`);this.addToken('RBRACKET',']')}else this.tokenizeHash();else this.tokenizeQuestion();else this.tokenizeAmpersand();else this.tokenizeAt();else this.tokenizeDollar();else this.addToken('RPAREN',')');else this.addToken('LPAREN','(');else this.position++}return this.addToken('EOF',''),this.tokens}skipWrapperHeader(){const e=this.input.slice(this.position).match(/^<<(if|op)>\s*/);e&&(this.position+=e[0].length)}tokenizeDollar(){const e=this.position;if(this.position++,'['!==this.peek())throw new Error('在 "$" 后面需要 "["');this.position++;const n=this.position;for(;this.position<this.input.length&&']'!==this.peek();)this.position++;const t=this.input.slice(n,this.position);if(']'!==this.peek())throw new Error('未闭合的标识符');this.position++,this.tokens.push({type:'IDENTIFIER',value:t,start:e,end:this.position})}tokenizeAt(){const e=this.position;if(this.position++,'['!==this.peek())throw new Error('在 "@" 后面需要 "["');this.position++;const n=this.position;for(;this.position<this.input.length&&']'!==this.peek();)this.position++;const t=this.input.slice(n,this.position);if(']'!==this.peek())throw new Error('未闭合的临时变量');if(this.position++,!/^\{(g|s)\}\w+$/.test(t))throw new Error(`无效的临时变量格式: @[${t}]`);this.tokens.push({type:'TEMP_VARIABLE',value:t,start:e,end:this.position})}tokenizeAmpersand(){const e=this.position;if(this.position++,'['!==this.peek())throw new Error('在 "&" 后面需要 "["');this.position++;const n=this.position;for(;this.position<this.input.length&&']'!==this.peek();)this.position++;const t=this.input.slice(n,this.position);if(']'!==this.peek())throw new Error('未闭合的字面量');this.position++,this.tokens.push({type:'LITERAL',value:t,start:e,end:this.position})}tokenizeQuestion(){const e=this.position;if(this.position++,'['!==this.peek())throw new Error('在 "?" 后面需要 "["');this.position++;const n=this.position;for(;this.position<this.input.length&&']'!==this.peek();)this.position++;const t=this.input.slice(n,this.position);if(']'!==this.peek())throw new Error('Unclosed operator');this.position++,this.tokens.push({type:'OP_LOGIC',value:t,start:e,end:this.position})}tokenizeHash(){const e=this.position;if(this.position++,'['!==this.peek())throw new Error('在 "#" 后面需要 "["');if(this.position++,'{'===this.peek()){this.position++;const n=this.position;for(;this.position<this.input.length&&'}'!==this.peek();)this.position++;const t=this.input.slice(n,this.position);if('}'!==this.peek())throw new Error('未闭合的函数名');this.position++,this.tokens.push({type:'FUNC_START',value:t,start:e,end:this.position})}else{const n=this.position;for(;this.position<this.input.length&&']'!==this.peek();)this.position++;const t=this.input.slice(n,this.position);if(']'!==this.peek())throw new Error('未闭合的操作符');this.position++,this.tokens.push({type:'OP_MATH',value:t,start:e,end:this.position})}}addToken(e,n){this.tokens.push({type:e,value:n,start:this.position,end:this.position+n.length}),this.position+=n.length}peek(){return this.position<this.input.length?this.input[this.position]:'\0'}isWhitespace(e){return/\s/.test(e)}}function o(e){const n=e.match(/^\{(\w+)\}(.*)$/s);if(!n){const n=parseFloat(e);return isNaN(n)?{type:'string',value:e}:{type:'number',value:n}}const[,t,a]=n;switch(t){case'num':return{type:'number',value:parseFloat(a)};case'str':default:return{type:'string',value:a};case'bool':return{type:'boolean',value:'true'===a};case'null':return{type:'null',value:null}}}class A{tokens;position=0;constructor(e){this.tokens=e.tokenize()}parse(){if(0===this.tokens.length||'EOF'===this.tokens[0].type)throw new Error('表达式为空');const e=this.parseExpression();if(!this.isAtEnd()){const e=this.peek();throw new Error(`表达式后面有意外的标记: ${e.type} ('${e.value}') 位于位置 ${e.start}`)}return e}parseExpression(){return this.parseAssignment()}parseAssignment(){let e=this.parseLogicalOr();if(this.match('OP_MATH','=')){const n=this.previous().value,t=this.parseAssignment();if('Identifier'!==e.type&&'TempVariable'!==e.type)throw new Error(`无效的赋值目标: ${e.type}。必须是一个路径或临时变量。`);e={type:'BinaryOp',operator:n,left:e,right:t}}return e}parseLogicalOr(){let e=this.parseLogicalAnd();for(;this.match('OP_LOGIC','||');){e={type:'BinaryOp',operator:this.previous().value,left:e,right:this.parseLogicalAnd()}}return e}parseLogicalAnd(){let e=this.parseComparison();for(;this.match('OP_LOGIC','&&');){e={type:'BinaryOp',operator:this.previous().value,left:e,right:this.parseComparison()}}return e}parseComparison(){let e=this.parseAdditive();for(;this.matchOp(['==','!=','<','>','<=','>=']);){e={type:'BinaryOp',operator:this.previous().value,left:e,right:this.parseAdditive()}}return e}parseAdditive(){let e=this.parseMultiplicative();for(;this.matchOp(['+','-'],'OP_MATH');){e={type:'BinaryOp',operator:this.previous().value,left:e,right:this.parseMultiplicative()}}return e}parseMultiplicative(){let e=this.parsePower();for(;this.matchOp(['*','/','%'],'OP_MATH');){e={type:'BinaryOp',operator:this.previous().value,left:e,right:this.parsePower()}}return e}parsePower(){let e=this.parsePrimary();if(this.matchOp(['**'],'OP_MATH')){e={type:'BinaryOp',operator:this.previous().value,left:e,right:this.parsePower()}}return e}parsePrimary(){if(this.match('LPAREN')){const e=this.parseExpression();return this.consume('RPAREN','表达式后面需要 ")"'),e}if(this.match('IDENTIFIER'))return{type:'Identifier',path:this.previous().value};if(this.match('TEMP_VARIABLE')){const e=this.previous().value,n=e.match(/^\{(g|s)\}(.+)$/);if(!n)throw new Error(`解析器内部错误: 无效的临时变量格式 ${e}`);const[,t,a]=n;return{type:'TempVariable',scope:t,name:a}}if(this.match('LITERAL'))return{type:'Literal',value:o(this.previous().value)};if(this.match('FUNC_START')){const e=this.previous().value,n=[];for(;!this.check('RBRACKET')&&!this.isAtEnd();)n.push(this.parsePrimary());return this.consume('RBRACKET',`函数参数 ${e} 后面需要 "]"`),{type:'FunctionCall',name:e,args:n}}throw new Error(`意外的标记: ${this.peek().type} (${this.peek().value}) 位于 ${this.peek().start}`)}match(e,n){return!!this.check(e,n)&&(this.advance(),!0)}matchOp(e,n){if(this.isAtEnd())return!1;const t=this.peek();return!(!(n?t.type===n:'OP_LOGIC'===t.type||'OP_MATH'===t.type)||!e.includes(t.value))&&(this.advance(),!0)}consume(e,n){if(this.check(e))return this.advance();const t=this.peek();throw new Error(`${n} (位于位置 ${t.start})`)}check(e,n){if(this.isAtEnd())return!1;const t=this.peek();return t.type===e&&(void 0===n||t.value===n)}advance(){return this.isAtEnd()||this.position++,this.previous()}isAtEnd(){return'EOF'===this.peek().type}peek(){return this.tokens[this.position]}previous(){return this.tokens[this.position-1]}}var r=t(5241);class l{data;globalVars;localVars;constructor(e,n,t){this.data=e,this.globalVars=n,this.localVars=t}evaluate(e){switch(e.type){case'BinaryOp':return this.evaluateBinaryOp(e);case'FunctionCall':return this.evaluateFunctionCall(e);case'Identifier':return this.evaluateIdentifier(e);case'Literal':return e.value.value;case'TempVariable':return this.evaluateTempVariable(e);default:throw new Error(`未知的节点类型: ${e.type}`)}}evaluateBinaryOp(e){if('='===e.operator)return this.performAssignment(e.left,e.right);const n=this.evaluate(e.left),t=this.evaluate(e.right),a=['+','-','*','/','%','**'].includes(e.operator),o=['<','>','<=','>='].includes(e.operator);if(a&&('number'!=typeof n||'number'!=typeof t)){const a=JSON.stringify(n),o=JSON.stringify(t);throw new Error(`算术运算符 '${e.operator}' 类型不匹配。两个操作数都必须是数字，但得到了 ${typeof n} (${a}) 和 ${typeof t} (${o})。`)}if(o){const a=typeof n,o=typeof t;if(a!==o){const A=JSON.stringify(n),r=JSON.stringify(t);throw new Error(`比较运算符 '${e.operator}' 类型不匹配。操作数必须是相同类型，但得到了 ${a} (${A}) 和 ${o} (${r})。`)}if('object'===a&&null!==n)throw new Error(`不能在对象上使用运算符 '${e.operator}'。`)}switch(e.operator){case'&&':return n&&t;case'||':return n||t;case'==':return n==t;case'!=':return n!=t;case'<':return n<t;case'>':return n>t;case'<=':return n<=t;case'>=':return n>=t;case'+':return n+t;case'-':return n-t;case'*':return n*t;case'/':return n/t;case'%':return n%t;case'**':return Math.pow(n,t);default:throw new Error(`未知的运算符: ${e.operator}`)}}performAssignment(e,n){const t=this.evaluate(n);if('TempVariable'===e.type){('g'===e.scope?this.globalVars:this.localVars).set(e.name,t)}return t}evaluateTempVariable(e){const n='g'===e.scope?this.globalVars:this.localVars;if(!n.has(e.name))throw new Error(`临时变量 '@[${e.scope}]${e.name}' 尚未定义。`);return n.get(e.name)}evaluateFunctionCall(e){const n=e.args.map(e=>this.evaluate(e));switch(e.name){case'neg':return-Number(n[0]);case'sum':return n.reduce((e,n)=>e+Number(n),0);case'avg':return 0===n.length?0:n.reduce((e,n)=>e+Number(n),0)/n.length;case'ln':return Math.log(Number(n[0]));case'log2':return Math.log2(Number(n[0]));case'sqrt':return Math.sqrt(Number(n[0]));case'abs':return Math.abs(Number(n[0]));case'floor':return Math.floor(Number(n[0]));case'ceil':return Math.ceil(Number(n[0]));case'max':return Math.max(...n.map(Number));case'min':return Math.min(...n.map(Number));default:throw new Error(`未知的函数: ${e.name}`)}}evaluateIdentifier(e){const n=e.path.split('.'),t=(0,r.Em)(this.data,n);if(void 0===t)throw new Error(`路径 '${e.path}' 不存在或其值未定义。`);return t}}var i=t(8840);class d{static process(e){if(!e)return'';let n='',t=0;const a=e.length;for(;t<a;){const o=e[t];if('&'===o){let o=t+1;for(;o<a&&/\s/.test(e[o]);)o++;if(o<a&&'['===e[o]){for(n+='&[',t=o+1;t<a;){const a=e[t];if(n+=a,t++,']'===a)break}continue}}/\s/.test(o)||(n+=o),t++}return n}}class s{static astCache=new Map;static MAX_CACHE_SIZE=1e4;static evaluate(e,n,t,o){try{const r=d.process(e),s=new i.G(n).expand(r),c=[];for(const e of s){let r;if(this.astCache.has(e))r=this.astCache.get(e);else{const n=new a(e);if(r=new A(n).parse(),this.astCache.size>=this.MAX_CACHE_SIZE){const e=this.astCache.keys().next().value;e&&this.astCache.delete(e)}this.astCache.set(e,r)}const i=new l(n,t,o).evaluate(r);let d,s;'BinaryOp'===r.type&&'='===r.operator&&('Identifier'===r.left.type?(d=r.left.path,s='data'):'TempVariable'===r.left.type&&(d=`@(${r.left.scope})${r.left.name}`,s='temp')),c.push({path:d,targetType:s,value:i})}return{success:!0,value:c}}catch(e){return{success:!1,error:e.message||'DSL执行过程中发生未知错误'}}}static clearCache(){this.astCache.clear()}}const c={'||':1,'&&':2,'==':3,'!=':3,'<':3,'>':3,'<=':3,'>=':3,'+':4,'-':4,'*':5,'/':5,'%':5,'**':6,neg:7,ln:7,log2:7,sqrt:7,abs:7,floor:7,ceil:7,sum:7,avg:7,max:7,min:7},p=(e,n=0)=>{switch(e.type){case'Identifier':return`$${e.path}`;case'TempVariable':return`@(${e.scope})${e.name}`;case'Literal':return'string'===e.value.type?`"${e.value.value}"`:String(e.value.value);case'FunctionCall':{const n=e.args.map(e=>p(e,0)).join(', ');return`${e.name.replace(/[{}]/g,'')}(${n})`}case'BinaryOp':{const t=c[e.operator]||0,a=p(e.left,t),o=p(e.right,t),A=`${a} ${e.operator} ${o}`;return t<n?`(${A})`:A}}},C={execute:(e,n,t,a)=>s.evaluate(e,n,t,a),validate(e){try{const n=d.process(e),t=new a(n);return new A(t).parse(),{success:!0}}catch(e){return{success:!1,error:e.message}}},getValue(e,n){const t=(0,r.Rr)(n);return(0,r.Em)(e,t)},setValue(e,n,t){const a=(0,r.Rr)(n);(0,r.Wp)(e,a,t)},exprToHumanView:e=>(e=>{if(!e)return'';try{const n=d.process(e),t=new a(n),o=new A(t).parse();return p(o)}catch(e){return`[无效表达式: ${e.message}]`}})(e),clearCache(){s.clearCache()}}},2431:(e,n,t)=>{t.d(n,{default:()=>fe}),t.r(n);var a=t(4061),o=t(688),A=t(5632),r=t(5114),l=t(9761),i=t(3035),d=t(4167),s=t(3300);const c={class:'config-container'},p={class:'collapsible-section'},C={class:'section-content'},u={class:'world-info-config'},f={class:'config-section'},m={class:'toggle-icon'},b={class:'entry-list'},g=['onUpdate:modelValue'],v=['value'],x=['onClick'],h={class:'config-section'},k={class:'toggle-icon'},E={class:'entry-list'},y=['onUpdate:modelValue'],w=['value'],B=['onClick'],N={class:'config-section'},V={class:'toggle-icon'},F={class:'entry-list'},S=['onUpdate:modelValue'],j=['value'],D=['onClick'],G={class:'collapsible-section'},I={class:'toggle-icon'},O={class:'section-content'},M={class:'regex-config'},U={class:'config-section'},T={class:'toggle-icon'},R={class:'entry-list'},Y=['onUpdate:modelValue'],L=['onClick'],J={class:'actions'},W=(0,a.defineComponent)({__name:'WorldInfoAndRegexConfig',setup(e){const n=(0,r.$)(),{analyzeRores:t,updateRores:o,ignoreRores:l,regexList:W}=(0,i.storeToRefs)(n),P=(0,a.ref)(!1),q=(0,a.ref)(!1),K=(0,a.ref)(!1),H=(0,a.ref)(!1),Q=(0,a.ref)(!1),X=(0,a.ref)(!1),Z=(0,a.ref)([]),ee=(0,a.ref)([]),ne=(0,a.ref)([]),te=(0,a.ref)([]),ae=(0,a.ref)([]),oe=()=>{P.value=!P.value},Ae=()=>{q.value=!q.value},re=()=>{K.value=!K.value},le=()=>{H.value=!H.value},ie=()=>{Q.value=!Q.value},de=()=>{X.value=!X.value},se=async()=>{try{ae.value=await d.X.getAllWorldBookNames()}catch(e){console.error('获取世界书名称失败:',e),A.error('获取世界书名称失败')}},ce=async()=>{await se(),A.info('世界书列表已刷新')},pe=()=>{Z.value.push('')},Ce=()=>{ee.value.push('')},ue=()=>{ne.value.push('')},fe=()=>{te.value.push('<(variable(?:insert|edit|delete))>\\s*(?=[\\s\\S]*?\\S[\\s\\S]*?</\\1>)((?:(?!<(?:era_data|variable(?:think|insert|edit|delete))>|</\\1>)[\\s\\S])*?)\\s*</\\1>')},me=async()=>{t.value=[...Z.value],o.value=[...ee.value],l.value=[...ne.value],W.value=[...te.value],await n.saveWorldInfoFilterConfig(),await n.saveRegexConfig(),A.success('配置已保存')},be=async()=>{confirm('确定要清空所有配置吗？')&&(Z.value=[],ee.value=[],ne.value=[],te.value=[],await n.clearWorldInfoFilterConfig(),await n.clearRegexConfig(),A.info('配置已清空'))},ge=()=>{try{const e={analyzeEntries:Z.value,updateEntries:ee.value,ignoreEntries:ne.value,regexList:te.value.map(e=>e)},n=new Blob([JSON.stringify(e,null,2)],{type:'application/json'}),t=URL.createObjectURL(n),a=document.createElement('a');a.href=t,a.download=`worldinfo-regex-config-${(new Date).toISOString().slice(0,10)}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t)}catch(e){console.error('导出配置失败:',e),A.error('导出配置失败')}},ve=e=>{try{const n=JSON.parse(e);if('object'!=typeof n||null===n)return void A.error('无效的配置文件格式');Array.isArray(n.analyzeEntries)&&(Z.value=[...n.analyzeEntries]),Array.isArray(n.updateEntries)&&(ee.value=[...n.updateEntries]),Array.isArray(n.ignoreEntries)&&(ne.value=[...n.ignoreEntries]),Array.isArray(n.regexList)&&(te.value=[...n.regexList]),A.success('配置导入成功')}catch(e){console.error('导入配置失败:',e),A.error('导入配置失败: '+(e instanceof Error?e.message:'无效的配置文件'))}};return(0,a.onMounted)(async()=>{await se(),Z.value=[...t.value],ee.value=[...o.value],ne.value=[...l.value],te.value=[...W.value]}),(0,a.watch)(()=>[t.value,o.value,l.value,W.value],()=>{Z.value=[...t.value],ee.value=[...o.value],ne.value=[...l.value],te.value=[...W.value]}),(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',c,[(0,a.createCommentVNode)(' 世界书配置部分 '),(0,a.createElementVNode)('div',p,[(0,a.createElementVNode)('div',{class:'section-header',onClick:oe},[...n[0]||(n[0]=[(0,a.createElementVNode)('h4',null,'世界书配置',-1)])]),(0,a.withDirectives)((0,a.createElementVNode)('div',C,[(0,a.createElementVNode)('div',u,[(0,a.createElementVNode)('div',f,[(0,a.createElementVNode)('div',{class:'subsection-header',onClick:re},[n[1]||(n[1]=(0,a.createElementVNode)('h5',null,'AnalyzeList',-1)),(0,a.createElementVNode)('span',m,(0,a.toDisplayString)(K.value?'−':'+'),1)]),(0,a.withDirectives)((0,a.createElementVNode)('div',b,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(Z.value,(e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:t,class:'entry-item'},[(0,a.withDirectives)((0,a.createElementVNode)('select',{'onUpdate:modelValue':e=>Z.value[t]=e,class:'entry-select light-theme'},[n[2]||(n[2]=(0,a.createElementVNode)('option',{value:''},'请选择世界书条目',-1)),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(ae.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)('option',{key:e,value:e},(0,a.toDisplayString)(e),9,v))),128))],8,g),[[a.vModelSelect,Z.value[t]]]),(0,a.createElementVNode)('button',{class:'btn remove-btn',onClick:e=>(e=>{Z.value.splice(e,1)})(t)},'×',8,x)]))),128)),(0,a.createElementVNode)('button',{class:'btn add-btn',onClick:pe},'添加条目')],512),[[a.vShow,K.value]])]),(0,a.createElementVNode)('div',h,[(0,a.createElementVNode)('div',{class:'subsection-header',onClick:le},[n[3]||(n[3]=(0,a.createElementVNode)('h5',null,'UpdateList',-1)),(0,a.createElementVNode)('span',k,(0,a.toDisplayString)(H.value?'−':'+'),1)]),(0,a.withDirectives)((0,a.createElementVNode)('div',E,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(ee.value,(e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:t,class:'entry-item'},[(0,a.withDirectives)((0,a.createElementVNode)('select',{'onUpdate:modelValue':e=>ee.value[t]=e,class:'entry-select light-theme'},[n[4]||(n[4]=(0,a.createElementVNode)('option',{value:''},'请选择世界书条目',-1)),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(ae.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)('option',{key:e,value:e},(0,a.toDisplayString)(e),9,w))),128))],8,y),[[a.vModelSelect,ee.value[t]]]),(0,a.createElementVNode)('button',{class:'btn remove-btn',onClick:e=>(e=>{ee.value.splice(e,1)})(t)},'×',8,B)]))),128)),(0,a.createElementVNode)('button',{class:'btn add-btn',onClick:Ce},'添加条目')],512),[[a.vShow,H.value]])]),(0,a.createElementVNode)('div',N,[(0,a.createElementVNode)('div',{class:'subsection-header',onClick:ie},[n[5]||(n[5]=(0,a.createElementVNode)('h5',null,'IgnoreList',-1)),(0,a.createElementVNode)('span',V,(0,a.toDisplayString)(Q.value?'−':'+'),1)]),(0,a.withDirectives)((0,a.createElementVNode)('div',F,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(ne.value,(e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:t,class:'entry-item'},[(0,a.withDirectives)((0,a.createElementVNode)('select',{'onUpdate:modelValue':e=>ne.value[t]=e,class:'entry-select light-theme'},[n[6]||(n[6]=(0,a.createElementVNode)('option',{value:''},'请选择世界书条目',-1)),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(ae.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)('option',{key:e,value:e},(0,a.toDisplayString)(e),9,j))),128))],8,S),[[a.vModelSelect,ne.value[t]]]),(0,a.createElementVNode)('button',{class:'btn remove-btn',onClick:e=>(e=>{ne.value.splice(e,1)})(t)},'×',8,D)]))),128)),(0,a.createElementVNode)('button',{class:'btn add-btn',onClick:ue},'添加条目')],512),[[a.vShow,Q.value]])])])],512),[[a.vShow,P.value]])]),(0,a.createCommentVNode)(' 正则表达式配置部分 '),(0,a.createElementVNode)('div',G,[(0,a.createElementVNode)('div',{class:'section-header',onClick:Ae},[n[7]||(n[7]=(0,a.createElementVNode)('h4',null,'正则表达式配置',-1)),(0,a.createElementVNode)('span',I,(0,a.toDisplayString)(q.value?'−':'+'),1)]),(0,a.withDirectives)((0,a.createElementVNode)('div',O,[(0,a.createElementVNode)('div',M,[(0,a.createElementVNode)('div',U,[(0,a.createElementVNode)('div',{class:'subsection-header',onClick:de},[n[8]||(n[8]=(0,a.createElementVNode)('h5',null,'正则表达式列表',-1)),(0,a.createElementVNode)('span',T,(0,a.toDisplayString)(X.value?'−':'+'),1)]),(0,a.withDirectives)((0,a.createElementVNode)('div',R,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(te.value,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:n,class:'entry-item'},[(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':e=>te.value[n]=e,type:'text',class:'regex-input light-theme',placeholder:'请输入正则表达式'},null,8,Y),[[a.vModelText,te.value[n]]]),(0,a.createElementVNode)('button',{class:'btn remove-btn',onClick:e=>(e=>{te.value.splice(e,1)})(n)},'×',8,L)]))),128)),(0,a.createElementVNode)('button',{class:'btn add-btn',onClick:fe},'添加正则')],512),[[a.vShow,X.value]]),n[9]||(n[9]=(0,a.createElementVNode)('h6',null,'（请不要导入来源未知的json，以避免遭到恶意攻击）',-1))])])],512),[[a.vShow,q.value]])]),(0,a.createCommentVNode)(' 操作按钮 '),(0,a.createElementVNode)('div',J,[(0,a.createElementVNode)('button',{class:'btn primary',onClick:ce},'刷新世界书列表'),(0,a.createElementVNode)('button',{class:'btn danger',onClick:be},'清空配置'),(0,a.createVNode)(s.A,{'import-text':'导入配置','export-text':'导出配置','confirm-title':'导入配置确认','confirm-content':'导入新配置将覆盖当前配置，确定要继续吗？',onImportConfirmed:ve,onExportData:ge}),(0,a.createElementVNode)('button',{class:'btn primary',onClick:me},'保存配置')])]))}});t(6215);var P=t(1400);const q=(0,P.A)(W,[['__scopeId','data-v-20e294dc']]),K={class:'page-tabs'},H={class:'switch-row'},Q=['checked'],X={class:'row'},Z={key:0,class:'row'},ee=['value','title'],ne={key:1,class:'form'},te={class:'row'},ae={class:'row'},oe={class:'row'},Ae={class:'row'},re=['value','title'],le=['value'],ie={class:'row'},de={class:'row'},se={class:'row'},ce={class:'row'},pe={class:'row',style:{'justify-content':'flex-start',gap:'12px'}},Ce={key:0,class:'footer'},ue=(0,a.defineComponent)({__name:'AsyncAnalyze',setup(e){const n=(0,o.n)(),t=(0,r.$)(),i=(0,a.ref)('model'),d=(e,n=36)=>e.length>n?e.slice(0,n-1)+'…':e,s=(0,a.ref)('sample'),c=(0,a.ref)(''),p=(0,a.ref)([]),C=(0,a.reactive)({baseURL:'',apiKey:'',modelName:'',temperature:.7,frequencyPenalty:0,presencePenalty:0,maxTokens:2e4}),u=async()=>{'profile'===s.value&&await f()},f=async()=>{try{const e=await window.SillyTavern.executeSlashCommands('/profile-list');p.value=JSON.parse(e.pipe),l.j.log('预设名称列表:',p.value)}catch(e){A.error('获取预设列表失败'),l.j.error('刷新预设列表失败',e),p.value=[]}};(0,a.watch)(()=>n.showUI,async e=>{e&&(s.value=t.modelSource,c.value=t.profileSetting||'',Object.assign(C,t.customModelSettings),await f())},{immediate:!0});const m=async()=>{'model'===i.value&&(t.modelSource=s.value,t.profileSetting=c.value,t.customModelSettings={...C},await t.saveModelSettings(),A.success('设置已保存'))},b=async()=>{'model'===i.value&&(await t.clearModelSettings(),s.value=t.modelSource,c.value=t.profileSetting||'',Object.assign(C,t.customModelSettings),A.info('已清空设置'))},g=()=>{n.showUI=!1},v=async()=>{if(await m(),'sample'===s.value||'profile'===s.value){try{let e;'profile'===s.value&&(e=(await window.SillyTavern.executeSlashCommands('/profile')).pipe,l.j.log('当前预设名称:',e),await window.SillyTavern.executeSlashCommands(`/profile ${c.value}`));const n=await window.SillyTavern.executeSlashCommands('/model');n.error?A.error(`模型异常：${n.error}`):(A.success('模型连接正常 ✓'),'profile'===s.value&&await window.SillyTavern.executeSlashCommands(`/profile ${e}`))}catch(e){A.error(`检测失败：${e.message||'未知错误'}`)}return}if(!C.baseURL||!C.apiKey)return void A.warning('请先填写接口地址与 API 密钥');const e=new AbortController,n=setTimeout(()=>e.abort(),8e3);try{const t=await fetch(`${C.baseURL.replace(/\/$/,'')}/models`,{method:'GET',headers:{Authorization:`Bearer ${C.apiKey.trim()}`},signal:e.signal});if(clearTimeout(n),t.ok)A.success('连接成功，密钥可用 ✓');else{const e=await t.text().catch(()=>t.statusText);A.error(`连接失败：${t.status} ${e}`)}}catch(e){clearTimeout(n),A.error(`网络错误：${e.message||'无法到达服务器'}`)}},x=(0,a.ref)([]),h=async()=>{if(!C.baseURL||!C.apiKey)return void A.warning('请先填写接口地址与 API 密钥');const e=new AbortController,n=setTimeout(()=>e.abort(),8e3);try{const t=await fetch(`${C.baseURL.replace(/\/$/,'')}/models`,{method:'GET',headers:{Authorization:`Bearer ${C.apiKey.trim()}`},signal:e.signal});clearTimeout(n),t.ok||A.error(`获取失败：${t.status} ${await t.text().catch(()=>t.statusText)}`);const a=await t.json();x.value=(a.data||[]).map(e=>e.id).sort(),A.success(`共拉取 ${x.value.length} 个模型`)}finally{clearTimeout(n)}};return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',null,[(0,a.createCommentVNode)(' 页面导航 '),(0,a.createElementVNode)('div',K,[(0,a.createElementVNode)('button',{class:(0,a.normalizeClass)(['tab-button',{active:'model'===i.value}]),onClick:n[0]||(n[0]=e=>i.value='model')},' 模型配置 ',2),(0,a.createElementVNode)('button',{class:(0,a.normalizeClass)(['tab-button',{active:'worldinfo'===i.value}]),onClick:n[1]||(n[1]=e=>i.value='worldinfo')},' 世界书与正则配置 ',2)]),(0,a.createCommentVNode)(' 第一页：模型配置 '),(0,a.withDirectives)((0,a.createElementVNode)('div',null,[n[24]||(n[24]=(0,a.createElementVNode)('h3',{class:'title'},'ERA 分步分析设置',-1)),(0,a.createCommentVNode)(' 分步分析开关 '),(0,a.createElementVNode)('label',H,[n[12]||(n[12]=(0,a.createElementVNode)('span',null,'分步分析模式',-1)),(0,a.createElementVNode)('input',{type:'checkbox',checked:(0,a.unref)(t).isAsync,onChange:n[2]||(n[2]=()=>{(0,a.unref)(t).isAsync=!(0,a.unref)(t).isAsync})},null,40,Q),n[13]||(n[13]=(0,a.createElementVNode)('span',{class:'switch'},null,-1))]),n[25]||(n[25]=(0,a.createElementVNode)('span',{class:'tip-card'},' ⚠️ 目前流式生成的分析的 ejs 替换有 bug，分步模式请不要打开流式 ',-1)),(0,a.createCommentVNode)(' 模型来源 '),(0,a.createElementVNode)('div',X,[n[15]||(n[15]=(0,a.createElementVNode)('span',null,'模型来源',-1)),(0,a.withDirectives)((0,a.createElementVNode)('select',{'onUpdate:modelValue':n[3]||(n[3]=e=>s.value=e),onChange:u},[...n[14]||(n[14]=[(0,a.createElementVNode)('option',{value:'sample'},'当前模型',-1),(0,a.createElementVNode)('option',{value:'profile'},'预设模型',-1),(0,a.createElementVNode)('option',{value:'external'},'额外模型',-1)])],544),[[a.vModelSelect,s.value]])]),(0,a.createCommentVNode)('      <div v-if="modelSource === \'profile\'" class="row">'),(0,a.createCommentVNode)('        <span>预设模型</span>'),(0,a.createCommentVNode)('        因为ERA和提示词模板的替换问题，目前不可用😑'),(0,a.createCommentVNode)('      </div>'),(0,a.createCommentVNode)('       TODO 因为ERA的替换问题，目前不可用  预设模型选择（仅 profile 时显示） '),'profile'===s.value?((0,a.openBlock)(),(0,a.createElementBlock)('div',Z,[n[16]||(n[16]=(0,a.createElementVNode)('span',null,'预设模型',-1)),(0,a.withDirectives)((0,a.createElementVNode)('select',{'onUpdate:modelValue':n[4]||(n[4]=e=>c.value=e)},[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(p.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)('option',{key:e,value:e,title:e},(0,a.toDisplayString)(d(e)),9,ee))),128))],512),[[a.vModelSelect,c.value]])])):(0,a.createCommentVNode)('v-if',!0),(0,a.createCommentVNode)(' 额外模型参数（仅 external 时显示） '),'external'===s.value?((0,a.openBlock)(),(0,a.createElementBlock)('div',ne,[(0,a.createElementVNode)('div',te,[n[17]||(n[17]=(0,a.createElementVNode)('span',null,'接口地址',-1)),(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':n[5]||(n[5]=e=>C.baseURL=e),placeholder:'https://api.openai.com/v1'},null,512),[[a.vModelText,C.baseURL]])]),(0,a.createElementVNode)('div',ae,[n[18]||(n[18]=(0,a.createElementVNode)('span',null,'API密钥（请注意好个人隐私）',-1)),(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':n[6]||(n[6]=e=>C.apiKey=e),type:'password',placeholder:'sk-...'},null,512),[[a.vModelText,C.apiKey]])]),(0,a.createElementVNode)('div',oe,[(0,a.createCommentVNode)(' 模型名称 '),(0,a.createElementVNode)('div',Ae,[n[19]||(n[19]=(0,a.createElementVNode)('span',null,'模型名称',-1)),(0,a.withDirectives)((0,a.createElementVNode)('select',{'onUpdate:modelValue':n[7]||(n[7]=e=>C.modelName=e),style:{flex:'1'}},[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(x.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)('option',{key:e,value:e,title:e},(0,a.toDisplayString)(d(e)),9,re))),128)),(0,a.createCommentVNode)(' 允许手动输入，兜底 '),C.modelName&&!x.value.includes(C.modelName)?((0,a.openBlock)(),(0,a.createElementBlock)('option',{key:0,value:C.modelName},(0,a.toDisplayString)(C.modelName),9,le)):(0,a.createCommentVNode)('v-if',!0)],512),[[a.vModelSelect,C.modelName]])])]),(0,a.createElementVNode)('div',ie,[n[20]||(n[20]=(0,a.createElementVNode)('span',null,'温度',-1)),(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':n[8]||(n[8]=e=>C.temperature=e),type:'number',step:'0.1',min:'0',max:'2'},null,512),[[a.vModelText,C.temperature]])]),(0,a.createElementVNode)('div',de,[n[21]||(n[21]=(0,a.createElementVNode)('span',null,'频率惩罚',-1)),(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':n[9]||(n[9]=e=>C.frequencyPenalty=e),type:'number',step:'0.1',min:'-2',max:'2'},null,512),[[a.vModelText,C.frequencyPenalty]])]),(0,a.createElementVNode)('div',se,[n[22]||(n[22]=(0,a.createElementVNode)('span',null,'存在惩罚',-1)),(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':n[10]||(n[10]=e=>C.presencePenalty=e),type:'number',step:'0.1',min:'-2',max:'2'},null,512),[[a.vModelText,C.presencePenalty]])]),(0,a.createElementVNode)('div',ce,[n[23]||(n[23]=(0,a.createElementVNode)('span',null,'最大Token数',-1)),(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':n[11]||(n[11]=e=>C.maxTokens=e),type:'number',min:'1'},null,512),[[a.vModelText,C.maxTokens]])])])):(0,a.createCommentVNode)('v-if',!0),(0,a.createElementVNode)('div',pe,[(0,a.createElementVNode)('button',{class:'btn small',onClick:v},'测试连接'),'external'===s.value?((0,a.openBlock)(),(0,a.createElementBlock)('button',{key:0,class:'btn small',onClick:h},'获取模型列表')):(0,a.createCommentVNode)('v-if',!0)])],512),[[a.vShow,'model'===i.value]]),(0,a.createCommentVNode)(' 第二页：世界书与正则配置 '),(0,a.withDirectives)((0,a.createElementVNode)('div',null,[n[26]||(n[26]=(0,a.createElementVNode)('h3',{class:'title'},'世界书与正则配置',-1)),(0,a.createVNode)(q)],512),[[a.vShow,'worldinfo'===i.value]]),n[27]||(n[27]=(0,a.createElementVNode)('br',null,null,-1)),(0,a.createCommentVNode)(' 底部按钮 '),'model'===i.value?((0,a.openBlock)(),(0,a.createElementBlock)('div',Ce,[(0,a.createElementVNode)('button',{class:'btn',onClick:g},'取消'),(0,a.createElementVNode)('button',{class:'btn danger',onClick:b},'清空'),(0,a.createElementVNode)('button',{class:'btn primary',onClick:m},'保存')])):(0,a.createCommentVNode)('v-if',!0)]))}});t(6200);const fe=(0,P.A)(ue,[['__scopeId','data-v-5ea9f1f0']])},2478:(e,n,t)=>{t.r(n),t.d(n,{default:()=>l});var a=t(1314),o=t.n(a),A=t(5378),r=t.n(A)()(o());r.push([e.id,'.json-tree[data-v-4dc2c334]{font-family:monospace;font-size:11px;overflow-x:auto;white-space:nowrap}\n','',{version:3,sources:['webpack://./src/ERA助手/UI/components/JsonNode/JsonTree.vue'],names:[],mappings:'AAqDA,4BACE,qBAAsB,CACtB,cAAe,CACf,eAAgB,CAChB,kBACF',sourcesContent:['<template>\n  <div class="json-tree">\n    <json-node\n      v-for="(n, i) in roots"\n      :key="i"\n      :node="n"\n      @toggle="onToggle"\n      @send-path="(p: string) => $emit(\'sendPath\', p)"\n    />\n  </div>\n</template>\n\n<script setup lang="ts">\nimport { watch, ref } from \'vue\';\nimport { JsonNodeType } from \'../../types/JsonNode\';\nimport JsonNode from \'./JsonNode.vue\';\n\n/* ---------- props / emit ---------- */\nconst props = defineProps<{ data: any }>();\nconst emit = defineEmits<{\n  toggle: [node: JsonNodeType];\n  sendPath: [path: string];\n}>();\n\n/* ---------- 递归建树 ---------- */\nfunction buildTree(obj: any, depth = 0, path = \'\', expanded = false): JsonNodeType[] {\n  if (obj === null || typeof obj !== \'object\') return [];\n  return Object.keys(obj).map(k => {\n    const curPath = path ? `${path}.${k}` : k;\n    const val = obj[k];\n    const isLeaf = val === null || typeof val !== \'object\';\n    const node: JsonNodeType = { key: k, value: val, depth, path: curPath, isLeaf, expanded };\n    if (!isLeaf) node.children = buildTree(val, depth + 1, curPath, expanded);\n    return node;\n  });\n}\n\n/* ---------- 响应式树根 ---------- */\nconst roots = ref<JsonNodeType[]>([]);\nwatch(\n  () => props.data,\n  val => (roots.value = buildTree(val)),\n  { immediate: true },\n);\n\n/* ---------- 事件透传 ---------- */\nfunction onToggle(n: JsonNodeType) {\n  n.expanded = !n.expanded;\n  emit(\'toggle\', n);\n}\n<\/script>\n\n<style scoped>\n.json-tree {\n  font-family: monospace;\n  font-size: 11px;\n  overflow-x: auto; /* 添加横向滚动 */\n  white-space: nowrap; /* 防止换行 */\n}\n</style>\n'],sourceRoot:''}]);const l=r},2680:(e,n,t)=>{var a=t(9068);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(4424).A)('3fe8b4b7',a,!1,{ssrId:!0})},2764:(e,n,t)=>{t.r(n),t.d(n,{default:()=>l});var a=t(1314),o=t.n(a),A=t(5378),r=t.n(A)()(o());r.push([e.id,'.mask[data-v-8bc54d56]{position:fixed;inset:0;background:rgba(0,0,0,.55);backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:9999;height:100vh;overflow-y:auto;animation:fadeIn-8bc54d56 .2s ease}.card[data-v-8bc54d56]{position:relative;background:linear-gradient(135deg,#dcd8d8 0%,#f8fafc 100%);border-radius:20px;width:90%;max-width:680px;box-shadow:0 20px 60px rgba(0,0,0,.15),0 0 0 1px hsla(0,0%,100%,.1);animation:slideUp-8bc54d56 .3s cubic-bezier(0.16,1,0.3,1);z-index:10000;min-height:750px;display:flex;flex-direction:column;max-height:90vh;overflow:hidden}.top-button-group[data-v-8bc54d56]{position:absolute;top:0;left:0;right:0;display:flex;background:linear-gradient(135deg,#f1f5f9 0%,#e2e8f0 100%);border-radius:20px 20px 0 0;padding:10px 16px;gap:8px;border-bottom:1px solid rgba(203,213,225,.5);z-index:1;height:56px}.router-view-container[data-v-8bc54d56]{flex:1;display:flex;flex-direction:column;margin-top:56px;padding:24px;overflow:hidden;background:hsla(0,0%,100%,.7);border-radius:0 0 20px 20px;border-top:1px solid hsla(0,0%,100%,.3)}.content[data-v-8bc54d56]{flex:1;overflow-y:auto;padding:4px;background:#fff;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,.05),inset 0 1px 0 hsla(0,0%,100%,.8)}.content[data-v-8bc54d56]>*{padding:0 8px}.content[data-v-8bc54d56]::-webkit-scrollbar{width:6px}.content[data-v-8bc54d56]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:3px;margin:4px 0}.content[data-v-8bc54d56]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.content[data-v-8bc54d56]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.btn[data-v-8bc54d56]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:8px 10px;border:none;border-radius:10px;background:linear-gradient(135deg,#dcd8d8 0%,#f8fafc 100%);color:#64748b;font-size:12px;cursor:pointer;transition:all .3s cubic-bezier(0.4,0,0.2,1);box-shadow:0 1px 4px rgba(0,0,0,.05),inset 0 1px 0 hsla(0,0%,100%,.8);min-height:48px}.btn[data-v-8bc54d56]:hover{transform:translateY(-1px);box-shadow:0 2px 8px rgba(0,0,0,.08),inset 0 1px 0 hsla(0,0%,100%,.9);color:#475569}.btn.active[data-v-8bc54d56]{background:linear-gradient(135deg,#6366f1 0%,#4f46e5 100%);color:#fff;box-shadow:0 2px 8px rgba(99,102,241,.3),inset 0 1px 0 hsla(0,0%,100%,.2)}.btn.active .btn-icon[data-v-8bc54d56]{opacity:1;transform:scale(1.1)}.btn.active .btn-text[data-v-8bc54d56]{font-weight:600}.btn-text[data-v-8bc54d56]{font-size:11px;line-height:1.2;font-weight:500;transition:all .3s ease;margin-top:2px}.close-x[data-v-8bc54d56]{position:absolute;top:62px;right:16px;width:28px;height:28px;border:none;background:#f8fafc;border-radius:50%;font-size:18px;line-height:1;color:#64748b;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:center;box-shadow:0 1px 6px rgba(0,0,0,.1);z-index:2}.close-x[data-v-8bc54d56]:hover{background:#ef4444;color:#fff;transform:rotate(90deg);box-shadow:0 3px 10px rgba(239,68,68,.3)}@keyframes fadeIn-8bc54d56{from{opacity:0}to{opacity:1}}@keyframes slideUp-8bc54d56{from{transform:translateY(30px) scale(0.95);opacity:0}to{transform:translateY(0) scale(1);opacity:1}}@media (max-width:480px){.card[data-v-8bc54d56]{max-width:95%;min-height:360px}.router-view-container[data-v-8bc54d56]{margin-top:52px;padding:16px}.top-button-group[data-v-8bc54d56]{padding:8px 12px;gap:6px;height:52px}.btn[data-v-8bc54d56]{padding:6px 8px;min-height:44px;font-size:11px}.btn-text[data-v-8bc54d56]{font-size:12px}.close-x[data-v-8bc54d56]{top:58px;right:12px;width:26px;height:26px;font-size:16px}.content[data-v-8bc54d56]{border-radius:10px}}','',{version:3,sources:['webpack://./src/ERA助手/UI/view/Layout.vue'],names:[],mappings:'AAEA,uBACE,cAAA,CACA,OAAA,CACA,0BAAA,CACA,yBAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CACA,YAAA,CACA,YAAA,CACA,eAAA,CACA,kCAAA,CAIF,uBACE,iBAAA,CACA,0DAAA,CACA,kBAAA,CACA,SAAA,CACA,eAAA,CACA,mEACE,CAEF,yDAAA,CACA,aAAA,CACA,gBAAA,CACA,YAAA,CACA,qBAAA,CACA,eAAA,CACA,eAAA,CAIF,mCACE,iBAAA,CACA,KAAA,CACA,MAAA,CACA,OAAA,CACA,YAAA,CACA,0DAAA,CACA,2BAAA,CACA,iBAAA,CACA,OAAA,CACA,4CAAA,CACA,SAAA,CACA,WAAA,CAIF,wCACE,MAAA,CACA,YAAA,CACA,qBAAA,CACA,eAAA,CACA,YAAA,CACA,eAAA,CACA,6BAAA,CACA,2BAAA,CACA,uCAAA,CAIF,0BACE,MAAA,CACA,eAAA,CACA,WAAA,CACA,eAAA,CACA,kBAAA,CACA,qEACE,CAIF,4BACE,aAAA,CAIF,6CACE,SAAA,CAGF,mDACE,kBAAA,CACA,iBAAA,CACA,YAAA,CAGF,mDACE,kBAAA,CACA,iBAAA,CAEA,yDACE,kBAAA,CAMN,sBACE,MAAA,CACA,YAAA,CACA,qBAAA,CACA,kBAAA,CACA,sBAAA,CACA,gBAAA,CACA,WAAA,CACA,kBAAA,CACA,0DAAA,CACA,aAAA,CACA,cAAA,CACA,cAAA,CACA,4CAAA,CACA,qEACE,CAEF,eAAA,CAEA,4BACE,0BAAA,CACA,qEACE,CAEF,aAAA,CAGF,6BACE,0DAAA,CACA,UAAA,CACA,yEACE,CAGF,uCACE,SAAA,CACA,oBAAA,CAGF,uCACE,eAAA,CAKN,2BACE,cAAA,CACA,eAAA,CACA,eAAA,CACA,uBAAA,CACA,cAAA,CAIF,0BACE,iBAAA,CACA,QAAA,CACA,UAAA,CACA,UAAA,CACA,WAAA,CACA,WAAA,CACA,kBAAA,CACA,iBAAA,CACA,cAAA,CACA,aAAA,CACA,aAAA,CACA,cAAA,CACA,uBAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CACA,mCAAA,CACA,SAAA,CAEA,gCACE,kBAAA,CACA,UAAA,CACA,uBAAA,CACA,wCAAA,CAKJ,2BACE,KACE,SAAA,CAEF,GACE,SAAA,CAAA,CAIJ,4BACE,KACE,sCAAA,CACA,SAAA,CAEF,GACE,gCAAA,CACA,SAAA,CAAA,CAKJ,yBACE,uBACE,aAAA,CACA,gBAAA,CAGF,wCACE,eAAA,CACA,YAAA,CAGF,mCACE,gBAAA,CACA,OAAA,CACA,WAAA,CAGF,sBACE,eAAA,CACA,eAAA,CACA,cAAA,CAGF,2BACE,cAAA,CAGF,0BACE,QAAA,CACA,UAAA,CACA,UAAA,CACA,WAAA,CACA,cAAA,CAGF,0BACE,kBAAA,CAAA',sourcesContent:['\n/* 遮罩层 */\n.mask {\n  position: fixed;\n  inset: 0;\n  background: rgba(0, 0, 0, 0.55);\n  backdrop-filter: blur(4px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 9999;\n  height: 100vh;\n  overflow-y: auto;\n  animation: fadeIn 0.2s ease;\n}\n\n/* 卡片主体 */\n.card {\n  position: relative;\n  background: linear-gradient(135deg, #dcd8d8 0%, #f8fafc 100%);\n  border-radius: 20px;\n  width: 90%;\n  max-width: 680px;\n  box-shadow:\n    0 20px 60px rgba(0, 0, 0, 0.15),\n    0 0 0 1px rgba(255, 255, 255, 0.1);\n  animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1);\n  z-index: 10000;\n  min-height: 750px;\n  display: flex;\n  flex-direction: column;\n  max-height: 90vh;\n  overflow: hidden;\n}\n\n/* 顶部按钮组 - 调整高度和位置 */\n.top-button-group {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  display: flex;\n  background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);\n  border-radius: 20px 20px 0 0;\n  padding: 10px 16px;\n  gap: 8px;\n  border-bottom: 1px solid rgba(203, 213, 225, 0.5);\n  z-index: 1;\n  height: 56px;\n}\n\n/* 新增：router-view 容器 */\n.router-view-container {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  margin-top: 56px; /* 与顶部按钮组高度相同 */\n  padding: 24px;\n  overflow: hidden;\n  background: rgba(255, 255, 255, 0.7);\n  border-radius: 0 0 20px 20px;\n  border-top: 1px solid rgba(255, 255, 255, 0.3);\n}\n\n/* 内容区 */\n.content {\n  flex: 1;\n  overflow-y: auto;\n  padding: 4px;\n  background: white;\n  border-radius: 12px;\n  box-shadow:\n    0 2px 8px rgba(0, 0, 0, 0.05),\n    inset 0 1px 0 rgba(255, 255, 255, 0.8);\n\n  /* 添加内部填充以确保内容不贴边 */\n  & > * {\n    padding: 0 8px;\n  }\n\n  /* 滚动条样式 */\n  &::-webkit-scrollbar {\n    width: 6px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: #f1f5f9;\n    border-radius: 3px;\n    margin: 4px 0;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: #cbd5e1;\n    border-radius: 3px;\n\n    &:hover {\n      background: #94a3b8;\n    }\n  }\n}\n\n/* 按钮样式 */\n.btn {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 8px 10px;\n  border: none;\n  border-radius: 10px;\n  background: linear-gradient(135deg, #dcd8d8 0%, #f8fafc 100%);\n  color: #64748b;\n  font-size: 12px;\n  cursor: pointer;\n  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  box-shadow:\n    0 1px 4px rgba(0, 0, 0, 0.05),\n    inset 0 1px 0 rgba(255, 255, 255, 0.8);\n  min-height: 48px;\n\n  &:hover {\n    transform: translateY(-1px);\n    box-shadow:\n      0 2px 8px rgba(0, 0, 0, 0.08),\n      inset 0 1px 0 rgba(255, 255, 255, 0.9);\n    color: #475569;\n  }\n\n  &.active {\n    background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);\n    color: white;\n    box-shadow:\n      0 2px 8px rgba(99, 102, 241, 0.3),\n      inset 0 1px 0 rgba(255, 255, 255, 0.2);\n\n    .btn-icon {\n      opacity: 1;\n      transform: scale(1.1);\n    }\n\n    .btn-text {\n      font-weight: 600;\n    }\n  }\n}\n\n.btn-text {\n  font-size: 11px;\n  line-height: 1.2;\n  font-weight: 500;\n  transition: all 0.3s ease;\n  margin-top: 2px;\n}\n\n/* 调整关闭按钮位置 */\n.close-x {\n  position: absolute;\n  top: 62px;\n  right: 16px;\n  width: 28px;\n  height: 28px;\n  border: none;\n  background: #f8fafc;\n  border-radius: 50%;\n  font-size: 18px;\n  line-height: 1;\n  color: #64748b;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  box-shadow: 0 1px 6px rgba(0, 0, 0, 0.1);\n  z-index: 2;\n\n  &:hover {\n    background: #ef4444;\n    color: white;\n    transform: rotate(90deg);\n    box-shadow: 0 3px 10px rgba(239, 68, 68, 0.3);\n  }\n}\n\n/* 动画 */\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n@keyframes slideUp {\n  from {\n    transform: translateY(30px) scale(0.95);\n    opacity: 0;\n  }\n  to {\n    transform: translateY(0) scale(1);\n    opacity: 1;\n  }\n}\n\n/* 响应式调整 */\n@media (max-width: 480px) {\n  .card {\n    max-width: 95%;\n    min-height: 360px;\n  }\n\n  .router-view-container {\n    margin-top: 52px;\n    padding: 16px;\n  }\n\n  .top-button-group {\n    padding: 8px 12px;\n    gap: 6px;\n    height: 52px;\n  }\n\n  .btn {\n    padding: 6px 8px;\n    min-height: 44px;\n    font-size: 11px;\n  }\n\n  .btn-text {\n    font-size: 12px;\n  }\n\n  .close-x {\n    top: 58px;\n    right: 12px;\n    width: 26px;\n    height: 26px;\n    font-size: 16px;\n  }\n\n  .content {\n    border-radius: 10px;\n  }\n}\n'],sourceRoot:''}]);const l=r},3035:(n,t,a)=>{n.exports=(e=>{var n={};return a.d(n,e),n})({createPinia:()=>e.createPinia,defineStore:()=>e.defineStore,storeToRefs:()=>e.storeToRefs})},3300:(e,n,t)=>{t.d(n,{A:()=>c});var a=t(4061),o=t(1960);const A={class:'file-import-export'},r=['accept'],l={key:0,class:'button-group'},i={key:0,class:'loading-spinner'},d={key:0,class:'loading-spinner'},s=(0,a.defineComponent)({__name:'FileImportExport',props:{accept:{default:'.json'},importText:{default:'导入'},exportText:{default:'导出'},confirmTitle:{default:'导入确认'},confirmContent:{default:'导入新数据将覆盖当前数据，确定要继续吗？'},confirmText:{default:'确认导入'},cancelText:{default:'取消'},showButtons:{type:Boolean,default:!0},requireConfirm:{type:Boolean,default:!0}},emits:['file-selected','file-loaded','export-data','import-confirmed','error','message'],setup(e,{emit:n}){const t=e,s=n,c=(0,a.ref)(null),p=(0,a.ref)(!1),C=(0,a.ref)(!1),u=(0,a.ref)(!1),f=(0,a.ref)(null),m=(0,a.ref)(null);function b(){C.value||c.value&&c.value.click()}function g(e){const n=e.target;if(!n.files||0===n.files.length)return;const a=n.files[0];s('file-selected',a);const o=new FileReader;o.onload=e=>{try{const n=e.target?.result;t.requireConfirm?(m.value={content:n,file:a},p.value=!0):s('import-confirmed',n,a),s('file-loaded',n,a)}catch(e){const n=`文件读取失败: ${e}`;k(n,'error'),s('error',n)}finally{c.value&&(c.value.value='')}},o.onerror=()=>{const e='文件读取错误';k(e,'error'),s('error',e),c.value&&(c.value.value='')},o.readAsText(a)}function v(){if(p.value=!1,m.value){C.value=!0;try{s('import-confirmed',m.value.content,m.value.file),k('导入成功','success')}catch(e){const n=`导入失败: ${e}`;k(n,'error'),s('error',n)}finally{m.value=null,C.value=!1}}}function x(){p.value=!1,m.value=null,c.value&&(c.value.value='')}function h(){if(!u.value){u.value=!0;try{s('export-data'),k('导出成功','success')}catch(e){const n=`导出失败: ${e}`;k(n,'error'),s('error',n)}finally{u.value=!1}}}function k(e,n){f.value={text:e,type:n},s('message',e,n),setTimeout(()=>{f.value=null},3e3)}return(n,t)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',A,[(0,a.createElementVNode)('input',{ref_key:'fileInputRef',ref:c,type:'file',accept:e.accept,style:{display:'none'},onChange:g},null,40,r),e.showButtons?((0,a.openBlock)(),(0,a.createElementBlock)('div',l,[(0,a.createElementVNode)('button',{class:(0,a.normalizeClass)(['btn small',{disabled:C.value}]),onClick:b},[C.value?((0,a.openBlock)(),(0,a.createElementBlock)('span',i)):(0,a.createCommentVNode)('v-if',!0),(0,a.createTextVNode)(' '+(0,a.toDisplayString)(e.importText),1)],2),(0,a.createElementVNode)('button',{class:(0,a.normalizeClass)(['btn small primary',{disabled:u.value}]),onClick:h},[u.value?((0,a.openBlock)(),(0,a.createElementBlock)('span',d)):(0,a.createCommentVNode)('v-if',!0),(0,a.createTextVNode)(' '+(0,a.toDisplayString)(e.exportText),1)],2),(0,a.renderSlot)(n.$slots,'extra-buttons')])):(0,a.createCommentVNode)('v-if',!0),(0,a.createCommentVNode)(' 确认对话框 '),(0,a.createVNode)(o.A,{visible:p.value,'onUpdate:visible':t[0]||(t[0]=e=>p.value=e),title:e.confirmTitle,content:e.confirmContent,type:'confirm','confirm-text':e.confirmText,'cancel-text':e.cancelText,onConfirm:v,onCancel:x},null,8,['visible','title','content','confirm-text','cancel-text']),(0,a.createCommentVNode)(' 消息提示 '),f.value?((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:1,class:(0,a.normalizeClass)(['status-message',f.value.type])},(0,a.toDisplayString)(f.value.text),3)):(0,a.createCommentVNode)('v-if',!0)]))}});t(3866);const c=(0,t(1400).A)(s,[['__scopeId','data-v-cf14256c']])},3385:(e,n,t)=>{var a=t(7157);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(4424).A)('0d6b1737',a,!1,{ssrId:!0})},3625:(e,n,t)=>{t.r(n),t.d(n,{default:()=>l});var a=t(1314),o=t.n(a),A=t(5378),r=t.n(A)()(o());r.push([e.id,'.modal-overlay[data-v-4b35b177]{position:fixed;inset:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1000;padding:20px;backdrop-filter:blur(2px)}.modal-content[data-v-4b35b177]{background:#fff;border-radius:12px;width:100%;max-width:400px;max-height:80vh;display:flex;flex-direction:column;box-shadow:0 20px 60px rgba(0,0,0,.3);animation:modal-appear-4b35b177 .2s ease-out}.modal-header[data-v-4b35b177]{padding:20px 24px 12px;border-bottom:1px solid #f0f0f0;display:flex;justify-content:space-between;align-items:center;flex-shrink:0}.modal-header h3[data-v-4b35b177]{margin:0;font-size:16px;font-weight:600;color:#111827}.modal-close[data-v-4b35b177]{background:none;border:none;font-size:24px;line-height:1;color:#9ca3af;cursor:pointer;padding:0;width:24px;height:24px;display:flex;align-items:center;justify-content:center;border-radius:4px;transition:all .2s}.modal-close[data-v-4b35b177]:hover{background:#f3f4f6;color:#6b7280}.modal-body[data-v-4b35b177]{padding:20px 24px;flex:1;overflow-y:auto}.modal-body p[data-v-4b35b177]{margin:0;font-size:14px;line-height:1.5;color:#4b5563}.modal-footer[data-v-4b35b177]{padding:12px 24px 20px;border-top:1px solid #f0f0f0;display:flex;gap:12px;justify-content:flex-end;flex-shrink:0}.btn[data-v-4b35b177]{padding:8px 16px;border:none;border-radius:6px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s;min-width:70px}.btn.primary[data-v-4b35b177]{background:#6366f1;color:#fff}.btn.primary[data-v-4b35b177]:hover{background:#4f46e5}.btn.primary[data-v-4b35b177]:active{background:#4338ca}.btn[data-v-4b35b177]{background:#f3f4f6;color:#374151}.btn[data-v-4b35b177]:hover{background:#e5e7eb}.btn[data-v-4b35b177]:active{background:#d1d5db}@keyframes modal-appear-4b35b177{from{opacity:0;transform:translateY(20px) scale(0.95)}to{opacity:1;transform:translateY(0) scale(1)}}.modal-enter-active[data-v-4b35b177],.modal-leave-active[data-v-4b35b177]{transition:opacity .2s ease}.modal-enter-from[data-v-4b35b177],.modal-leave-to[data-v-4b35b177]{opacity:0}@media (max-width:480px){.modal-content[data-v-4b35b177]{margin:0 16px}.modal-header[data-v-4b35b177],.modal-body[data-v-4b35b177],.modal-footer[data-v-4b35b177]{padding-left:20px;padding-right:20px}}','',{version:3,sources:['webpack://./src/ERA助手/UI/components/Dialog/EraConfirmModal.vue'],names:[],mappings:'AACA,gCACE,cAAA,CACA,OAAA,CACA,yBAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CACA,YAAA,CACA,YAAA,CACA,yBAAA,CAGF,gCACE,eAAA,CACA,kBAAA,CACA,UAAA,CACA,eAAA,CACA,eAAA,CACA,YAAA,CACA,qBAAA,CACA,qCAAA,CACA,4CAAA,CAGF,+BACE,sBAAA,CACA,+BAAA,CACA,YAAA,CACA,6BAAA,CACA,kBAAA,CACA,aAAA,CAGF,kCACE,QAAA,CACA,cAAA,CACA,eAAA,CACA,aAAA,CAGF,8BACE,eAAA,CACA,WAAA,CACA,cAAA,CACA,aAAA,CACA,aAAA,CACA,cAAA,CACA,SAAA,CACA,UAAA,CACA,WAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CACA,iBAAA,CACA,kBAAA,CAEA,oCACE,kBAAA,CACA,aAAA,CAIJ,6BACE,iBAAA,CACA,MAAA,CACA,eAAA,CAGF,+BACE,QAAA,CACA,cAAA,CACA,eAAA,CACA,aAAA,CAGF,+BACE,sBAAA,CACA,4BAAA,CACA,YAAA,CACA,QAAA,CACA,wBAAA,CACA,aAAA,CAGF,sBACE,gBAAA,CACA,WAAA,CACA,iBAAA,CACA,cAAA,CACA,eAAA,CACA,cAAA,CACA,kBAAA,CACA,cAAA,CAGF,8BACE,kBAAA,CACA,UAAA,CAEA,oCACE,kBAAA,CAGF,qCACE,kBAAA,CAIJ,sBACE,kBAAA,CACA,aAAA,CAEA,4BACE,kBAAA,CAGF,6BACE,kBAAA,CAKJ,iCACE,KACE,SAAA,CACA,sCAAA,CAEF,GACE,SAAA,CACA,gCAAA,CAAA,CAIJ,0EAEE,2BAAA,CAGF,oEAEE,SAAA,CAIF,yBACE,gCACE,aAAA,CAGF,2FAGE,iBAAA,CACA,kBAAA,CAAA',sourcesContent:['\n.modal-overlay {\n  position: fixed;\n  inset: 0;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n  padding: 20px;\n  backdrop-filter: blur(2px);\n}\n\n.modal-content {\n  background: #ffffff;\n  border-radius: 12px;\n  width: 100%;\n  max-width: 400px;\n  max-height: 80vh;\n  display: flex;\n  flex-direction: column;\n  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n  animation: modal-appear 0.2s ease-out;\n}\n\n.modal-header {\n  padding: 20px 24px 12px;\n  border-bottom: 1px solid #f0f0f0;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  flex-shrink: 0;\n}\n\n.modal-header h3 {\n  margin: 0;\n  font-size: 16px;\n  font-weight: 600;\n  color: #111827;\n}\n\n.modal-close {\n  background: none;\n  border: none;\n  font-size: 24px;\n  line-height: 1;\n  color: #9ca3af;\n  cursor: pointer;\n  padding: 0;\n  width: 24px;\n  height: 24px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 4px;\n  transition: all 0.2s;\n\n  &:hover {\n    background: #f3f4f6;\n    color: #6b7280;\n  }\n}\n\n.modal-body {\n  padding: 20px 24px;\n  flex: 1;\n  overflow-y: auto;\n}\n\n.modal-body p {\n  margin: 0;\n  font-size: 14px;\n  line-height: 1.5;\n  color: #4b5563;\n}\n\n.modal-footer {\n  padding: 12px 24px 20px;\n  border-top: 1px solid #f0f0f0;\n  display: flex;\n  gap: 12px;\n  justify-content: flex-end;\n  flex-shrink: 0;\n}\n\n.btn {\n  padding: 8px 16px;\n  border: none;\n  border-radius: 6px;\n  font-size: 13px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s;\n  min-width: 70px;\n}\n\n.btn.primary {\n  background: #6366f1;\n  color: white;\n\n  &:hover {\n    background: #4f46e5;\n  }\n\n  &:active {\n    background: #4338ca;\n  }\n}\n\n.btn {\n  background: #f3f4f6;\n  color: #374151;\n\n  &:hover {\n    background: #e5e7eb;\n  }\n\n  &:active {\n    background: #d1d5db;\n  }\n}\n\n/* 动画 */\n@keyframes modal-appear {\n  from {\n    opacity: 0;\n    transform: translateY(20px) scale(0.95);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0) scale(1);\n  }\n}\n\n.modal-enter-active,\n.modal-leave-active {\n  transition: opacity 0.2s ease;\n}\n\n.modal-enter-from,\n.modal-leave-to {\n  opacity: 0;\n}\n\n/* 响应式 */\n@media (max-width: 480px) {\n  .modal-content {\n    margin: 0 16px;\n  }\n\n  .modal-header,\n  .modal-body,\n  .modal-footer {\n    padding-left: 20px;\n    padding-right: 20px;\n  }\n}\n'],sourceRoot:''}]);const l=r},3722:(e,n,t)=>{t.d(n,{default:()=>b}),t.r(n);var a=t(4061);const o={class:'version-container'},A={class:'section'},r={class:'author-info'},l=['href'],i={class:'section'},d={class:'version-badge'},s={class:'section'},c={class:'history-list'},p={class:'history-header'},C={class:'version-number'},u={class:'version-date'},f={class:'changes-list'},m=(0,a.defineComponent)({__name:'VersionInformation',setup(e){const n=(0,a.ref)('v1.0.0'),t=(0,a.ref)({name:'cat987',github:'https://github.com/Malkuku/EraHelper-all-in-one-solution-for-ERA-scripts'}),m=(0,a.ref)([{version:'v1.0.1',date:'2025-12-15',changes:['修复 limit 和 range 可能保存为包含空字符串的问题','调整优化了rule的导出顺序']},{version:'v1.0.0',date:'2025-12-13',changes:['发布首个版本。']}]);return(e,b)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',o,[(0,a.createElementVNode)('div',A,[b[3]||(b[3]=(0,a.createElementVNode)('h2',{class:'section-title'},'作者信息',-1)),(0,a.createElementVNode)('p',r,[b[0]||(b[0]=(0,a.createTextVNode)(' 开发者: ',-1)),(0,a.createElementVNode)('strong',null,(0,a.toDisplayString)(t.value.name),1),b[1]||(b[1]=(0,a.createElementVNode)('br',null,null,-1)),b[2]||(b[2]=(0,a.createTextVNode)(' Github: ',-1)),(0,a.createElementVNode)('a',{href:t.value.github,target:'_blank',rel:'noopener noreferrer'},(0,a.toDisplayString)(t.value.github),9,l)])]),(0,a.createElementVNode)('div',i,[b[4]||(b[4]=(0,a.createElementVNode)('h2',{class:'section-title'},'当前版本',-1)),(0,a.createElementVNode)('p',null,[(0,a.createElementVNode)('span',d,(0,a.toDisplayString)(n.value),1)])]),b[6]||(b[6]=(0,a.createStaticVNode)('<div class="section" data-v-ac7a0140><h2 class="section-title" data-v-ac7a0140>免责声明</h2><ul class="notes-list" data-v-ac7a0140><li data-v-ac7a0140> 本插件仅供个人学习与技术交流使用，严禁用于任何商业目的或非法活动。使用者需自行承担因使用本插件而产生的一切风险与法律责任，开发者对此不承担任何责任。 </li></ul><h2 class="section-title" data-v-ac7a0140>注意事项</h2><ul class="notes-list" data-v-ac7a0140><li data-v-ac7a0140>目前版本仍处于早期测试阶段,可能会存在较多bug,请注意保存好自己的数据</li><li data-v-ac7a0140>在使用[文件导入导出]功能时,请确认好文件的来源,以避免受到恶意攻击</li><li data-v-ac7a0140>当前移动端的适配还尚不完善,请尽量使用PC端进行开发</li></ul></div>',1)),(0,a.createElementVNode)('div',s,[b[5]||(b[5]=(0,a.createElementVNode)('h2',{class:'section-title'},'更新日志',-1)),(0,a.createElementVNode)('div',c,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(m.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)('article',{key:e.version,class:'history-item'},[(0,a.createElementVNode)('header',p,[(0,a.createElementVNode)('h3',C,(0,a.toDisplayString)(e.version),1),(0,a.createElementVNode)('time',u,(0,a.toDisplayString)(e.date),1)]),(0,a.createElementVNode)('ul',f,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.changes,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)('li',{key:n},(0,a.toDisplayString)(e),1))),128))])]))),128))])])]))}});t(570);const b=(0,t(1400).A)(m,[['__scopeId','data-v-ac7a0140']])},3866:(e,n,t)=>{var a=t(342);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(4424).A)('49558ef6',a,!1,{ssrId:!0})},4061:e=>{e.exports=Vue},4126:(e,n,t)=>{t.r(n),t.d(n,{default:()=>l});var a=t(1314),o=t.n(a),A=t(5378),r=t.n(A)()(o());r.push([e.id,'.version-container[data-v-ac7a0140]{padding:8px 16px;font-family:"Inter",sans-serif;color:#334155;line-height:1.6}.section[data-v-ac7a0140]{margin-bottom:2.5rem}.section-title[data-v-ac7a0140]{font-size:1.25rem;font-weight:600;color:#334155;margin-bottom:1rem;padding-bottom:.5rem;border-bottom:1px solid #e2e8f0}.author-info[data-v-ac7a0140]{font-size:.9rem}.author-info a[data-v-ac7a0140]{color:#4f46e5;text-decoration:none;transition:color .2s ease}.author-info a[data-v-ac7a0140]:hover{color:rgb(41.1374407583,30.5592417062,217.4407582938);text-decoration:underline}.version-badge[data-v-ac7a0140]{display:inline-block;background-color:#4f46e5;color:#fff;padding:.3em .8em;border-radius:1em;font-size:1rem;font-weight:700;letter-spacing:.5px}.notes-list[data-v-ac7a0140],.changes-list[data-v-ac7a0140]{list-style-type:disc;padding-left:20px;font-size:.9rem;color:#64748b}.notes-list li[data-v-ac7a0140],.changes-list li[data-v-ac7a0140]{margin-bottom:.5rem}.history-list[data-v-ac7a0140]{display:flex;flex-direction:column;gap:1.5rem}.history-item[data-v-ac7a0140]{background:#f8fafc;border:1px solid #e2e8f0;border-radius:12px;padding:1rem 1.5rem;transition:transform .2s ease,box-shadow .2s ease}.history-item[data-v-ac7a0140]:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,.05)}.history-header[data-v-ac7a0140]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.75rem}.version-number[data-v-ac7a0140]{font-size:1.1rem;font-weight:600;color:#4f46e5}.version-date[data-v-ac7a0140]{font-size:.8rem;color:#64748b;font-style:italic}.changes-list[data-v-ac7a0140]{color:#475569}','',{version:3,sources:['webpack://./src/ERA助手/UI/view/VersionInformation.vue'],names:[],mappings:'AACA,oCACE,gBAAA,CACA,8BAAA,CACA,aAAA,CACA,eAAA,CAGF,0BACE,oBAAA,CAGF,gCACE,iBAAA,CACA,eAAA,CACA,aAAA,CACA,kBAAA,CACA,oBAAA,CACA,+BAAA,CAGF,8BACE,eAAA,CACA,gCACE,aAAA,CACA,oBAAA,CACA,yBAAA,CACA,sCACE,qDAAA,CACA,yBAAA,CAKN,gCACE,oBAAA,CACA,wBAAA,CACA,UAAA,CACA,iBAAA,CACA,iBAAA,CACA,cAAA,CACA,eAAA,CACA,mBAAA,CAGF,4DAEE,oBAAA,CACA,iBAAA,CACA,eAAA,CACA,aAAA,CAEA,kEACE,mBAAA,CAIJ,+BACE,YAAA,CACA,qBAAA,CACA,UAAA,CAGF,+BACE,kBAAA,CACA,wBAAA,CACA,kBAAA,CACA,mBAAA,CACA,iDACE,CAGF,qCACE,0BAAA,CACA,qCAAA,CAIJ,iCACE,YAAA,CACA,6BAAA,CACA,kBAAA,CACA,oBAAA,CAGF,iCACE,gBAAA,CACA,eAAA,CACA,aAAA,CAGF,+BACE,eAAA,CACA,aAAA,CACA,iBAAA,CAGF,+BACE,aAAA',sourcesContent:['\n.version-container {\n  padding: 8px 16px;\n  font-family: \'Inter\', sans-serif;\n  color: #334155;\n  line-height: 1.6;\n}\n\n.section {\n  margin-bottom: 2.5rem;\n}\n\n.section-title {\n  font-size: 1.25rem;\n  font-weight: 600;\n  color: #334155;\n  margin-bottom: 1rem;\n  padding-bottom: 0.5rem;\n  border-bottom: 1px solid #e2e8f0;\n}\n\n.author-info {\n  font-size: 0.9rem;\n  a {\n    color: #4f46e5;\n    text-decoration: none;\n    transition: color 0.2s ease;\n    &:hover {\n      color: darken(#4f46e5, 10%);\n      text-decoration: underline;\n    }\n  }\n}\n\n.version-badge {\n  display: inline-block;\n  background-color: #4f46e5;\n  color: white;\n  padding: 0.3em 0.8em;\n  border-radius: 1em;\n  font-size: 1rem;\n  font-weight: 700;\n  letter-spacing: 0.5px;\n}\n\n.notes-list,\n.changes-list {\n  list-style-type: disc;\n  padding-left: 20px;\n  font-size: 0.9rem;\n  color: #64748b;\n\n  li {\n    margin-bottom: 0.5rem;\n  }\n}\n\n.history-list {\n  display: flex;\n  flex-direction: column;\n  gap: 1.5rem;\n}\n\n.history-item {\n  background: #f8fafc;\n  border: 1px solid #e2e8f0;\n  border-radius: 12px;\n  padding: 1rem 1.5rem;\n  transition:\n    transform 0.2s ease,\n    box-shadow 0.2s ease;\n\n  &:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\n  }\n}\n\n.history-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0.75rem;\n}\n\n.version-number {\n  font-size: 1.1rem;\n  font-weight: 600;\n  color: #4f46e5;\n}\n\n.version-date {\n  font-size: 0.8rem;\n  color: #64748b;\n  font-style: italic;\n}\n\n.changes-list {\n  color: #475569;\n}\n'],sourceRoot:''}]);const l=r},4167:(e,n,t)=>{t.d(n,{X:()=>o});const a=async()=>{const{primary:e}=getCharWorldbookNames('current');if(!e)throw new Error('未能找到当前角色的世界书。');return e},o={getCurrentCharWorldBookPrimary:a,getWorldBookContent:async e=>{const n=await a(),t=await getWorldbook(n);let o='';return t.filter(n=>e.includes(n.name)).sort((e,n)=>e.position.order-n.position.order).forEach(e=>{o+=e.content}),o},getAllWorldBookNames:async()=>{const e=await a();return(await getWorldbook(e)).map(e=>e.name)},filterWorldBookNamesRegex:(e,n)=>n.filter(n=>e.test(n)),enabledEntry:async e=>{const n=await a(),t=await getWorldbook(n);return!e.find(e=>!t.some(n=>n.name===e.name))&&(await updateWorldbookWith(n,n=>n.map(n=>{const t=e.find(e=>e.name===n.name);return t?{...n,enabled:t.enabled}:n})),!0)},removeLoresByRegex:async(e,n,t)=>{console.info('removeLoresByRegex: ','开始过滤',n,t);const a=e=>_.remove(e,e=>t?!e.comment.match(n):e.comment.match(n));a(e.globalLore),a(e.characterLore),a(e.chatLore),a(e.personaLore),console.log('removeLoresByRegex过滤完成: ',e)},removeLoresByArray:async(e,n,t)=>{console.info('removeLoresByArray: ','开始过滤',n,t);const a=e=>_.remove(e,e=>t?!n.includes(e.comment):n.includes(e.comment));a(e.globalLore),a(e.characterLore),a(e.chatLore),a(e.personaLore),console.log('removeLoresByArray过滤完成: ',e)}}},4208:(e,n,t)=>{t.d(n,{default:()=>o}),t.r(n);var a=t(4061);const o=(0,a.defineComponent)({__name:'MyTempTest',setup(e){const n=()=>{};return(e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',null,[(0,a.createElementVNode)('button',{onClick:n},'测试DSL')]))}})},4424:(e,n,t)=>{function a(e,n){for(var t=[],a={},o=0;o<n.length;o++){var A=n[o],r=A[0],l={id:e+':'+o,css:A[1],media:A[2],sourceMap:A[3]};a[r]?a[r].parts.push(l):t.push(a[r]={id:r,parts:[l]})}return t}t.d(n,{A:()=>u});var o='undefined'!=typeof document;if('undefined'!=typeof DEBUG&&DEBUG&&!o)throw new Error('vue-style-loader cannot be used in a non-browser environment. Use { target: \'node\' } in your Webpack config to indicate a server-rendering environment.');var A={},r=o&&(document.head||document.getElementsByTagName('head')[0]),l=null,i=0,d=!1,s=function(){},c=null,p='data-vue-ssr-id',C='undefined'!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function u(e,n,t,o){d=t,c=o||{};var r=a(e,n);return f(r),function(n){for(var t=[],o=0;o<r.length;o++){var l=r[o];(i=A[l.id]).refs--,t.push(i)}n?f(r=a(e,n)):r=[];for(o=0;o<t.length;o++){var i;if(0===(i=t[o]).refs){for(var d=0;d<i.parts.length;d++)i.parts[d]();delete A[i.id]}}}}function f(e){for(var n=0;n<e.length;n++){var t=e[n],a=A[t.id];if(a){a.refs++;for(var o=0;o<a.parts.length;o++)a.parts[o](t.parts[o]);for(;o<t.parts.length;o++)a.parts.push(b(t.parts[o]));a.parts.length>t.parts.length&&(a.parts.length=t.parts.length)}else{var r=[];for(o=0;o<t.parts.length;o++)r.push(b(t.parts[o]));A[t.id]={id:t.id,refs:1,parts:r}}}}function m(){var e=document.createElement('style');return e.type='text/css',r.appendChild(e),e}function b(e){var n,t,a=document.querySelector('style['+p+'~="'+e.id+'"]');if(a){if(d)return s;a.parentNode.removeChild(a)}if(C){var o=i++;a=l||(l=m()),n=x.bind(null,a,o,!1),t=x.bind(null,a,o,!0)}else a=m(),n=h.bind(null,a),t=function(){a.parentNode.removeChild(a)};return n(e),function(a){if(a){if(a.css===e.css&&a.media===e.media&&a.sourceMap===e.sourceMap)return;n(e=a)}else t()}}var g,v=(g=[],function(e,n){return g[e]=n,g.filter(Boolean).join('\n')});function x(e,n,t,a){var o=t?'':a.css;if(e.styleSheet)e.styleSheet.cssText=v(n,o);else{var A=document.createTextNode(o),r=e.childNodes;r[n]&&e.removeChild(r[n]),r.length?e.insertBefore(A,r[n]):e.appendChild(A)}}function h(e,n){var t=n.css,a=n.media,o=n.sourceMap;if(a&&e.setAttribute('media',a),c.ssrId&&e.setAttribute(p,n.id),o&&(t+='\n/*# sourceURL='+o.sources[0]+' */',t+='\n/*# sourceMappingURL=data:application/json;base64,'+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+' */'),e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},4558:(e,n,t)=>{t.d(n,{default:()=>pe}),t.r(n);var a=t(4061),o=t(7664);const A=_;var r=t(1960),l=t(3300),i=t(1704),d=t(9761);const s={key:1,class:'space'},c={key:2,class:'editor-container'},p={key:3,class:'null-value'},C={key:1,class:'preview'},u={key:4,class:'actions'},f={key:0,class:'children-container'},m=(0,a.defineComponent)({__name:'JsonNodeEdit',props:{node:{},editingNodePath:{}},emits:['toggleExpand','startEdit','cancelEdit','saveEdit','addChild','removeNode'],setup(e,{emit:n}){const t=e,o=n,A=(0,a.ref)(null),r=(0,a.computed)(()=>t.node.path===t.editingNodePath),l=(0,a.ref)('string'),i=(0,a.ref)(''),d=(0,a.computed)(()=>{const e=t.node.value;return'string'==typeof e?`"${e}"`:String(e)}),m=(0,a.computed)(()=>{const e=t.node.value;return null===e?'type-null':'type-'+typeof e});function b(){t.node.isLeaf&&(l.value=function(e){if(null===e)return'null';const n=typeof e;return['string','number','boolean'].includes(n)?n:'string'}(t.node.value),i.value=t.node.value,o('startEdit',t.node.path))}function g(){b()}function v(){o('cancelEdit')}function x(){let e=i.value;'boolean'===l.value?e=Boolean(i.value):'null'===l.value&&(e=null),o('saveEdit',{path:t.node.path,value:e})}return(0,a.watch)(r,e=>{e&&(0,a.nextTick)(()=>{A.value?.focus(),A.value?.select()})}),(n,t)=>{const h=(0,a.resolveComponent)('JsonNodeEdit',!0);return(0,a.openBlock)(),(0,a.createElementBlock)('div',{class:'json-node',style:(0,a.normalizeStyle)({marginLeft:20*e.node.depth+'px'})},[(0,a.createElementVNode)('div',{class:(0,a.normalizeClass)(['line',{'is-editing':r.value}])},[(0,a.createCommentVNode)(' 折叠/展开箭头 '),e.node.isLeaf?((0,a.openBlock)(),(0,a.createElementBlock)('span',s)):((0,a.openBlock)(),(0,a.createElementBlock)('span',{key:0,class:(0,a.normalizeClass)(['arrow',{expanded:e.node.expanded}]),onClick:t[0]||(t[0]=n=>o('toggleExpand',e.node))},' ▶ ',2)),(0,a.createCommentVNode)(' Key '),(0,a.createElementVNode)('span',{class:'key',onDblclick:g},(0,a.toDisplayString)(e.node.key)+':',33),(0,a.createCommentVNode)(' 编辑器 '),r.value?((0,a.openBlock)(),(0,a.createElementBlock)('div',c,[(0,a.withDirectives)((0,a.createElementVNode)('select',{'onUpdate:modelValue':t[1]||(t[1]=e=>l.value=e),class:'edit-select'},[...t[13]||(t[13]=[(0,a.createElementVNode)('option',{value:'string'},'String',-1),(0,a.createElementVNode)('option',{value:'number'},'Number',-1),(0,a.createElementVNode)('option',{value:'boolean'},'Boolean',-1),(0,a.createElementVNode)('option',{value:'null'},'Null',-1)])],512),[[a.vModelSelect,l.value]]),'string'===l.value?(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)('input',{key:0,ref_key:'inputRef',ref:A,'onUpdate:modelValue':t[2]||(t[2]=e=>i.value=e),type:'text',class:'edit-input',onKeydown:[(0,a.withKeys)(x,['enter']),(0,a.withKeys)(v,['esc'])]},null,544)),[[a.vModelText,i.value]]):'number'===l.value?(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)('input',{key:1,ref_key:'inputRef',ref:A,'onUpdate:modelValue':t[3]||(t[3]=e=>i.value=e),type:'number',class:'edit-input',onKeydown:[(0,a.withKeys)(x,['enter']),(0,a.withKeys)(v,['esc'])]},null,544)),[[a.vModelText,i.value,void 0,{number:!0}]]):'boolean'===l.value?(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)('select',{key:2,ref_key:'inputRef',ref:A,'onUpdate:modelValue':t[4]||(t[4]=e=>i.value=e),class:'edit-input',onKeydown:[(0,a.withKeys)(x,['enter']),(0,a.withKeys)(v,['esc'])]},[...t[14]||(t[14]=[(0,a.createElementVNode)('option',{value:!0},'true',-1),(0,a.createElementVNode)('option',{value:!1},'false',-1)])],544)),[[a.vModelSelect,i.value]]):((0,a.openBlock)(),(0,a.createElementBlock)('span',p,'null')),(0,a.createElementVNode)('button',{class:'btn-action save',title:'保存',onClick:x},'✓'),(0,a.createElementVNode)('button',{class:'btn-action cancel',title:'取消',onClick:v},'✗')])):((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:3},[(0,a.createCommentVNode)(' 值 / 折叠预览 '),e.node.isLeaf?((0,a.openBlock)(),(0,a.createElementBlock)('span',{key:0,class:(0,a.normalizeClass)(['value',m.value]),onDblclick:g},(0,a.toDisplayString)(d.value),35)):e.node.expanded?(0,a.createCommentVNode)('v-if',!0):((0,a.openBlock)(),(0,a.createElementBlock)('span',C,(0,a.toDisplayString)(Array.isArray(e.node.value)?'[...]':'{...}'),1))],64)),(0,a.createCommentVNode)(' 操作按钮 (Flexbox布局) '),r.value?(0,a.createCommentVNode)('v-if',!0):((0,a.openBlock)(),(0,a.createElementBlock)('div',u,[e.node.isLeaf?(0,a.createCommentVNode)('v-if',!0):((0,a.openBlock)(),(0,a.createElementBlock)('button',{key:0,class:'btn-action',title:'添加子节点',onClick:t[5]||(t[5]=n=>o('addChild',{path:e.node.path,isObject:!Array.isArray(e.node.value)}))},' + ')),(0,a.createElementVNode)('button',{class:'btn-action',title:'编辑值',onClick:b},'✎'),(0,a.createElementVNode)('button',{class:'btn-action danger',title:'删除节点',onClick:t[6]||(t[6]=n=>o('removeNode',e.node.path))},'🗑')]))],2),(0,a.createCommentVNode)(' 子节点 '),e.node.expanded&&e.node.children?((0,a.openBlock)(),(0,a.createElementBlock)('div',f,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.node.children,n=>((0,a.openBlock)(),(0,a.createBlock)(h,{key:n.path,node:n,'editing-node-path':e.editingNodePath,onToggleExpand:t[7]||(t[7]=e=>o('toggleExpand',e)),onStartEdit:t[8]||(t[8]=e=>o('startEdit',e)),onCancelEdit:t[9]||(t[9]=e=>o('cancelEdit')),onSaveEdit:t[10]||(t[10]=e=>o('saveEdit',e)),onAddChild:t[11]||(t[11]=e=>o('addChild',e)),onRemoveNode:t[12]||(t[12]=e=>o('removeNode',e))},null,8,['node','editing-node-path']))),128))])):(0,a.createCommentVNode)('v-if',!0)],4)}}});t(382);var b=t(1400);const g=(0,b.A)(m,[['__scopeId','data-v-170e8619']]),v={class:'json-tree'},x={key:0,class:'empty-tree'},h=(0,a.defineComponent)({__name:'JsonTreeEdit',props:{data:{},searchQuery:{}},emits:['update:data'],setup(e,{emit:n}){const t=e,o=n,r=(0,a.ref)([]),l=(0,a.ref)(null);function i(e){const n=new Set;for(const t of e)t.expanded&&(n.add(t.path),t.children&&i(t.children).forEach(e=>n.add(e)));return n}function d(e,n){for(const t of e)n.has(t.path)&&(t.expanded=!0),t.children&&d(t.children,n)}function s(e,n=0,t=''){return null===e||'object'!=typeof e?[]:Object.keys(e).map(o=>{const A=e[o],r=t?Array.isArray(e)?`${t}[${o}]`:`${t}.${o}`:o,l=null===A||'object'!=typeof A;return(0,a.reactive)({key:o,value:A,depth:n,path:r,isLeaf:l,expanded:!1,children:l?void 0:s(A,n+1,r)})})}(0,a.watch)(()=>t.data,(e,n)=>{const t=i(r.value);r.value=s(e),d(r.value,t)},{immediate:!0});const c=(0,a.computed)(()=>{const e=(t.searchQuery||'').trim().toLowerCase();if(!e)return r.value;return function n(t){const a=[];for(const o of t){const t=String(o.key).toLowerCase().includes(e),A=o.isLeaf&&String(o.value).toLowerCase().includes(e),r=o.children?n(o.children):[];(t||A||r.length>0)&&(o.expanded=r.length>0,o.children=r,a.push(o))}return a}((0,A.cloneDeep)(r.value))});function p(e,n){for(const t of e){if(t.path===n)return t;if(n.startsWith(t.path)&&t.children){const e=p(t.children,n);if(e)return e}}return null}function C(e){const n=p(r.value,e.path);n&&(n.expanded=!n.expanded)}function u(e){l.value=e}function f(){l.value=null}function m({path:e,value:n}){const a=(0,A.cloneDeep)(t.data);(0,A.set)(a,e,n),o('update:data',a),l.value=null}function b({path:e,isObject:n}){const a=(0,A.cloneDeep)(t.data),i=(0,A.get)(a,e);if(void 0===i||'object'!=typeof i)return void console.warn(`Cannot add child to non-object path: ${e}`);const d=n?'newKey':i.length,s=n?`${e}.newKey`:`${e}[${d}]`;(0,A.set)(a,s,'newValue'),o('update:data',a);const c=p(r.value,e);c&&(c.expanded=!0),setTimeout(()=>{l.value=s},100)}function h(e){const n=(0,A.cloneDeep)(t.data);(0,A.unset)(n,e);const a=e.substring(0,e.lastIndexOf('.'))||e.substring(0,e.lastIndexOf('['));if(a){const e=(0,A.get)(n,a);if(Array.isArray(e)){const t=e.filter(e=>null!=e);(0,A.set)(n,a,t)}}o('update:data',n)}return(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',v,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(c.value,e=>((0,a.openBlock)(),(0,a.createBlock)(g,{key:e.path,node:e,'editing-node-path':l.value,onToggleExpand:C,onStartEdit:u,onCancelEdit:f,onSaveEdit:m,onAddChild:b,onRemoveNode:h},null,8,['node','editing-node-path']))),128)),0===c.value.length&&r.value.length>0?((0,a.openBlock)(),(0,a.createElementBlock)('div',x,'没有匹配的搜索结果。')):(0,a.createCommentVNode)('v-if',!0)]))}});t(6385);const k=(0,b.A)(h,[['__scopeId','data-v-1e416d58']]),E={class:'stat-data-editor'},y={class:'editor-toolbar'},w={class:'toolbar-left'},B=['disabled'],N=['disabled'],V={class:'toolbar-right'},F={key:0,class:'change-indicator'},S={class:'data-container'},j={key:0,class:'loading-container'},D={key:1,class:'empty-container'},G={key:2,class:'json-editor-wrapper'},I={class:'edit-tools'},O={class:'mode-buttons'},M=['disabled'],U=['disabled'],T={key:0,class:'tree-editor'},R={class:'raw-editor'},Y={class:'editor-header'},L={class:'editor-size'},J={key:0,class:'json-error'},W={key:0,class:'modal-overlay'},P={class:'modal'},q={class:'modal-body'},K={class:'form-group'},H={class:'form-group'},Q={key:0,class:'form-group'},X={class:'form-group'},Z={class:'form-group'},ee={class:'boolean-options'},ne={class:'boolean-option'},te={class:'boolean-option'},ae={class:'form-group'},oe={class:'json-editor-container'},Ae={class:'json-editor-header'},re=['placeholder'],le={key:0,class:'json-error'},ie={key:1,class:'json-success'},de={class:'modal-actions'},se=['disabled'],ce=(0,a.defineComponent)({__name:'EraDataEditor',setup(e){const n=(0,o.l)(),t=(0,a.ref)(!1),s=(0,a.ref)(!1),c=(0,a.ref)(null),p=(0,a.ref)(null),C=(0,a.ref)(''),u=(0,a.ref)('tree'),f=(0,a.ref)(''),m=(0,a.ref)(''),b=(0,a.ref)(null);function g(){if(m.value)alert('JSON格式无效，无法切换到树形视图。请先修正错误。');else try{c.value=JSON.parse(f.value||'{}'),u.value='tree'}catch(e){m.value=e.message,alert('JSON格式无效，无法切换到树形视图。请先修正错误。')}}function v(){try{JSON.parse(f.value),m.value=''}catch(e){m.value=e.message}}(0,a.watch)(u,(e,n)=>{if('raw'===e)try{f.value=JSON.stringify(c.value,null,2),m.value=''}catch(e){f.value='无法序列化当前数据。',m.value=e instanceof Error?e.message:String(e)}});const x=(0,a.ref)('就绪'),h=(0,a.ref)(!1),ce=(0,a.ref)(''),pe=(0,a.ref)(''),Ce=(0,a.ref)('confirm'),ue=(0,a.ref)(()=>{});function fe(e,n,t='confirm',a){ce.value=e,pe.value=n,Ce.value=t,h.value=!0,ue.value=a||(()=>{})}function me(){ue.value(),ue.value=()=>{}}function be(){ue.value=()=>{}}function ge(e){try{c.value=JSON.parse(e),x.value='成功导入数据'}catch(e){d.j.error('导入数据失败:',e),x.value='导入失败，请检查文件格式',alert(`导入失败：${e instanceof Error?e.message:'未知错误'}`)}}const ve=(0,a.computed)(()=>{if('raw'===u.value){if(m.value)return!0;try{return f.value!==JSON.stringify(p.value,null,2)}catch{return!0}}try{return JSON.stringify(c.value)!==JSON.stringify(p.value)}catch{return!1}});function xe(){if(c.value)try{const e=`era-stat-data-${(new Date).toISOString().replace(/[:.]/g,'-').replace('T','_').slice(0,-5)}.json`,n=JSON.stringify(c.value,null,2),t=new Blob([n],{type:'application/json'}),a=URL.createObjectURL(t),o=document.createElement('a');o.href=a,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a),x.value='草稿导出成功'}catch(e){d.j.error('导出草稿失败:',e),x.value='导出草稿失败'}}async function he(){try{t.value=!0,x.value='正在加载数据...';const e=await n.getStatData();c.value=e,p.value=(0,A.cloneDeep)(e),x.value='数据已加载'}catch(e){d.j.error('加载数据失败:',e),x.value='加载失败',c.value=null}finally{t.value=!1}}async function ke(){if(ve.value)return'raw'===u.value&&m.value?(x.value='JSON格式错误，无法保存',void alert('JSON格式错误，请修正后再保存！')):void fe('保存确认','是否保存所有更改？','confirm',async()=>{try{s.value=!0,x.value='正在保存...';const e='raw'===u.value?JSON.parse(f.value):c.value;await n.saveEraEdit(e),p.value=(0,A.cloneDeep)(e),c.value=e,x.value='保存成功',setTimeout(()=>{x.value='就绪'},3e3)}catch(e){d.j.error('保存失败:',e),x.value='保存失败'}finally{s.value=!1}});fe('提示','没有需要保存的更改','alert')}function Ee(){if('raw'===u.value&&!m.value)try{const e=JSON.parse(f.value);f.value=JSON.stringify(e,null,2)}catch(e){d.j.error('格式化JSON失败:',e)}}const ye=(0,a.ref)(!1),we=(0,a.ref)(''),Be=(0,a.ref)(!1),Ne=(0,a.ref)({path:'',type:'string',value:'',jsonValue:''}),Ve=(0,a.computed)(()=>{const{path:e,type:n}=Ne.value;if(!e.trim())return!1;switch(n){case'string':return'string'==typeof Ne.value.value;case'number':return'number'==typeof Ne.value.value||''!==String(Ne.value.value).trim();case'boolean':return'boolean'==typeof Ne.value.value;case'null':return!0;case'object':case'array':return Be.value&&''!==Ne.value.jsonValue.trim();default:return!1}});function Fe(){switch(Ne.value.type){case'string':Ne.value.value='';break;case'number':Ne.value.value=0;break;case'boolean':Ne.value.value=!0;break;case'null':Ne.value.value=null;break;case'object':Ne.value.jsonValue='{}',Se();break;case'array':Ne.value.jsonValue='[]',Se()}}function Se(){const e=Ne.value.jsonValue.trim();if(!e)return we.value='',void(Be.value=!1);try{const n=JSON.parse(e);'object'!==Ne.value.type||'object'==typeof n&&!Array.isArray(n)&&null!==n?'array'!==Ne.value.type||Array.isArray(n)?(we.value='',Be.value=!0):(we.value='必须是有效的JSON数组',Be.value=!1):(we.value='必须是有效的JSON对象',Be.value=!1)}catch(e){we.value=e instanceof Error?e.message:'无效的JSON格式',Be.value=!1}}function je(){if(Be.value)try{const e=JSON.parse(Ne.value.jsonValue);Ne.value.jsonValue=JSON.stringify(e,null,2)}catch(e){we.value=e instanceof Error?e.message:'无效的JSON格式'}}function ze(){Ne.value={path:'',type:'string',value:'',jsonValue:''},we.value='',Be.value=!1,ye.value=!0}function De(){ye.value=!1}function Ge(){if(Ve.value)try{let e;switch(Ne.value.type){case'string':case'boolean':e=Ne.value.value;break;case'number':if(e=Number(Ne.value.value),isNaN(e))return void alert('请输入有效的数字');break;case'null':e=null;break;case'object':case'array':e=JSON.parse(Ne.value.jsonValue)}(0,A.set)(c.value,Ne.value.path,e),x.value='已添加新字段',ye.value=!1}catch(e){d.j.error('添加字段失败:',e),alert(`添加字段失败：${e instanceof Error?e.message:'未知错误'}`)}else alert('请输入有效的字段路径和值')}return(0,a.onMounted)(()=>{he()}),(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',E,[(0,a.createCommentVNode)(' 顶部工具栏 '),(0,a.createElementVNode)('div',y,[(0,a.createElementVNode)('div',w,[(0,a.createElementVNode)('button',{class:'toolbar-btn',disabled:t.value,onClick:he},[...n[12]||(n[12]=[(0,a.createElementVNode)('svg',{class:'icon',viewBox:'0 0 16 16',fill:'currentColor'},[(0,a.createElementVNode)('path',{d:'M13.5 8C13.5 11.0376 11.0376 13.5 8 13.5C4.96243 13.5 2.5 11.0376 2.5 8C2.5 4.96243 4.96243 2.5 8 2.5C9.37676 2.5 10.6396 3.01285 11.596 3.85652L12.5 2.5H14V6H10.5V4.5H11.7906C11.0431 3.53528 9.8382 3 8.5 3C6.01472 3 4 5.01472 4 7.5C4 9.98528 6.01472 12 8.5 12C10.9853 12 13 9.98528 13 7.5H14.5C14.5 11.0376 11.0376 14.5 8 14.5C4.96243 14.5 2.5 12.0376 2.5 9C2.5 5.96243 4.96243 3.5 8 3.5C9.4619 3.5 10.7872 4.11611 11.7227 5.12644L12.5 6H14V2.5H12.5L11.596 3.85652Z'})],-1),(0,a.createTextVNode)(' 刷新数据 ',-1)])],8,B),(0,a.createElementVNode)('button',{class:'toolbar-btn',disabled:s.value||!ve.value,onClick:ke},[...n[13]||(n[13]=[(0,a.createElementVNode)('svg',{class:'icon',viewBox:'0 0 16 16',fill:'currentColor'},[(0,a.createElementVNode)('path',{d:'M13.3536 2.64645C13.5488 2.84171 13.5488 3.15829 13.3536 3.35355L6.35355 10.3536C6.15829 10.5488 5.84171 10.5488 5.64645 10.3536L3.64645 8.35355C3.45118 8.15829 3.45118 7.84171 3.64645 7.64645C3.84171 7.45118 4.15829 7.45118 4.35355 7.64645L6 9.29289L12.6464 2.64645C12.8417 2.45118 13.1583 2.45118 13.3536 2.64645Z'})],-1),(0,a.createTextVNode)(' 保存更改 ',-1)])],8,N),(0,a.createCommentVNode)(' 使用 FileImportExport 组件替换原来的导入/导出按钮 '),(0,a.createVNode)(l.A,{ref_key:'fileImportExportRef',ref:b,'import-text':'导入JSON','export-text':'导出草稿','require-confirm':!0,onImportConfirmed:ge,onExportData:xe},null,512)]),(0,a.createElementVNode)('div',V,[ve.value?((0,a.openBlock)(),(0,a.createElementBlock)('div',F,[...n[14]||(n[14]=[(0,a.createElementVNode)('span',{class:'dot'},null,-1),(0,a.createTextVNode)(' 有未保存的更改 ',-1)])])):(0,a.createCommentVNode)('v-if',!0),(0,a.createElementVNode)('div',{class:(0,a.normalizeClass)(['status-text',{'status-loading':t.value}])},(0,a.toDisplayString)(x.value),3)])]),(0,a.createCommentVNode)(' 搜索框 '),(0,a.createVNode)(i.A,{modelValue:C.value,'onUpdate:modelValue':n[0]||(n[0]=e=>C.value=e)},null,8,['modelValue']),(0,a.createCommentVNode)(' 数据展示区域 '),(0,a.createElementVNode)('div',S,[t.value?((0,a.openBlock)(),(0,a.createElementBlock)('div',j,[...n[15]||(n[15]=[(0,a.createElementVNode)('div',{class:'spinner'},null,-1),(0,a.createElementVNode)('div',null,'正在加载数据...',-1)])])):c.value&&0!==Object.keys(c.value).length?((0,a.openBlock)(),(0,a.createElementBlock)('div',G,[(0,a.createCommentVNode)(' 工具按钮区 '),(0,a.createElementVNode)('div',I,[(0,a.createElementVNode)('div',O,[(0,a.createElementVNode)('button',{class:(0,a.normalizeClass)(['mode-btn',{active:'tree'===u.value}]),onClick:g},[...n[18]||(n[18]=[(0,a.createElementVNode)('svg',{class:'mode-icon',viewBox:'0 0 16 16',fill:'currentColor'},[(0,a.createElementVNode)('path',{d:'M14 2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2zm0 5a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V7zm0 5a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-2z'})],-1),(0,a.createTextVNode)(' 树形视图 ',-1)])],2),(0,a.createElementVNode)('button',{class:'tool-btn',disabled:'tree'!==u.value,onClick:ze},[...n[19]||(n[19]=[(0,a.createElementVNode)('svg',{class:'tool-icon',viewBox:'0 0 16 16',fill:'currentColor'},[(0,a.createElementVNode)('path',{d:'M8 0a1 1 0 0 1 1 1v6h6a1 1 0 0 1 0 2H9v6a1 1 0 0 1-2 0V9H1a1 1 0 0 1 0-2h6V1a1 1 0 0 1 1-1z'})],-1),(0,a.createTextVNode)(' 添加字段 ',-1)])],8,M),(0,a.createElementVNode)('button',{class:(0,a.normalizeClass)(['mode-btn',{active:'raw'===u.value}]),onClick:n[1]||(n[1]=e=>u.value='raw')},[...n[20]||(n[20]=[(0,a.createElementVNode)('svg',{class:'mode-icon',viewBox:'0 0 16 16',fill:'currentColor'},[(0,a.createElementVNode)('path',{d:'M13.5 2h-11C1.67 2 1 2.67 1 3.5v9c0 .83.67 1.5 1.5 1.5h11c.83 0 1.5-.67 1.5-1.5v-9c0-.83-.67-1.5-1.5-1.5zM4 4h8v1H4V4zm0 3h8v1H4V7zm0 3h8v1H4v-1z'})],-1),(0,a.createTextVNode)(' 原始JSON ',-1)])],2),(0,a.createElementVNode)('button',{class:(0,a.normalizeClass)(['tool-btn',{danger:'raw'===u.value}]),disabled:'raw'!==u.value,onClick:Ee},[...n[21]||(n[21]=[(0,a.createElementVNode)('svg',{class:'tool-icon',viewBox:'0 0 16 16',fill:'currentColor'},[(0,a.createElementVNode)('path',{d:'M5 1h6v2H5V1zm0 12h6v2H5v-2zM1 5h2v6H1V5zm12 0h2v6h-2V5z'})],-1),(0,a.createTextVNode)(' 格式化 ',-1)])],10,U)])]),(0,a.createCommentVNode)(' 树形编辑视图 '),'tree'===u.value?((0,a.openBlock)(),(0,a.createElementBlock)('div',T,[(0,a.createCommentVNode)(' 使用重构后的 JsonTree 组件 '),(0,a.createVNode)(k,{data:c.value,'onUpdate:data':n[2]||(n[2]=e=>c.value=e),'search-query':C.value},null,8,['data','search-query'])])):((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[(0,a.createCommentVNode)(' 原始JSON编辑视图 '),(0,a.createElementVNode)('div',R,[(0,a.createElementVNode)('div',Y,[n[22]||(n[22]=(0,a.createElementVNode)('span',{class:'editor-info'},'编辑原始JSON数据',-1)),(0,a.createCommentVNode)(' v-model 改为 rawJsonString '),(0,a.createElementVNode)('span',L,'字符数：'+(0,a.toDisplayString)(f.value.length),1)]),(0,a.createCommentVNode)(' v-model 改为 rawJsonString，并添加 @input 事件 '),(0,a.withDirectives)((0,a.createElementVNode)('textarea',{'onUpdate:modelValue':n[3]||(n[3]=e=>f.value=e),class:'json-editor',placeholder:'在此输入或编辑JSON数据...',onInput:v},null,544),[[a.vModelText,f.value]]),(0,a.createCommentVNode)(' jsonParseError 的来源也变了 '),m.value?((0,a.openBlock)(),(0,a.createElementBlock)('div',J,[n[23]||(n[23]=(0,a.createElementVNode)('svg',{class:'error-icon',viewBox:'0 0 16 16',fill:'currentColor'},[(0,a.createElementVNode)('path',{d:'M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0zM7 3h2v7H7V3zm0 9h2v2H7v-2z'})],-1)),(0,a.createTextVNode)(' JSON语法错误：'+(0,a.toDisplayString)(m.value),1)])):(0,a.createCommentVNode)('v-if',!0)])],2112))])):((0,a.openBlock)(),(0,a.createElementBlock)('div',D,[n[16]||(n[16]=(0,a.createElementVNode)('svg',{class:'empty-icon',viewBox:'0 0 24 24',fill:'currentColor'},[(0,a.createElementVNode)('path',{d:'M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14z'}),(0,a.createElementVNode)('path',{d:'M7 7h10v2H7zm0 4h10v2H7zm0 4h7v2H7z'})],-1)),n[17]||(n[17]=(0,a.createElementVNode)('div',{class:'empty-text'},'暂无数据',-1)),(0,a.createElementVNode)('button',{class:'empty-btn',onClick:he},'点击加载数据')]))]),(0,a.createVNode)(r.A,{visible:h.value,'onUpdate:visible':n[4]||(n[4]=e=>h.value=e),title:ce.value,content:pe.value,type:Ce.value,onConfirm:me,onCancel:be},null,8,['visible','title','content','type']),(0,a.createCommentVNode)(' 添加字段模态框 '),ye.value?((0,a.openBlock)(),(0,a.createElementBlock)('div',W,[(0,a.createElementVNode)('div',P,[n[38]||(n[38]=(0,a.createElementVNode)('h3',null,'添加新字段',-1)),(0,a.createElementVNode)('div',q,[(0,a.createElementVNode)('div',K,[n[24]||(n[24]=(0,a.createElementVNode)('label',null,'字段路径：',-1)),(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':n[5]||(n[5]=e=>Ne.value.path=e),type:'text',placeholder:'例如：user.info.name',class:'form-input'},null,512),[[a.vModelText,Ne.value.path]]),n[25]||(n[25]=(0,a.createElementVNode)('div',{class:'form-hint'},'支持多层路径，用点分隔。如果父路径不存在会自动创建对象。',-1))]),(0,a.createElementVNode)('div',H,[n[27]||(n[27]=(0,a.createElementVNode)('label',null,'值类型：',-1)),(0,a.withDirectives)((0,a.createElementVNode)('select',{'onUpdate:modelValue':n[6]||(n[6]=e=>Ne.value.type=e),class:'form-select',onChange:Fe},[...n[26]||(n[26]=[(0,a.createStaticVNode)('<option value="string" data-v-d7550ac6>字符串</option><option value="number" data-v-d7550ac6>数字</option><option value="boolean" data-v-d7550ac6>布尔值</option><option value="null" data-v-d7550ac6>空值 (null)</option><option value="object" data-v-d7550ac6>对象 (JSON)</option><option value="array" data-v-d7550ac6>数组</option>',6)])],544),[[a.vModelSelect,Ne.value.type]])]),(0,a.createCommentVNode)(' 字符串输入 '),'string'===Ne.value.type?((0,a.openBlock)(),(0,a.createElementBlock)('div',Q,[n[28]||(n[28]=(0,a.createElementVNode)('label',null,'字符串值：',-1)),(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':n[7]||(n[7]=e=>Ne.value.value=e),type:'text',placeholder:'输入字符串值',class:'form-input'},null,512),[[a.vModelText,Ne.value.value]])])):'number'===Ne.value.type?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[(0,a.createCommentVNode)(' 数字输入 '),(0,a.createElementVNode)('div',X,[n[29]||(n[29]=(0,a.createElementVNode)('label',null,'数字值：',-1)),(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':n[8]||(n[8]=e=>Ne.value.value=e),type:'number',placeholder:'输入数字值',class:'form-input',step:'any'},null,512),[[a.vModelText,Ne.value.value,void 0,{number:!0}]])])],2112)):'boolean'===Ne.value.type?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:2},[(0,a.createCommentVNode)(' 布尔值选择 '),(0,a.createElementVNode)('div',Z,[n[32]||(n[32]=(0,a.createElementVNode)('label',null,'布尔值：',-1)),(0,a.createElementVNode)('div',ee,[(0,a.createElementVNode)('label',ne,[(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':n[9]||(n[9]=e=>Ne.value.value=e),type:'radio',value:!0},null,512),[[a.vModelRadio,Ne.value.value]]),n[30]||(n[30]=(0,a.createElementVNode)('span',null,'true',-1))]),(0,a.createElementVNode)('label',te,[(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':n[10]||(n[10]=e=>Ne.value.value=e),type:'radio',value:!1},null,512),[[a.vModelRadio,Ne.value.value]]),n[31]||(n[31]=(0,a.createElementVNode)('span',null,'false',-1))])])])],2112)):'null'===Ne.value.type?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:3},[(0,a.createCommentVNode)(' 空值显示 '),n[33]||(n[33]=(0,a.createElementVNode)('div',{class:'form-group'},[(0,a.createElementVNode)('div',{class:'null-info'},[(0,a.createElementVNode)('svg',{class:'null-icon',viewBox:'0 0 16 16',fill:'currentColor'},[(0,a.createElementVNode)('path',{d:'M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zM1.5 8a6.5 6.5 0 1 1 13 0 6.5 6.5 0 0 1-13 0z'})]),(0,a.createElementVNode)('span',null,'该字段将被设置为 null')])],-1))],2112)):'object'===Ne.value.type||'array'===Ne.value.type?((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:4},[(0,a.createCommentVNode)(' JSON对象/数组编辑器 '),(0,a.createElementVNode)('div',ae,[(0,a.createElementVNode)('label',null,(0,a.toDisplayString)('object'===Ne.value.type?'对象值 (JSON)':'数组值')+'：',1),(0,a.createElementVNode)('div',oe,[(0,a.createElementVNode)('div',Ae,[n[35]||(n[35]=(0,a.createElementVNode)('span',null,'JSON编辑器',-1)),Be.value?((0,a.openBlock)(),(0,a.createElementBlock)('button',{key:0,class:'btn-small',title:'格式化JSON',onClick:je},[...n[34]||(n[34]=[(0,a.createElementVNode)('svg',{class:'format-icon',viewBox:'0 0 16 16',fill:'currentColor'},[(0,a.createElementVNode)('path',{d:'M5 1h6v2H5V1zm0 12h6v2H5v-2zM1 5h2v6H1V5zm12 0h2v6h-2V5z'})],-1)])])):(0,a.createCommentVNode)('v-if',!0)]),(0,a.withDirectives)((0,a.createElementVNode)('textarea',{'onUpdate:modelValue':n[11]||(n[11]=e=>Ne.value.jsonValue=e),class:'json-editor-input',placeholder:'object'===Ne.value.type?'{\n  "key": "value"\n}':'[\n  "item1", 123\n]',rows:'6',onInput:Se},null,40,re),[[a.vModelText,Ne.value.jsonValue]]),we.value?((0,a.openBlock)(),(0,a.createElementBlock)('div',le,[n[36]||(n[36]=(0,a.createElementVNode)('svg',{class:'error-icon',viewBox:'0 0 16 16',fill:'currentColor'},[(0,a.createElementVNode)('path',{d:'M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0zM7 3h2v7H7V3zm0 9h2v2H7v-2z'})],-1)),(0,a.createElementVNode)('span',null,'JSON错误：'+(0,a.toDisplayString)(we.value),1)])):Ne.value.jsonValue.trim()?((0,a.openBlock)(),(0,a.createElementBlock)('div',ie,[...n[37]||(n[37]=[(0,a.createElementVNode)('svg',{class:'success-icon',viewBox:'0 0 16 16',fill:'currentColor'},[(0,a.createElementVNode)('path',{d:'M13.3536 2.64645C13.5488 2.84171 13.5488 3.15829 13.3536 3.35355L6.35355 10.3536C6.15829 10.5488 5.84171 10.5488 5.64645 10.3536L3.64645 8.35355C3.45118 8.15829 3.45118 7.84171 3.64645 7.64645C3.84171 7.45118 4.15829 7.45118 4.35355 7.64645L6 9.29289L12.6464 2.64645C12.8417 2.45118 13.1583 2.45118 13.3536 2.64645Z'})],-1),(0,a.createElementVNode)('span',null,'有效的JSON格式',-1)])])):(0,a.createCommentVNode)('v-if',!0)])])],2112)):(0,a.createCommentVNode)('v-if',!0)]),(0,a.createElementVNode)('div',de,[(0,a.createElementVNode)('button',{class:'btn primary',disabled:!Ve.value,onClick:Ge},'添加',8,se),(0,a.createElementVNode)('button',{class:'btn',onClick:De},'取消')])])])):(0,a.createCommentVNode)('v-if',!0)]))}});t(5719);const pe=(0,b.A)(ce,[['__scopeId','data-v-d7550ac6']])},5114:(e,n,t)=>{t.d(n,{$:()=>r});var a=t(3035),o=t(9761),A=t(4061);const r=(0,a.defineStore)('KatAsyncAnalyze',()=>{const e=(0,A.ref)(!1),n=(0,A.ref)(!1),t=(0,A.ref)('sample'),a=(0,A.ref)({baseURL:'',apiKey:'',modelName:'',temperature:.7,frequencyPenalty:0,presencePenalty:0,maxTokens:2e4}),r=(0,A.ref)(''),l=async()=>{const n={isAsync:e.value,modelSource:t.value,customModelSettings:a.value,profileSetting:r.value},o=JSON.parse(JSON.stringify(n));await updateVariablesWith(e=>({...e,era_api_config:o}),{type:'script',script_id:getScriptId()})},i=(0,A.ref)([]),d=(0,A.ref)([]),s=(0,A.ref)([]),c=async()=>{const e={analyzeRores:i.value,updateRores:d.value,ignoreRores:s.value},n=JSON.parse(JSON.stringify(e));await updateVariablesWith(e=>({...e,era_world_info_filter_config:n}),{type:'script',script_id:getScriptId()})},p=(0,A.ref)([]),C=async()=>{const e={regexList:p.value},n=JSON.parse(JSON.stringify(e));await updateVariablesWith(e=>({...e,era_regex_config:n}),{type:'script',script_id:getScriptId()})};return{isAsync:e,isUpdateEra:n,modelSource:t,customModelSettings:a,profileSetting:r,getModelSettings:async()=>{const n=getVariables({type:'script',script_id:getScriptId()}).era_api_config;n&&(t.value=n.modelSource,a.value=n.customModelSettings,e.value=n.isAsync,r.value=n.profileSetting),o.j.log('获取异步分析设置: ',n)},saveModelSettings:l,clearModelSettings:async()=>{t.value='sample',a.value={baseURL:'',apiKey:'',modelName:'',temperature:.7,frequencyPenalty:0,presencePenalty:0,maxTokens:2e4},r.value='',await l()},analyzeRores:i,updateRores:d,ignoreRores:s,getWorldInfoFilterConfig:async()=>{const e=getVariables({type:'script',script_id:getScriptId()}).era_world_info_filter_config;e&&(i.value=e.analyzeRores,d.value=e.updateRores,s.value=e.ignoreRores),o.j.log('获取世界书过滤设置: ',e)},saveWorldInfoFilterConfig:c,clearWorldInfoFilterConfig:async()=>{i.value=[],d.value=[],s.value=[],await c()},regexList:p,getRegexConfig:async()=>{const e=getVariables({type:'script',script_id:getScriptId()}).era_regex_config;e&&(p.value=e.regexList),o.j.log('获取正则配置: ',e)},saveRegexConfig:C,clearRegexConfig:async()=>{p.value=[],await C()}}})},5241:(e,n,t)=>{function a(e){return e?e.split('.').map(e=>e.trim()):[]}function o(e,n){let t=e;for(const e of n){if(null==t||'object'!=typeof t)return;t=t[e]}return t}function A(e,n,t){if(!e||'object'!=typeof e||0===n.length)return;let a=e;for(let e=0;e<n.length-1;e++){const t=n[e];t in a&&null!==a[t]&&'object'==typeof a[t]||(a[t]={}),a=a[t]}a[n[n.length-1]]=t}t.d(n,{Em:()=>o,Rr:()=>a,Wp:()=>A})},5378:e=>{e.exports=function(e){var n=[];return n.toString=function(){return this.map(function(n){var t='',a=void 0!==n[5];return n[4]&&(t+='@supports ('.concat(n[4],') {')),n[2]&&(t+='@media '.concat(n[2],' {')),a&&(t+='@layer'.concat(n[5].length>0?' '.concat(n[5]):'',' {')),t+=e(n),a&&(t+='}'),n[2]&&(t+='}'),n[4]&&(t+='}'),t}).join('')},n.i=function(e,t,a,o,A){'string'==typeof e&&(e=[[null,e,void 0]]);var r={};if(a)for(var l=0;l<this.length;l++){var i=this[l][0];null!=i&&(r[i]=!0)}for(var d=0;d<e.length;d++){var s=[].concat(e[d]);a&&r[s[0]]||(void 0!==A&&(void 0===s[5]||(s[1]='@layer'.concat(s[5].length>0?' '.concat(s[5]):'',' {').concat(s[1],'}')),s[5]=A),t&&(s[2]?(s[1]='@media '.concat(s[2],' {').concat(s[1],'}'),s[2]=t):s[2]=t),o&&(s[4]?(s[1]='@supports ('.concat(s[4],') {').concat(s[1],'}'),s[4]=o):s[4]=''.concat(o)),n.push(s))}},n}},5632:e=>{e.exports=toastr},5719:(e,n,t)=>{var a=t(331);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(4424).A)('51770449',a,!1,{ssrId:!0})},5757:(e,n,t)=>{var a=t(3625);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(4424).A)('6c8eec20',a,!1,{ssrId:!0})},6055:(e,n,t)=>{t.r(n),t.d(n,{default:()=>l});var a=t(1314),o=t.n(a),A=t(5378),r=t.n(A)()(o());r.push([e.id,'.search-box[data-v-e21434b2]{position:relative;padding:12px 16px;border-bottom:1px solid #e2e8f0}.search-icon[data-v-e21434b2]{position:absolute;left:28px;top:50%;transform:translateY(-50%);width:16px;height:16px;color:#94a3b8}.search-input[data-v-e21434b2]{width:100%;padding:10px 12px 10px 36px;border:1px solid #e2e8f0;border-radius:8px;font-size:14px;transition:all .2s ease;background:#f8fafc !important;color:#1e293b !important}.search-input[data-v-e21434b2]:focus{outline:none;border-color:#6366f1;box-shadow:0 0 0 3px rgba(99,102,241,.1)}.search-input[data-v-e21434b2]::placeholder{color:#94a3b8 !important}.search-clear[data-v-e21434b2]{position:absolute;right:28px;top:50%;transform:translateY(-50%);background:none;border:none;font-size:20px;color:#94a3b8;cursor:pointer;padding:0;width:20px;height:20px;display:flex;align-items:center;justify-content:center}.search-clear[data-v-e21434b2]:hover{color:#64748b}@media (prefers-color-scheme:dark){.search-input[data-v-e21434b2]{background:#f8fafc !important;color:#1e293b !important;border-color:#e2e8f0 !important}.search-input[data-v-e21434b2]::placeholder{color:#94a3b8 !important}}','',{version:3,sources:['webpack://./src/ERA助手/UI/components/Search/PathSearch.vue'],names:[],mappings:'AACA,6BACE,iBAAA,CACA,iBAAA,CACA,+BAAA,CAGF,8BACE,iBAAA,CACA,SAAA,CACA,OAAA,CACA,0BAAA,CACA,UAAA,CACA,WAAA,CACA,aAAA,CAGF,+BACE,UAAA,CACA,2BAAA,CACA,wBAAA,CACA,iBAAA,CACA,cAAA,CACA,uBAAA,CACA,6BAAA,CACA,wBAAA,CAEA,qCACE,YAAA,CACA,oBAAA,CACA,wCAAA,CAGF,4CACE,wBAAA,CAIJ,+BACE,iBAAA,CACA,UAAA,CACA,OAAA,CACA,0BAAA,CACA,eAAA,CACA,WAAA,CACA,cAAA,CACA,aAAA,CACA,cAAA,CACA,SAAA,CACA,UAAA,CACA,WAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CAEA,qCACE,aAAA,CAKJ,mCACE,+BACE,6BAAA,CACA,wBAAA,CACA,+BAAA,CAGF,4CACE,wBAAA,CAAA',sourcesContent:['\n.search-box {\n  position: relative;\n  padding: 12px 16px;\n  border-bottom: 1px solid #e2e8f0;\n}\n\n.search-icon {\n  position: absolute;\n  left: 28px;\n  top: 50%;\n  transform: translateY(-50%);\n  width: 16px;\n  height: 16px;\n  color: #94a3b8;\n}\n\n.search-input {\n  width: 100%;\n  padding: 10px 12px 10px 36px;\n  border: 1px solid #e2e8f0;\n  border-radius: 8px;\n  font-size: 14px;\n  transition: all 0.2s ease;\n  background: #f8fafc !important;\n  color: #1e293b !important;\n\n  &:focus {\n    outline: none;\n    border-color: #6366f1;\n    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);\n  }\n\n  &::placeholder {\n    color: #94a3b8 !important;\n  }\n}\n\n.search-clear {\n  position: absolute;\n  right: 28px;\n  top: 50%;\n  transform: translateY(-50%);\n  background: none;\n  border: none;\n  font-size: 20px;\n  color: #94a3b8;\n  cursor: pointer;\n  padding: 0;\n  width: 20px;\n  height: 20px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  &:hover {\n    color: #64748b;\n  }\n}\n\n/* 深色模式强制覆盖 */\n@media (prefers-color-scheme: dark) {\n  .search-input {\n    background: #f8fafc !important;\n    color: #1e293b !important;\n    border-color: #e2e8f0 !important;\n  }\n\n  .search-input::placeholder {\n    color: #94a3b8 !important;\n  }\n}\n'],sourceRoot:''}]);const l=r},6200:(e,n,t)=>{var a=t(7460);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(4424).A)('3b318b7a',a,!1,{ssrId:!0})},6215:(e,n,t)=>{var a=t(9731);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(4424).A)('f30b15cc',a,!1,{ssrId:!0})},6328:(e,n,t)=>{t.d(n,{a:()=>o});const a=e=>{const n=getChatMessages(e);return n&&0!==n.length?String(n[0].message):''},o={getMessageById:a,getCurrentMessage:()=>a(getCurrentMessageId()),getMessagesByRange:(e,n)=>{const t=getChatMessages(`${e-n>=0?e-n:0}-${e}`);let a='';return t.forEach(e=>{a+=e.message}),a},mergeContentToMessage:async(e,n)=>{console.log('正在合并消息{message_id}到正文: ',n);let t=getChatMessages(e)[0].message;t=t.replace(/$/,n),await setChatMessages([{message_id:e,message:t}])},removeContentByRegex:async(e,n)=>{console.log('正在清除正文中的内容: ',n);let t=getChatMessages(e)[0].message;for(const e of n)t=t.replace(e,'');await setChatMessages([{message_id:e,message:t}])}}},6385:(e,n,t)=>{var a=t(1461);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(4424).A)('5e4cb241',a,!1,{ssrId:!0})},6584:(e,n,t)=>{t.d(n,{D:()=>r});var a=t(3035),o=t(9761),A=t(4061);const r=(0,a.defineStore)('KatEraData',()=>{const e=(0,A.ref)({}),n=async()=>{const n=e.value,t=JSON.parse(JSON.stringify(n));await updateVariablesWith(e=>({...e,era_data_rule:t}),{type:'script',script_id:getScriptId()})};return{eraDataRule:e,getEraDataRules:async()=>{const n=getVariables({type:'script',script_id:getScriptId()}).era_data_rule;e.value=n||{},o.j.log('获取更新规则设置: ',e.value)},saveEraDataRules:n,clearEraDataRules:async()=>{e.value={},await n()}}})},6678:(e,n,t)=>{t.r(n),t.d(n,{default:()=>l});var a=t(1314),o=t.n(a),A=t(5378),r=t.n(A)()(o());r.push([e.id,'.path-collection-box[data-v-249f4c1a]{border:1px solid #e5e7eb;border-radius:6px;margin:8px 0;background:#fff}.path-collection-header[data-v-249f4c1a]{padding:8px 12px;background:#f9fafb;border-bottom:1px solid #e5e7eb;display:flex;justify-content:space-between;align-items:center;cursor:pointer;font-weight:500;font-size:12px}.path-collection-content[data-v-249f4c1a]{max-height:200px;overflow-y:auto}.path-item[data-v-249f4c1a]{display:flex;justify-content:space-between;align-items:center;padding:6px 12px;border-bottom:1px solid #f1f5f9;font-size:11px}.path-text[data-v-249f4c1a]{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin-right:8px}.remove-path-btn[data-v-249f4c1a]{min-width:auto;padding:2px 6px}.path-collection-actions[data-v-249f4c1a]{padding:8px 12px;display:flex;justify-content:flex-end}.btn[data-v-249f4c1a]{padding:5px 12px;border:none;border-radius:6px;font-size:12px;cursor:pointer;transition:background .2s,color .2s,transform .15s;background:#f3f4f6;color:#111827;box-shadow:0 1px 2px 0 rgba(0,0,0,.05);font-weight:500}.btn[data-v-249f4c1a]:hover{background:#e5e7eb;color:#000}.btn.small[data-v-249f4c1a]{padding:3px 8px;font-size:11px}.btn.danger[data-v-249f4c1a]{background:#dc2626;color:#fff;font-weight:500}.btn.danger[data-v-249f4c1a]:hover{background:#b91c1c;color:#fff}','',{version:3,sources:['webpack://./src/ERA助手/UI/components/Search/PathCollection.vue'],names:[],mappings:'AACA,sCACE,wBAAA,CACA,iBAAA,CACA,YAAA,CACA,eAAA,CAGF,yCACE,gBAAA,CACA,kBAAA,CACA,+BAAA,CACA,YAAA,CACA,6BAAA,CACA,kBAAA,CACA,cAAA,CACA,eAAA,CACA,cAAA,CAGF,0CACE,gBAAA,CACA,eAAA,CAGF,4BACE,YAAA,CACA,6BAAA,CACA,kBAAA,CACA,gBAAA,CACA,+BAAA,CACA,cAAA,CAGF,4BACE,MAAA,CACA,eAAA,CACA,sBAAA,CACA,kBAAA,CACA,gBAAA,CAGF,kCACE,cAAA,CACA,eAAA,CAGF,0CACE,gBAAA,CACA,YAAA,CACA,wBAAA,CAIF,sBACE,gBAAA,CACA,WAAA,CACA,iBAAA,CACA,cAAA,CACA,cAAA,CACA,kDACE,CAGF,kBAAA,CACA,aAAA,CACA,sCAAA,CACA,eAAA,CAGF,4BACE,kBAAA,CACA,UAAA,CAGF,4BACE,eAAA,CACA,cAAA,CAGF,6BACE,kBAAA,CACA,UAAA,CACA,eAAA,CAGF,mCACE,kBAAA,CACA,UAAA',sourcesContent:['\n.path-collection-box {\n  border: 1px solid #e5e7eb;\n  border-radius: 6px;\n  margin: 8px 0;\n  background: #fff;\n}\n\n.path-collection-header {\n  padding: 8px 12px;\n  background: #f9fafb;\n  border-bottom: 1px solid #e5e7eb;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  cursor: pointer;\n  font-weight: 500;\n  font-size: 12px;\n}\n\n.path-collection-content {\n  max-height: 200px;\n  overflow-y: auto;\n}\n\n.path-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 6px 12px;\n  border-bottom: 1px solid #f1f5f9;\n  font-size: 11px;\n}\n\n.path-text {\n  flex: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  margin-right: 8px;\n}\n\n.remove-path-btn {\n  min-width: auto;\n  padding: 2px 6px;\n}\n\n.path-collection-actions {\n  padding: 8px 12px;\n  display: flex;\n  justify-content: flex-end;\n}\n\n/* 按钮样式 */\n.btn {\n  padding: 5px 12px;\n  border: none;\n  border-radius: 6px;\n  font-size: 12px;\n  cursor: pointer;\n  transition:\n    background 0.2s,\n    color 0.2s,\n    transform 0.15s;\n  background: #f3f4f6;\n  color: #111827;\n  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n  font-weight: 500;\n}\n\n.btn:hover {\n  background: #e5e7eb;\n  color: #000000;\n}\n\n.btn.small {\n  padding: 3px 8px;\n  font-size: 11px;\n}\n\n.btn.danger {\n  background: #dc2626;\n  color: #ffffff;\n  font-weight: 500;\n}\n\n.btn.danger:hover {\n  background: #b91c1c;\n  color: #ffffff;\n}\n'],sourceRoot:''}]);const l=r},7021:(e,n,t)=>{t.d(n,{$:()=>c});var a=t(2393),o=t(9761),A=t(8840);const r=10;class l{logs=[];add(e){this.logs.push(e)}getLogs(){return this.logs}toString(){return 0===this.logs.length?'没有执行任何操作':this.logs.map(e=>{const n=e.success?'✅':'❌',t=e.changes?` (${e.changes.from} -> ${e.changes.to})`:'';return`[${e.ruleName}] ${n} [${e.action}] ${e.path}: ${e.message}${t}`}).join('\n')}clear(){this.logs=[]}}const i=e=>{const n=[];for(let t=1;t<=e.size;t++)n.push(e.get(t)||'');return n};function d(e,n){if(e===n||Number.isNaN(e)&&Number.isNaN(n))return{};if('object'!=typeof n||null===n)return'object'==typeof e&&null!==e?(o.j.warn('[diffObjects] 已忽略结构变化: 原始值不是对象，但当前值是对象。'),{}):e;if('object'!=typeof e||null===e)return o.j.warn('[diffObjects] 已忽略结构变化: 原始值是对象，但当前值不是对象。'),{};if(Array.isArray(n))return Array.isArray(e)&&JSON.stringify(e)===JSON.stringify(n)?{}:e;const t={};for(const a in n){if(!Object.prototype.hasOwnProperty.call(e,a)){o.j.warn(`[diffObjects] 已忽略结构变化: 键 '${a}' 在当前对象中已被移除。`);continue}const A=e[a],r=n[a];if('number'==typeof A&&Number.isNaN(A)){o.j.warn(`[diffObjects] 已忽略键 '${a}' 的 NaN 值。`);continue}if(A===r||Number.isNaN(A)&&Number.isNaN(r))continue;const l=e=>null===e?'null':typeof e;if(l(A)===l(r))if('object'!=typeof A||null===A||Array.isArray(A))t[a]=A;else{const e=d(A,r);e&&Object.keys(e).length>0&&(t[a]=e)}else o.j.warn(`[diffObjects] 已忽略键 '${a}' 的类型不匹配。原始值: ${l(r)}, 当前值: ${l(A)}。`)}return t}const s=(e,n)=>n.length?e.replace(/\$\[(.*?)\]/g,(e,t)=>{const a=t.split('.');let o=0;return`$[${a.map(e=>'*'===e&&o<n.length?n[o++]:e).join('.')}]`}):e,c={async applyRule(e,n,t){try{const a=new l,A=((e,n)=>{const t=JSON.parse(JSON.stringify(n)),a=(e,n)=>{for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&Object.prototype.hasOwnProperty.call(e,t)&&typeof e[t]==typeof n[t]&&('object'!=typeof n[t]||null===n[t]||Array.isArray(n[t])?Array.isArray(e[t])===Array.isArray(n[t])&&(e[t]=n[t]):a(e[t],n[t]))};return a(t,e),t})(e,n),r=Object.entries(t).sort(([,e],[,n])=>(e.order??0)-(n.order??0)),i=new Map;o.j.log('[EraDataHandler] 获取到原始数据',e),o.j.log('[EraDataHandler] 获取到快照',n),o.j.log('[EraDataHandler] 处理原始数据为全量',A),o.j.log('[EraDataHandler] 正在处理规则',r);for(const[e,t]of r)if(t.enable)try{await this._processRule(A,n,e,t,a,i)}catch(n){o.j.error(`[EraDataHandler] 运行规则'${e}'时出现错误 :`,n),a.add({ruleName:e,path:t.path,action:'error',success:!1,message:n.message||'未知错误'})}o.j.log('[EraDataHandler] 已完成数据的更新',A),o.j.log('[EraDataHandler] 处理过程日志',a.getLogs());const s=d(A,n);return o.j.log('[EraDataHandler] 合并数据变化',s),{data:s,log:a.toString(),rawLogs:a.getLogs()}}finally{a.w.clearCache()}},async _processRule(e,n,t,o,l,d){const c=new Map,p=Math.max(1,Math.min(o.loop??1,1e4)),C=new A.G(e);let u=[];if('*'===o.path)u=o.if?C.getContexts(o.if):[new Map];else{const e=`$[${o.path}]`;u=C.getContexts(e)}if(0!==u.length)for(const A of u){const C=i(A);let u='';if('*'!==o.path){const e=`$[${o.path}]`,n=s(e,C);u=n.slice(2,-1)}const f=o.if?s(o.if,C):null,m=[];if(o.handle){const e=Object.entries(o.handle).sort(([,e],[,n])=>(e.order??0)-(n.order??0));for(const[n,t]of e)m.push({key:n,cfg:t,concreteIf:t.if?s(t.if,C):null,concreteOp:s(t.op,C)})}for(let A=0;A<p;A++){const i=p<=20||A<r||A>=p-r;p>20&&A===r&&l.add({ruleName:t,path:u||'Global',action:'skip',success:!0,message:`正在跳过循环 11 到 ${p-r} 的日志...`});let s=!0;if(f){const n=a.w.execute(f,e,d,c);n.success?s=Array.isArray(n.value)?n.value.every(e=>!0===e.value):!!n.value:(s=!1,i&&l.add({ruleName:t,path:u||'Global',action:'error',success:!1,message:`规则 'if' 条件执行失败: ${n.error}`}))}if(!s&&('*'===o.path||A>0))break;if(s&&m.length>0)for(const n of m){const o=Math.max(1,Math.min(n.cfg.loop??1,1e4));for(let A=0;A<o;A++){const i=o<=20||A<r||A>=o-r;if(o>20&&A===r&&l.add({ruleName:t,path:u||'Global',action:'skip',success:!0,message:`Loop ${A+1}/${o} [${n.key}] 正在跳过循环 11 到 ${o-r} 的日志...`}),n.concreteIf){const r=a.w.execute(n.concreteIf,e,d,c);if(!r.success){i&&l.add({ruleName:t,path:u||'Global',action:'error',success:!1,message:`Loop ${A+1}/${o} 处理 [${n.key}] 'if' 条件执行失败: ${r.error}`});break}if(!(Array.isArray(r.value)?r.value.every(e=>!0===e.value):!!r.value))break}const s=a.w.execute(n.concreteOp,e,d,c);s.success&&Array.isArray(s.value)?s.value.forEach(r=>{if('data'===r.targetType&&r.path){const d=a.w.getValue(e,r.path);a.w.setValue(e,r.path,r.value),i&&l.add({ruleName:t,path:r.path,action:'handle',success:!0,message:`Loop ${A+1}/${o} [${n.key}] (Ctx: ${C.join('.')})`,changes:{from:d,to:r.value}})}else i&&('temp'===r.targetType&&r.path?l.add({ruleName:t,path:r.path,action:'handle',success:!0,message:`Loop ${A+1}/${o} [${n.key}] 赋值给临时变量, 值为: ${JSON.stringify(r.value)}`}):l.add({ruleName:t,path:u||'Global',action:'handle',success:!0,message:`Loop ${A+1}/${o} [${n.key}] 计算值: ${JSON.stringify(r.value)} (无赋值操作)`}))}):s.success||i&&l.add({ruleName:t,path:u||'Global',action:'handle',success:!1,message:`Loop ${A+1}/${o} [${n.key}] 错误: ${s.error}`})}}if(u&&(s||0===A)&&this._applyLimitAndRange(e,n,o,u,l,t,i),!s)break}}},_applyLimitAndRange(e,n,t,o,A,r,l){const i=a.w.getValue(e,o),d=a.w.getValue(n,o);if(t.limit&&2===t.limit.length&&'number'==typeof t.limit[0]&&'number'==typeof t.limit[1]&&'number'==typeof i&&'number'==typeof d){const[n,s]=t.limit,c=i-d;let p=c;if(c>s&&(p=s),c<n&&(p=n),p!==c){const t=d+p;a.w.setValue(e,o,t),l&&A.add({ruleName:r,path:o,action:'limit',success:!0,message:`增量 ${c} 已限制在 [${n}, ${s}] 范围内`,changes:{from:i,to:t}})}}if(t.range&&2===t.range.length&&'number'==typeof t.range[0]&&'number'==typeof t.range[1]){const n=a.w.getValue(e,o);if('number'==typeof n){const[i,d]=t.range,s=Math.max(i,Math.min(n,d));s!==n&&(a.w.setValue(e,o,s),l&&A.add({ruleName:r,path:o,action:'range',success:!0,message:`值已限制在 [${i}, ${d}] 范围内`,changes:{from:n,to:s}}))}}}}},7157:(e,n,t)=>{t.r(n),t.d(n,{default:()=>l});var a=t(1314),o=t.n(a),A=t(5378),r=t.n(A)()(o());r.push([e.id,'.json-node[data-v-157772de]{font-family:"SF Mono",Monaco,"Cascadia Code","JetBrains Mono",monospace;font-size:11px;line-height:1.5;position:relative}.json-node[data-v-157772de]::before{content:"";position:absolute;left:12px;top:0;bottom:0;width:1px;background:linear-gradient(to bottom,transparent 0%,#e5e7eb 10%,#e5e7eb 90%,transparent 100%);z-index:0}.json-node .line[data-v-157772de]{display:flex;align-items:center;min-height:28px;padding:4px 0;position:relative;z-index:1;transition:background-color .15s ease}.json-node .line[data-v-157772de]:hover{background-color:rgba(99,102,241,.05);border-radius:4px}.json-node .line:hover .arrow[data-v-157772de]{opacity:1}.json-node .line.line-leaf .key[data-v-157772de]{color:#111827}.json-node .line.line-parent .key[data-v-157772de]{font-weight:600;color:#111827}.json-node .arrow[data-v-157772de]{display:flex;align-items:center;justify-content:center;width:16px;height:16px;margin-right:4px;cursor:pointer;opacity:.6;transition:all .2s ease;border-radius:3px;flex-shrink:0}.json-node .arrow[data-v-157772de]:hover{opacity:1;background-color:rgba(99,102,241,.1);transform:scale(1.1)}.json-node .arrow .arrow-icon[data-v-157772de]{width:15px;height:15px;color:#6b7280;transition:transform .2s ease}.json-node .arrow.expanded .arrow-icon[data-v-157772de]{color:#6366f1}.json-node .space[data-v-157772de]{width:16px;height:16px;flex-shrink:0}.json-node .key[data-v-157772de]{color:#4b5563;margin-right:8px;font-weight:500;-webkit-user-select:none;user-select:none;flex-shrink:0}.json-node .value-area[data-v-157772de]{display:flex;align-items:center;gap:8px;flex:1;min-width:0}.json-node .val[data-v-157772de]{color:#111827;font-weight:400;padding:2px 6px;background-color:#f9fafb;border-radius:4px;border:1px solid #f3f4f6;line-height:1.3;flex:1;min-width:0;overflow:hidden;text-overflow:ellipsis;max-width:400px;white-space:normal;word-break:break-all;word-wrap:break-word}.json-node .val.type-string[data-v-157772de]{color:#059669;background-color:#f0fdf4;border-color:#bbf7d0}.json-node .val.type-number[data-v-157772de]{color:#dc2626;background-color:#fef2f2;border-color:#fecaca}.json-node .val.type-boolean[data-v-157772de]{color:#7c3aed;background-color:#f5f3ff;border-color:#ddd6fe}.json-node .val.type-null[data-v-157772de]{color:#6b7280;background-color:#f9fafb;border-color:#e5e7eb;font-style:italic}.json-node .val.type-object[data-v-157772de]{color:#0ea5e9;background-color:#f0f9ff;border-color:#bae6fd}.json-node .val.type-array[data-v-157772de]{color:#f59e0b;background-color:#fffbeb;border-color:#fde68a}.json-node .val[data-v-157772de]:empty{display:none}.json-node .add-btn[data-v-157772de]{display:flex;align-items:center;justify-content:center;width:15px;height:15px;padding:0;border:none;border-radius:6px;color:#fffbfb;cursor:pointer;opacity:0;transition:all .2s ease;flex-shrink:0;background-color:#b6ffbb;box-shadow:0 1px 2px rgba(99,102,241,.2)}.json-node .add-btn[data-v-157772de]:not(:hover){opacity:.8}.json-node .add-btn[data-v-157772de]:hover{background:#75b8f1;border-color:#75b8f1}.json-node .add-btn[data-v-157772de]:active{transform:translateY(0)}.json-node .add-btn .add-icon[data-v-157772de]{width:14px;height:14px;stroke-width:2}.json-node .collapse-preview[data-v-157772de]{color:#6b7280;font-size:11px;font-style:italic;padding:2px 6px;background-color:#f9fafb;border-radius:4px;border:1px dashed #e5e7eb;line-height:1.3;flex:1;min-width:0;overflow:hidden;text-overflow:ellipsis;max-width:400px;white-space:normal;word-break:break-all;word-wrap:break-word}.json-node .collapse-preview .ellipsis[data-v-157772de]{display:inline-block;max-width:100%;overflow:hidden;text-overflow:ellipsis}.json-node[data-v-157772de]:last-child::before{bottom:50%}.json-node[data-v-157772de]:first-child::before{top:50%}@media (prefers-color-scheme:dark){.json-node[data-v-157772de]::before{background:linear-gradient(to bottom,transparent 0%,#374151 10%,#374151 90%,transparent 100%)}.json-node .line[data-v-157772de]:hover{background-color:rgba(99,102,241,.1)}.json-node .key[data-v-157772de]{color:#9ca3af}.json-node .val[data-v-157772de]{color:#f3f4f6;background-color:#1f2937;border-color:#374151}.json-node .val.type-string[data-v-157772de]{color:#34d399;background-color:#064e3b;border-color:#047857}.json-node .val.type-number[data-v-157772de]{color:#f87171;background-color:#7f1d1d;border-color:#991b1b}.json-node .val.type-boolean[data-v-157772de]{color:#a78bfa;background-color:#4c1d95;border-color:#5b21b6}.json-node .val.type-null[data-v-157772de]{color:#9ca3af;background-color:#374151;border-color:#4b5563}.json-node .val.type-object[data-v-157772de]{color:#38bdf8;background-color:#0c4a6e;border-color:#0369a1}.json-node .val.type-array[data-v-157772de]{color:#fbbf24;background-color:#78350f;border-color:#d97706}.json-node .collapse-preview[data-v-157772de]{color:#9ca3af;background-color:#1f2937;border-color:#374151}.json-node .arrow .arrow-icon[data-v-157772de]{color:#9ca3af}.json-node .arrow[data-v-157772de]:hover{background-color:rgba(99,102,241,.2)}}','',{version:3,sources:['webpack://./src/ERA助手/UI/components/JsonNode/JsonNode.vue'],names:[],mappings:'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',sourcesContent:['\n.json-node {\n  font-family: \'SF Mono\', Monaco, \'Cascadia Code\', \'JetBrains Mono\', monospace;\n  font-size: 11px;\n  line-height: 1.5;\n  position: relative;\n\n  // 添加连接线\n  &::before {\n    content: \'\';\n    position: absolute;\n    left: 12px;\n    top: 0;\n    bottom: 0;\n    width: 1px;\n    background: linear-gradient(to bottom, transparent 0%, #e5e7eb 10%, #e5e7eb 90%, transparent 100%);\n    z-index: 0;\n  }\n\n  .line {\n    display: flex;\n    align-items: center;\n    min-height: 28px;\n    padding: 4px 0;\n    position: relative;\n    z-index: 1;\n    transition: background-color 0.15s ease;\n\n    &:hover {\n      background-color: rgba(99, 102, 241, 0.05);\n      border-radius: 4px;\n\n      .arrow {\n        opacity: 1;\n      }\n    }\n\n    &.line-leaf {\n      .key {\n        color: #111827;\n      }\n    }\n\n    &.line-parent {\n      .key {\n        font-weight: 600;\n        color: #111827;\n      }\n    }\n  }\n\n  .arrow {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 16px;\n    height: 16px;\n    margin-right: 4px;\n    cursor: pointer;\n    opacity: 0.6;\n    transition: all 0.2s ease;\n    border-radius: 3px;\n    flex-shrink: 0;\n\n    &:hover {\n      opacity: 1;\n      background-color: rgba(99, 102, 241, 0.1);\n      transform: scale(1.1);\n    }\n\n    .arrow-icon {\n      width: 15px;\n      height: 15px;\n      color: #6b7280;\n      transition: transform 0.2s ease;\n    }\n\n    &.expanded {\n      .arrow-icon {\n        color: #6366f1;\n      }\n    }\n  }\n\n  .space {\n    width: 16px;\n    height: 16px;\n    flex-shrink: 0;\n  }\n\n  .key {\n    color: #4b5563;\n    margin-right: 8px;\n    font-weight: 500;\n    user-select: none;\n    flex-shrink: 0;\n  }\n\n  .value-area {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    flex: 1;\n    min-width: 0;\n  }\n\n  .val {\n    color: #111827;\n    font-weight: 400;\n    padding: 2px 6px;\n    background-color: #f9fafb;\n    border-radius: 4px;\n    border: 1px solid #f3f4f6;\n    line-height: 1.3;\n    flex: 1;\n    min-width: 0;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    max-width: 400px;\n    white-space: normal;\n    word-break: break-all;\n    word-wrap: break-word;\n\n    // 不同类型值的颜色\n    &.type-string {\n      color: #059669;\n      background-color: #f0fdf4;\n      border-color: #bbf7d0;\n    }\n\n    &.type-number {\n      color: #dc2626;\n      background-color: #fef2f2;\n      border-color: #fecaca;\n    }\n\n    &.type-boolean {\n      color: #7c3aed;\n      background-color: #f5f3ff;\n      border-color: #ddd6fe;\n    }\n\n    &.type-null {\n      color: #6b7280;\n      background-color: #f9fafb;\n      border-color: #e5e7eb;\n      font-style: italic;\n    }\n\n    &.type-object {\n      color: #0ea5e9;\n      background-color: #f0f9ff;\n      border-color: #bae6fd;\n    }\n\n    &.type-array {\n      color: #f59e0b;\n      background-color: #fffbeb;\n      border-color: #fde68a;\n    }\n\n    &:empty {\n      display: none;\n    }\n  }\n\n  .add-btn {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 15px;\n    height: 15px;\n    padding: 0;\n    border: none;\n    border-radius: 6px;\n    color: #fffbfb;\n    cursor: pointer;\n    opacity: 0;\n    transition: all 0.2s ease;\n    flex-shrink: 0;\n    background-color: #b6ffbb;\n    box-shadow: 0 1px 2px rgba(99, 102, 241, 0.2);\n\n    // 修正选择器：从 .line:hover & 改为直接父元素选择器\n    &:not(:hover) {\n      opacity: 0.8;\n    }\n\n    &:hover {\n      background: #75b8f1;\n      border-color: #75b8f1;\n    }\n\n    &:active {\n      transform: translateY(0);\n    }\n\n    .add-icon {\n      width: 14px;\n      height: 14px;\n      stroke-width: 2;\n    }\n  }\n\n  .collapse-preview {\n    color: #6b7280;\n    font-size: 11px;\n    font-style: italic;\n    padding: 2px 6px;\n    background-color: #f9fafb;\n    border-radius: 4px;\n    border: 1px dashed #e5e7eb;\n    line-height: 1.3;\n    flex: 1;\n    min-width: 0;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    max-width: 400px;\n    white-space: normal;\n    word-break: break-all;\n    word-wrap: break-word;\n\n    .ellipsis {\n      display: inline-block;\n      max-width: 100%;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n  }\n\n  // 最后一个节点的连接线调整\n  &:last-child::before {\n    bottom: 50%;\n  }\n\n  // 第一个节点的连接线调整\n  &:first-child::before {\n    top: 50%;\n  }\n}\n\n// 深色模式支持\n@media (prefers-color-scheme: dark) {\n  .json-node {\n    &::before {\n      background: linear-gradient(to bottom, transparent 0%, #374151 10%, #374151 90%, transparent 100%);\n    }\n\n    .line {\n      &:hover {\n        background-color: rgba(99, 102, 241, 0.1);\n      }\n    }\n\n    .key {\n      color: #9ca3af;\n    }\n\n    .val {\n      color: #f3f4f6;\n      background-color: #1f2937;\n      border-color: #374151;\n\n      &.type-string {\n        color: #34d399;\n        background-color: #064e3b;\n        border-color: #047857;\n      }\n\n      &.type-number {\n        color: #f87171;\n        background-color: #7f1d1d;\n        border-color: #991b1b;\n      }\n\n      &.type-boolean {\n        color: #a78bfa;\n        background-color: #4c1d95;\n        border-color: #5b21b6;\n      }\n\n      &.type-null {\n        color: #9ca3af;\n        background-color: #374151;\n        border-color: #4b5563;\n      }\n\n      &.type-object {\n        color: #38bdf8;\n        background-color: #0c4a6e;\n        border-color: #0369a1;\n      }\n\n      &.type-array {\n        color: #fbbf24;\n        background-color: #78350f;\n        border-color: #d97706;\n      }\n    }\n\n    .collapse-preview {\n      color: #9ca3af;\n      background-color: #1f2937;\n      border-color: #374151;\n    }\n\n    .arrow {\n      .arrow-icon {\n        color: #9ca3af;\n      }\n\n      &:hover {\n        background-color: rgba(99, 102, 241, 0.2);\n      }\n    }\n  }\n}\n'],sourceRoot:''}]);const l=r},7200:(e,n,t)=>{t.d(n,{default:()=>st}),t.r(n);var a=t(4061),o=t(6584),A=t(688);const r={class:'json-node'},l={key:0,class:'arrow-icon',viewBox:'0 0 16 16',fill:'currentColor'},i={key:1,class:'arrow-icon',viewBox:'0 0 16 16',fill:'currentColor'},d={key:1,class:'space'},s={class:'key'},c={key:2,class:'value-area'},p={key:3,class:'collapse-preview'},C={class:'ellipsis'},u=(0,a.defineComponent)({__name:'JsonNode',props:{node:{}},emits:['toggle','sendPath'],setup(e){function n(e){switch(typeof e){case'string':return`"${e}"`;case'number':case'boolean':return`${e}`;case'object':return null===e?'null':Array.isArray(e)?`[${e.length} items]`:`{${Object.keys(e).length} keys}`;default:return String(e)}}function t(e){switch(typeof e){case'string':return'type-string';case'number':return'type-number';case'boolean':return'type-boolean';case'object':return null===e?'type-null':Array.isArray(e)?'type-array':'type-object';default:return'type-other'}}function o(e){if(e.children){const n=e.children.length;return`{ ${e.children.slice(0,2).map(e=>e.key).join(', ')}${n>2?', ... +'+(n-2):''} }`}return'{ ... }'}return(A,u)=>{const f=(0,a.resolveComponent)('JsonNode',!0);return(0,a.openBlock)(),(0,a.createElementBlock)('div',r,[(0,a.createElementVNode)('div',{class:(0,a.normalizeClass)(['line',{'line-leaf':e.node.isLeaf,'line-parent':!e.node.isLeaf}]),style:(0,a.normalizeStyle)({paddingLeft:20*e.node.depth+'px'})},[(0,a.createCommentVNode)(' 折叠箭头 / 占位 '),e.node.isLeaf?((0,a.openBlock)(),(0,a.createElementBlock)('span',d)):((0,a.openBlock)(),(0,a.createElementBlock)('span',{key:0,class:(0,a.normalizeClass)(['arrow',{expanded:e.node.expanded}]),onClick:u[0]||(u[0]=n=>A.$emit('toggle',e.node))},[e.node.expanded?((0,a.openBlock)(),(0,a.createElementBlock)('svg',l,[...u[4]||(u[4]=[(0,a.createElementVNode)('path',{d:'M12 10L8 6L4 10H12Z'},null,-1)])])):((0,a.openBlock)(),(0,a.createElementBlock)('svg',i,[...u[5]||(u[5]=[(0,a.createElementVNode)('path',{d:'M6 4L10 8L6 12V4Z'},null,-1)])]))],2)),(0,a.createCommentVNode)(' 键值 '),(0,a.createElementVNode)('span',s,(0,a.toDisplayString)(e.node.key)+':',1),(0,a.createCommentVNode)(' 值显示区域 '),e.node.isLeaf?((0,a.openBlock)(),(0,a.createElementBlock)('div',c,[(0,a.createElementVNode)('span',{class:(0,a.normalizeClass)(['val',t(e.node.value)])},(0,a.toDisplayString)(n(e.node.value)),3),(0,a.createCommentVNode)(' 只有叶子节点出现添加规则按钮 '),(0,a.createElementVNode)('button',{class:'add-btn',title:'将此路径添加到规则',onClick:u[1]||(u[1]=n=>A.$emit('sendPath',e.node.path))},'+')])):e.node.expanded?(0,a.createCommentVNode)('v-if',!0):((0,a.openBlock)(),(0,a.createElementBlock)('div',p,[(0,a.createElementVNode)('span',C,(0,a.toDisplayString)(o(e.node)),1)]))],6),(0,a.createCommentVNode)(' 子节点 '),e.node.children&&e.node.expanded?((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,{key:0},(0,a.renderList)(e.node.children,e=>((0,a.openBlock)(),(0,a.createBlock)(f,{key:e.path,node:e,onToggle:u[2]||(u[2]=e=>A.$emit('toggle',e)),onSendPath:u[3]||(u[3]=e=>A.$emit('sendPath',e))},null,8,['node']))),128)):(0,a.createCommentVNode)('v-if',!0)])}}});t(3385);var f=t(1400);const m=(0,f.A)(u,[['__scopeId','data-v-157772de']]),b={class:'json-tree'},g=(0,a.defineComponent)({__name:'JsonTree',props:{data:{}},emits:['toggle','sendPath'],setup(e,{emit:n}){const t=e,o=n;function A(e,n=0,t='',a=!1){return null===e||'object'!=typeof e?[]:Object.keys(e).map(o=>{const r=t?`${t}.${o}`:o,l=e[o],i=null===l||'object'!=typeof l,d={key:o,value:l,depth:n,path:r,isLeaf:i,expanded:a};return i||(d.children=A(l,n+1,r,a)),d})}const r=(0,a.ref)([]);function l(e){e.expanded=!e.expanded,o('toggle',e)}return(0,a.watch)(()=>t.data,e=>r.value=A(e),{immediate:!0}),(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',b,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(r.value,(t,o)=>((0,a.openBlock)(),(0,a.createBlock)(m,{key:o,node:t,onToggle:l,onSendPath:n[0]||(n[0]=n=>e.$emit('sendPath',n))},null,8,['node']))),128))]))}});t(8137);const v=(0,f.A)(g,[['__scopeId','data-v-4dc2c334']]);var x=t(9761);function h(e,n=!0){try{const t={};for(const[n,a]of Object.entries(e))t[n]={enable:a.enable||!0,path:a.path||'*',order:a.order||0,loop:a.loop||1,range:a.range||[],limit:a.limit||[],if:a.if||'',handle:a.handle||{}};const a={rules:t};return n?JSON.stringify(a,null,2):JSON.stringify(a)}catch(e){throw x.j.error('导出规则失败:',e),new Error('导出规则失败')}}var k=t(1960),E=t(2393),y=t(5632),w=t.n(y);const B={class:'dsl-builder-content'},N={class:'dsl-header'},V={class:'dsl-builder-body'},F={class:'dsl-components'},S={class:'component-section'},j={class:'path-selection-row'},D={key:0,class:'path-dropdown-container'},G=['value'],I={key:0,class:'selected-path'},O={key:0,class:'component-section'},M={class:'operator-grid'},U={class:'component-section'},T={class:'operator-grid'},R={class:'operator-grid three-columns'},Y={class:'component-section'},L={class:'operator-grid'},J={class:'component-section'},W={class:'value-input'},P={class:'component-section'},q={class:'value-input'},K={class:'dsl-preview-area'},H={class:'expression-preview readable'},Q={class:'expression-display readable-text'},X={class:'expression-preview'},Z={class:'expression-raw'},ee={class:'expression-editor'},ne=(0,a.defineComponent)({__name:'DSLBuilderModal',props:{visible:{type:Boolean},type:{},expression:{},selectedPath:{default:''}},emits:['update:visible','update:expression','close','apply'],setup(e,{emit:n}){const t=e,o=(0,a.ref)(t.expression),r=(0,a.ref)(''),l=(0,a.ref)('num'),i=(0,a.ref)(''),d=(0,a.ref)(null),s=(0,a.ref)(null),c=(0,a.ref)(!1),p=(0,a.ref)(''),C=(0,a.ref)('s'),u=n,f=(0,A.n)();(0,a.watch)(()=>t.expression,e=>{o.value=e}),(0,a.watch)(o,e=>{u('update:expression',e)});const m=(0,a.computed)(()=>'if'===t.type?'条件表达式构建器':'操作表达式构建器'),b=(0,a.computed)(()=>{if(o.value.trim()){const e='if'===t.type?'<<if>':'<<op>',n=o.value.trim();return n.startsWith('<<if>')||n.startsWith('<<op>')?n:`${e} ${n} >`}return o.value}),g=(0,a.computed)(()=>E.w.exprToHumanView(b.value));function v(){u('update:visible',!1),u('close'),r.value='',i.value=''}function h(){o.value.trim()&&(u('apply',b.value),v())}function k(e){c.value=!0;const n=o.value;let t=n.length,A=n.length;s.value&&(t=s.value.start,A=s.value.end);const r=n.substring(0,t),l=n.substring(A),i=r&&!r.endsWith(' ')?' ':'',p=l&&!l.startsWith(' ')?' ':'';o.value=r+i+e+p+l;const C=t+i.length+e.length+p.length;s.value={start:C,end:C},(0,a.nextTick)(()=>{const e=d.value;if(e)try{e.focus(),e.setSelectionRange(C,C)}catch(e){x.j.warn('Cursor restore failed',e)}setTimeout(()=>{c.value=!1},0)})}function y(){i.value&&(k(`$[${i.value}]`),i.value='')}function ne(){k('()')}function te(){if(!r.value.trim())return;let e='';switch(l.value){case'num':e=`&[{num}${r.value}]`;break;case'str':e=`&[{str}${r.value}]`;break;case'bool':e=`&[{bool}${r.value}]`}k(e),r.value=''}function ae(){const e=p.value.trim();if(!e)return;if(!/^\w+$/.test(e))return void w().error('变量名只能包含字母、数字和下划线');k(`@[{${C.value}}${e}]`),p.value=''}function oe(){o.value='',u('update:expression','')}function Ae(){if(o.value.trim())try{const e=E.w.validate(o.value);e.success?w().success(('if'===t.type?'条件':'操作')+'表达式语法验证通过'):w().error(`${'if'===t.type?'条件':'操作'}表达式语法验证失败: ${e.error}`)}catch(e){w().error(`表达式验证出错: ${e.message}`)}else w().error('表达式为空')}const re=()=>{if(c.value)return;const e=d.value;if(e){const n=e.selectionStart,t=e.selectionEnd;s.value={start:n,end:t}}};return(0,a.watch)(()=>t.visible,e=>{e||(r.value='',i.value='',s.value=null,p.value='')}),(n,t)=>e.visible?((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:0,class:'dsl-builder-modal',onClick:(0,a.withModifiers)(v,['self'])},[(0,a.createElementVNode)('div',B,[(0,a.createElementVNode)('div',N,[(0,a.createElementVNode)('h3',null,(0,a.toDisplayString)(m.value),1),(0,a.createElementVNode)('button',{class:'btn small',onClick:v},'×')]),(0,a.createElementVNode)('div',V,[(0,a.createCommentVNode)(' 左侧：构建组件 '),(0,a.createElementVNode)('div',F,[(0,a.createElementVNode)('div',S,[t[33]||(t[33]=(0,a.createElementVNode)('h4',null,'路径选择',-1)),(0,a.createElementVNode)('div',j,[(0,a.createElementVNode)('button',{class:'btn small',onClick:t[0]||(t[0]=n=>k(`$[${e.selectedPath}]`))},'当前路径'),(0,a.unref)(f).collectedPaths.length>0?((0,a.openBlock)(),(0,a.createElementBlock)('div',D,[(0,a.withDirectives)((0,a.createElementVNode)('select',{'onUpdate:modelValue':t[1]||(t[1]=e=>i.value=e),class:'path-dropdown light-theme',onChange:y},[t[32]||(t[32]=(0,a.createElementVNode)('option',{value:''},'选择已收集路径',-1)),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)((0,a.unref)(f).collectedPaths,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)('option',{key:n,value:e},(0,a.toDisplayString)(e),9,G))),128))],544),[[a.vModelSelect,i.value]])])):(0,a.createCommentVNode)('v-if',!0)]),e.selectedPath?((0,a.openBlock)(),(0,a.createElementBlock)('div',I,'已选择: '+(0,a.toDisplayString)(e.selectedPath),1)):(0,a.createCommentVNode)('v-if',!0)]),'if'===e.type?((0,a.openBlock)(),(0,a.createElementBlock)('div',O,[t[34]||(t[34]=(0,a.createElementVNode)('h4',null,'比较运算符',-1)),(0,a.createElementVNode)('div',M,[(0,a.createElementVNode)('button',{class:'btn small',onClick:t[2]||(t[2]=e=>k('?[==]'))},'等于 (==)'),(0,a.createElementVNode)('button',{class:'btn small',onClick:t[3]||(t[3]=e=>k('?[>]'))},'大于 (>)'),(0,a.createElementVNode)('button',{class:'btn small',onClick:t[4]||(t[4]=e=>k('?[<]'))},'小于 (<)'),(0,a.createElementVNode)('button',{class:'btn small',onClick:t[5]||(t[5]=e=>k('?[>=]'))},'大于等于 (>=)'),(0,a.createElementVNode)('button',{class:'btn small',onClick:t[6]||(t[6]=e=>k('?[<=]'))},'小于等于 (≥)')])])):(0,a.createCommentVNode)('v-if',!0),(0,a.createElementVNode)('div',U,[t[35]||(t[35]=(0,a.createElementVNode)('h4',null,'算术运算符',-1)),(0,a.createElementVNode)('div',T,[(0,a.createElementVNode)('button',{class:'btn small',onClick:t[7]||(t[7]=e=>k('#[+]'))},'加 (+)'),(0,a.createElementVNode)('button',{class:'btn small',onClick:t[8]||(t[8]=e=>k('#[-]'))},'减 (-)'),(0,a.createElementVNode)('button',{class:'btn small',onClick:t[9]||(t[9]=e=>k('#[*]'))},'乘 (*)'),(0,a.createElementVNode)('button',{class:'btn small',onClick:t[10]||(t[10]=e=>k('#[/]'))},'除 (/)'),(0,a.createElementVNode)('button',{class:'btn small',onClick:t[11]||(t[11]=e=>k('#[%]'))},'取余 (%)'),(0,a.createElementVNode)('button',{class:'btn small',onClick:t[12]||(t[12]=e=>k('#[**]'))},'幂 (**)'),(0,a.createElementVNode)('button',{class:'btn small',onClick:t[13]||(t[13]=e=>k('#[=]'))},'赋值 (=)')]),t[36]||(t[36]=(0,a.createElementVNode)('h4',null,'函数运算符',-1)),(0,a.createCommentVNode)(' 修改：使用 three-columns 类 '),(0,a.createElementVNode)('div',R,[(0,a.createElementVNode)('button',{class:'btn small',onClick:t[14]||(t[14]=e=>k('#[{ln}]'))},'自然对数 (ln)'),(0,a.createElementVNode)('button',{class:'btn small',onClick:t[15]||(t[15]=e=>k('#[{log2}]'))},'对数 (log2)'),(0,a.createElementVNode)('button',{class:'btn small',onClick:t[16]||(t[16]=e=>k('#[{sqrt}]'))},'平方根 (sqrt)'),(0,a.createElementVNode)('button',{class:'btn small',onClick:t[17]||(t[17]=e=>k('#[{abs}]'))},'绝对值 (abs)'),(0,a.createElementVNode)('button',{class:'btn small',onClick:t[18]||(t[18]=e=>k('#[{floor}]'))},'向下取整 (floor)'),(0,a.createElementVNode)('button',{class:'btn small',onClick:t[19]||(t[19]=e=>k('#[{ceil}]'))},'向上取整 (ceil)'),(0,a.createElementVNode)('button',{class:'btn small',onClick:t[20]||(t[20]=e=>k('#[{max}]'))},'最大值 (max)'),(0,a.createElementVNode)('button',{class:'btn small',onClick:t[21]||(t[21]=e=>k('#[{min}]'))},'最小值 (min)'),(0,a.createElementVNode)('button',{class:'btn small',onClick:t[22]||(t[22]=e=>k('#[{neg}]'))},'取反 (neg)'),(0,a.createElementVNode)('button',{class:'btn small',onClick:t[23]||(t[23]=e=>k('#[{avg}]'))},'平均值 (avg)'),(0,a.createElementVNode)('button',{class:'btn small',onClick:t[24]||(t[24]=e=>k('#[{sum}]'))},'求和 (sum)')])]),(0,a.createElementVNode)('div',Y,[t[37]||(t[37]=(0,a.createElementVNode)('h4',null,'逻辑运算符',-1)),(0,a.createElementVNode)('div',L,[(0,a.createElementVNode)('button',{class:'btn small',onClick:t[25]||(t[25]=e=>k('?[&&]'))},'与 (&&)'),(0,a.createElementVNode)('button',{class:'btn small',onClick:t[26]||(t[26]=e=>k('?[||]'))},'或 (||)'),(0,a.createElementVNode)('button',{class:'btn small',onClick:ne},'添加括号 ()')])]),(0,a.createElementVNode)('div',J,[t[39]||(t[39]=(0,a.createElementVNode)('h4',null,'值',-1)),(0,a.createElementVNode)('div',W,[(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':t[27]||(t[27]=e=>r.value=e),placeholder:'输入值',class:'light-theme',onKeyup:(0,a.withKeys)(te,['enter'])},null,544),[[a.vModelText,r.value]]),(0,a.withDirectives)((0,a.createElementVNode)('select',{'onUpdate:modelValue':t[28]||(t[28]=e=>l.value=e),class:'light-theme'},[...t[38]||(t[38]=[(0,a.createElementVNode)('option',{value:'num'},'数字',-1),(0,a.createElementVNode)('option',{value:'str'},'字符串',-1),(0,a.createElementVNode)('option',{value:'bool'},'布尔值',-1)])],512),[[a.vModelSelect,l.value]]),(0,a.createElementVNode)('button',{class:'btn small primary',onClick:te},'添加值')])]),(0,a.createCommentVNode)(' 新增：临时变量 '),(0,a.createElementVNode)('div',P,[t[41]||(t[41]=(0,a.createElementVNode)('h4',null,'临时变量',-1)),(0,a.createElementVNode)('div',q,[(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':t[29]||(t[29]=e=>p.value=e),placeholder:'变量名',class:'light-theme',onKeyup:(0,a.withKeys)(ae,['enter'])},null,544),[[a.vModelText,p.value]]),(0,a.withDirectives)((0,a.createElementVNode)('select',{'onUpdate:modelValue':t[30]||(t[30]=e=>C.value=e),class:'light-theme'},[...t[40]||(t[40]=[(0,a.createElementVNode)('option',{value:'s'},'局部 (s)',-1),(0,a.createElementVNode)('option',{value:'g'},'全局 (g)',-1)])],512),[[a.vModelSelect,C.value]]),(0,a.createElementVNode)('button',{class:'btn small primary',onClick:ae},'添加变量')])])]),(0,a.createCommentVNode)(' 右侧：表达式预览和编辑 '),(0,a.createElementVNode)('div',K,[(0,a.createCommentVNode)(' 新增：可读预览 '),(0,a.createElementVNode)('div',H,[t[42]||(t[42]=(0,a.createElementVNode)('div',{class:'preview-header'},[(0,a.createElementVNode)('strong',null,'可读预览:'),(0,a.createElementVNode)('span',{class:'hint'},'（仅供参考，实际逻辑以原始表达式为准）')],-1)),(0,a.createElementVNode)('div',Q,(0,a.toDisplayString)(g.value||'暂无内容'),1)]),(0,a.createElementVNode)('div',X,[t[43]||(t[43]=(0,a.createElementVNode)('div',{class:'preview-header'},[(0,a.createElementVNode)('strong',null,'原始表达式:')],-1)),(0,a.createElementVNode)('div',Z,[(0,a.createElementVNode)('pre',null,(0,a.toDisplayString)(b.value),1)])]),(0,a.createElementVNode)('div',ee,[t[44]||(t[44]=(0,a.createElementVNode)('h4',null,'手动编辑',-1)),(0,a.withDirectives)((0,a.createElementVNode)('textarea',{ref_key:'expressionTextarea',ref:d,'onUpdate:modelValue':t[31]||(t[31]=e=>o.value=e),rows:'4',placeholder:'可以在此处手动编辑表达式...',class:'light-theme',onKeyup:re,onInput:re,onClick:re},null,544),[[a.vModelText,o.value]]),(0,a.createElementVNode)('div',{class:'editor-actions'},[(0,a.createElementVNode)('button',{class:'btn small danger',onClick:oe},'清空'),(0,a.createElementVNode)('button',{class:'btn small',onClick:Ae},'验证')])]),(0,a.createElementVNode)('div',{class:'dsl-actions'},[(0,a.createElementVNode)('button',{class:'btn primary',onClick:h},'应用表达式'),(0,a.createElementVNode)('button',{class:'btn',onClick:v},'取消')])])])])])):(0,a.createCommentVNode)('v-if',!0)}});t(2680);const te=(0,f.A)(ne,[['__scopeId','data-v-799db43a']]);var ae=t(3300);const oe={class:'path-collection-box'},Ae={class:'toggle-icon'},re={class:'path-collection-content'},le=['title'],ie=['onClick'],de=(0,a.defineComponent)({__name:'PathCollection',props:{isExpanded:{type:Boolean,default:!1}},emits:['update:isExpanded'],setup(e,{emit:n}){const t=e,o=n,r=(0,A.n)(),l=()=>{o('update:isExpanded',!t.isExpanded)},i=()=>{r.collectedPaths=[]};return(n,t)=>(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)('div',oe,[(0,a.createElementVNode)('div',{class:'path-collection-header',onClick:l},[(0,a.createElementVNode)('span',null,'已收集路径 ('+(0,a.toDisplayString)((0,a.unref)(r).collectedPaths.length)+')',1),(0,a.createElementVNode)('span',Ae,(0,a.toDisplayString)(e.isExpanded?'▲':'▼'),1)]),(0,a.withDirectives)((0,a.createElementVNode)('div',re,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)((0,a.unref)(r).collectedPaths,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:n,class:'path-item'},[(0,a.createElementVNode)('span',{class:'path-text',title:e},(0,a.toDisplayString)(e),9,le),(0,a.createElementVNode)('button',{class:'btn small danger remove-path-btn',onClick:e=>(e=>{r.collectedPaths.splice(e,1)})(n)},'×',8,ie)]))),128)),(0,a.createElementVNode)('div',{class:'path-collection-actions'},[(0,a.createElementVNode)('button',{class:'btn small',onClick:i},'清空所有')])],512),[[a.vShow,e.isExpanded]])],512)),[[a.vShow,(0,a.unref)(r).collectedPaths.length>0]])}});t(8586);const se=(0,f.A)(de,[['__scopeId','data-v-249f4c1a']]);var ce=t(7021),pe=t(7664);const Ce={key:0,class:'dsl-tester-modal'},ue={class:'dsl-tester-content'},fe={class:'tester-header'},me={class:'header-left'},be={key:0,class:'data-badge',title:'当前使用的是导入的外部数据'},ge={class:'header-actions'},ve=['disabled'],xe={class:'tester-body'},he={class:'panel-left'},ke={class:'panel-header'},Ee={key:0,class:'count-badge'},ye={class:'rules-container'},we={key:0,class:'rules-list'},Be={class:'rule-header'},Ne=['title'],Ve={class:'rule-detail'},Fe=['title'],Se={key:1,class:'empty-state'},je={class:'panel-right'},ze={class:'panel-header'},De={class:'output-container'},Ge={key:0,class:'console-output'},Ie={key:1,class:'empty-result'},Oe=(0,a.defineComponent)({__name:'DSLTesterModal',props:{visible:{type:Boolean,default:!1},eraDataRule:{default:()=>({})},resultText:{default:''},statData:{default:()=>({})}},emits:['update:visible','close'],setup(e,{emit:n}){const t=(0,pe.l)(),o=e,A=n,r=(0,a.ref)(o.resultText),l=(0,a.ref)(o.eraDataRule),i=(0,a.ref)(o.statData),d=(0,a.ref)(!1),s=(0,a.ref)(null),c=(0,a.computed)(()=>l.value&&Object.keys(l.value).length>0),p=(0,a.computed)(()=>'EraDataRule 测试器');function C(e,n){try{i.value=JSON.parse(e),d.value=!0,'undefined'!=typeof toastr&&toastr.success(`成功导入: ${n.name}`,''),r.value=`// 数据已导入 (${n.name})\n// 请点击“运行测试”查看结果...`}catch(e){const n=`JSON解析失败: ${e}`;'undefined'!=typeof toastr&&toastr.error(n,'')}}function u(e){'undefined'!=typeof toastr?toastr.error(`导入失败: ${e}`,''):console.error(`导入失败: ${e}`)}function f(){d.value=!1,i.value=o.statData?JSON.parse(JSON.stringify(o.statData)):{},A('update:visible',!1),A('close')}async function m(){if(c.value){x.j.log('开始运行 DSL 测试...'),r.value='正在执行...';try{const e=await t.getStatData(),n=JSON.parse(JSON.stringify(i.value)),a=JSON.parse(JSON.stringify(e)),o=await ce.$.applyRule(n,a,l.value);let A=`=== 执行日志 ===\n${o.log}\n\n`;const d=o.data;Object.keys(d).length>0?A+=`=== 数据变更 ===\n${JSON.stringify(d,null,2)}`:A+='=== 数据变更 ===\n(无数据变化)',r.value=A}catch(e){console.error(e),r.value=`>> 执行异常:\n${e.message||e}`}}else r.value='>> 错误: 没有可测试的规则数据'}return(0,a.watch)(()=>o.resultText,e=>{r.value=e}),(0,a.watch)(()=>o.eraDataRule,e=>{l.value=e?{...e}:{}},{deep:!0}),(0,a.watch)(()=>o.statData,e=>{d.value||(i.value=e?JSON.parse(JSON.stringify(e)):{})},{deep:!0,immediate:!0}),(n,t)=>e.visible?((0,a.openBlock)(),(0,a.createElementBlock)('div',Ce,[(0,a.createElementVNode)('div',ue,[(0,a.createCommentVNode)(' 1. 顶部工具栏 (Header + Actions) '),(0,a.createElementVNode)('div',fe,[(0,a.createElementVNode)('div',me,[(0,a.createElementVNode)('h3',null,(0,a.toDisplayString)(p.value),1),(0,a.createCommentVNode)(' 状态徽标 '),d.value?((0,a.openBlock)(),(0,a.createElementBlock)('span',be,' 外部数据模式 ')):(0,a.createCommentVNode)('v-if',!0)]),(0,a.createElementVNode)('div',ge,[(0,a.createCommentVNode)(' 导入组件 '),(0,a.createVNode)(ae.A,{ref_key:'fileImportRef',ref:s,'import-text':'导入数据','require-confirm':!1,class:'action-item',onFileLoaded:C,onError:u},null,512),(0,a.createCommentVNode)(' 运行按钮 '),(0,a.createElementVNode)('button',{class:'btn primary',disabled:!c.value,title:'运行 DSL 测试',onClick:m},[...t[1]||(t[1]=[(0,a.createElementVNode)('svg',{width:'14',height:'14',viewBox:'0 0 24 24',fill:'currentColor'},[(0,a.createElementVNode)('path',{d:'M8 5v14l11-7z'})],-1),(0,a.createTextVNode)(' 运行测试 ',-1)])],8,ve),t[3]||(t[3]=(0,a.createElementVNode)('div',{class:'divider'},null,-1)),(0,a.createCommentVNode)(' 关闭按钮 (图标形式) '),(0,a.createElementVNode)('button',{class:'close-btn',title:'关闭',onClick:f},[...t[2]||(t[2]=[(0,a.createElementVNode)('svg',{width:'20',height:'20',viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,a.createElementVNode)('line',{x1:'18',y1:'6',x2:'6',y2:'18'}),(0,a.createElementVNode)('line',{x1:'6',y1:'6',x2:'18',y2:'18'})],-1)])])])]),(0,a.createCommentVNode)(' 2. 主体内容区域 (左右分栏) '),(0,a.createElementVNode)('div',xe,[(0,a.createCommentVNode)(' 左侧：规则列表 '),(0,a.createElementVNode)('div',he,[(0,a.createElementVNode)('div',ke,[t[4]||(t[4]=(0,a.createElementVNode)('span',null,'规则列表',-1)),c.value?((0,a.openBlock)(),(0,a.createElementBlock)('span',Ee,(0,a.toDisplayString)(Object.keys(l.value).length),1)):(0,a.createCommentVNode)('v-if',!0)]),(0,a.createElementVNode)('div',ye,[c.value?((0,a.openBlock)(),(0,a.createElementBlock)('div',we,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(l.value,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:n,class:'rule-card'},[(0,a.createElementVNode)('div',Be,[(0,a.createElementVNode)('span',{class:'rule-name',title:String(n)},(0,a.toDisplayString)(n),9,Ne),(0,a.createElementVNode)('span',{class:(0,a.normalizeClass)(['status-dot',{active:e.enable}]),title:'启用状态'},null,2)]),(0,a.createElementVNode)('div',Ve,[(0,a.createElementVNode)('code',{class:'path-code',title:e.path},(0,a.toDisplayString)(e.path),9,Fe)])]))),128))])):((0,a.openBlock)(),(0,a.createElementBlock)('div',Se,'暂无规则数据'))])]),(0,a.createCommentVNode)(' 右侧：输出结果 '),(0,a.createElementVNode)('div',je,[(0,a.createElementVNode)('div',ze,[t[5]||(t[5]=(0,a.createElementVNode)('span',null,'执行结果',-1)),r.value?((0,a.openBlock)(),(0,a.createElementBlock)('button',{key:0,class:'clear-btn',onClick:t[0]||(t[0]=e=>r.value='')},'清空')):(0,a.createCommentVNode)('v-if',!0)]),(0,a.createElementVNode)('div',De,[r.value?((0,a.openBlock)(),(0,a.createElementBlock)('pre',Ge,(0,a.toDisplayString)(r.value),1)):((0,a.openBlock)(),(0,a.createElementBlock)('div',Ie,[...t[6]||(t[6]=[(0,a.createElementVNode)('div',{class:'icon-placeholder'},'⌨️',-1),(0,a.createElementVNode)('span',null,'准备就绪',-1),(0,a.createElementVNode)('small',null,'点击顶部 "运行测试" 查看结果（更详细的日志请查看控制台）',-1)])]))])])])])])):(0,a.createCommentVNode)('v-if',!0)}});t(1678);const Me=(0,f.A)(Oe,[['__scopeId','data-v-6a116073']]),Ue={class:'simulation-test'},_e=(0,a.defineComponent)({__name:'SimulationTest',props:{rules:{type:Object,required:!0},statData:{type:Object,required:!0}},emits:['update-stat-data'],setup(e,{expose:n,emit:t}){const o=e,A=((0,a.ref)(),(0,a.ref)(''),(0,a.ref)(!1),(0,a.ref)(!1)),r=(0,a.ref)(''),l=(0,a.ref)({});(0,a.watch)(()=>o.rules,e=>{A.value||(l.value=e)},{deep:!0,immediate:!0});const i=()=>{l.value=o.rules,A.value=!0,r.value=''},d=()=>{A.value=!1};return n({openDslTesterWithRules:e=>{l.value=e,A.value=!0,r.value=''}}),(n,t)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',Ue,[t[1]||(t[1]=(0,a.createElementVNode)('div',{class:'section-header'},[(0,a.createElementVNode)('h2',null,'测试模拟')],-1)),(0,a.createElementVNode)('div',{class:'test-controls'},[(0,a.createCommentVNode)('      <button class="btn" @click="openSimulationTestModal">打开模拟测试</button>'),(0,a.createElementVNode)('button',{class:'btn',onClick:i},'打开 Rule 测试器 (所有规则)')]),(0,a.createCommentVNode)('TODO 目前功能上与DSL类似而且有bug,暂时弃用'),(0,a.createCommentVNode)('    &lt;!&ndash; 模拟测试模态框 &ndash;&gt;'),(0,a.createCommentVNode)('    <SimulationTestModal'),(0,a.createCommentVNode)('      :visible="showSimulationModal"'),(0,a.createCommentVNode)('      :imported-data="statData"'),(0,a.createCommentVNode)('      :result-data="testResultData"'),(0,a.createCommentVNode)('      :execution-log="executionLog"'),(0,a.createCommentVNode)('      @update:visible="showSimulationModal = $event"'),(0,a.createCommentVNode)('      @close="closeSimulationModal"'),(0,a.createCommentVNode)('      @run-test="handleRunTest"'),(0,a.createCommentVNode)('    />'),(0,a.createCommentVNode)(' DSL 测试器模态框 '),(0,a.createVNode)(Me,{visible:A.value,'era-data-rule':l.value,'stat-data':e.statData,'result-text':r.value,'onUpdate:visible':t[0]||(t[0]=e=>A.value=e),onClose:d},null,8,['visible','era-data-rule','stat-data','result-text'])]))}});t(1051);const $e=(0,f.A)(_e,[['__scopeId','data-v-8bc8f95e']]);var Te=t(1704);const Re={class:'era-rule-panel'},Ye={class:'sticky-tabs'},Le={class:'tabs-container'},Je=['onClick'],We={class:'content-wrapper'},Pe={class:'json-tree-box'},qe={class:'rule-list-controls'},Ke={class:'import-export-buttons'},He={key:0,class:'empty-state'},Qe=['onClick'],Xe={class:'rule-name-container'},Ze={class:'rule-name'},en={class:'rule-status'},nn={class:'rule-actions'},tn=['onClick'],an={class:'fold-indicator'},on={class:'rule-body'},An={class:'rule-content'},rn={class:'rule-details'},ln={key:0},dn={key:1},sn={key:2},cn={key:3},pn={key:0,class:'handle-list'},Cn={class:'handle-header'},un={key:0,class:'handle-expression'},fn={class:'handle-expression'},mn={class:'rule-operations'},bn=['onClick'],gn=['onClick'],vn=['onClick'],xn={class:'field'},hn={class:'field'},kn={class:'toggle-switch'},En={class:'field'},yn={class:'field'},wn={class:'field'},Bn={class:'field'},Nn={class:'range-limit-inputs'},Vn={class:'input-group'},Fn={class:'input-group'},Sn={class:'field'},jn={class:'range-limit-inputs'},zn={class:'input-group'},Dn={class:'input-group'},Gn={class:'handle-area'},In={class:'rule-if-config',style:{'margin-bottom':'15px',padding:'10px',background:'rgba(0, 0, 0, 0.03)','border-radius':'4px',border:'1px dashed #ccc'}},On={class:'dsl-builder'},Mn={class:'dsl-header'},Un={class:'dsl-actions'},_n={class:'dsl-preview'},$n=['onClick'],Tn=['onUpdate:modelValue'],Rn={class:'handle-actions'},Yn={class:'fold-indicator'},Ln=['onClick'],Jn={class:'field'},Wn=['onUpdate:modelValue'],Pn={class:'field'},qn=['onUpdate:modelValue'],Kn={class:'dsl-builder'},Hn={class:'dsl-header'},Qn={class:'dsl-actions'},Xn=['onClick'],Zn=['onClick'],et={class:'dsl-preview'},nt=['onUpdate:modelValue','onClick'],tt={class:'dsl-builder'},at={class:'dsl-header'},ot={class:'dsl-actions'},At=['onClick'],rt=['onClick'],lt={class:'dsl-preview'},it=['onUpdate:modelValue','onClick'],dt=(0,a.defineComponent)({__name:'EraDataHandle',setup(e){const n=(0,a.ref)({}),t=(0,a.ref)({}),r=(0,a.ref)({}),l=(0,a.ref)({}),i=(0,a.ref)(''),d=(0,a.ref)(!1),s=(0,a.ref)({enable:!0,path:'',if:'',order:0,loop:1,handle:{},range:[],limit:[]}),c=(0,a.ref)({}),p=(0,A.n)(),C=(0,a.ref)(!1),u=(0,a.ref)(null),f=(0,a.ref)(null),m=(0,a.ref)(null),b=(0,a.ref)(null),g=(0,a.ref)('data'),y=(0,a.ref)(!1),w=(0,a.ref)(''),B=(0,a.ref)(!1),N=(0,a.ref)(!1),V=(0,a.ref)(null),F=(0,a.ref)(!1),S=(0,a.ref)('if'),j=(0,a.ref)(''),D=(0,a.ref)(''),G=(0,a.ref)(null),I=[{key:'data',label:'查看数据'},{key:'list',label:'查看规则'},{key:'rule',label:'编辑规则'},{key:'test',label:'测试模拟'}],O=(0,o.D)();function M(){if(!i.value)return void Ae('请输入规则名称','error');if((!d.value||d.value&&i.value!==w.value)&&t.value[i.value])return void(B.value=!0);const e=Object.values(c.value);if(e.length>0){if(new Set(e).size!==e.length)return void(N.value=!0)}T()}function U(){null===u.value||null===f.value||isNaN(Number(u.value))||isNaN(Number(f.value))?s.value.range=[]:s.value.range=[Number(u.value),Number(f.value)],null===m.value||null===b.value||isNaN(Number(m.value))||isNaN(Number(b.value))?s.value.limit=[]:s.value.limit=[Number(m.value),Number(b.value)];const e={};Object.keys(s.value.handle).forEach(n=>{const t=c.value[n]||n;e[t]=s.value.handle[n],n!==t&&(delete r.value[n],delete l.value[n],l.value[t]=l.value[n]??!0)}),s.value.handle=e,d.value&&i.value!==w.value&&(delete t.value[w.value],delete r.value[w.value]),t.value[i.value]=JSON.parse(JSON.stringify(s.value)),r.value[i.value]=!0,L(),Ae(`规则 "${i.value}" ${d.value?'更新':'添加'}成功`,'success')}function T(){U(),J()}function R(){B.value=!1,N.value=!1,T()}function Y(){B.value=!1,N.value=!1}async function L(){try{O.eraDataRule={...t.value},await O.saveEraDataRules(),Ae('规则保存成功','success')}catch(e){Ae('保存失败: '+e,'error')}}function J(){i.value='',d.value=!1,s.value={enable:!0,path:'',if:'',order:0,loop:1,handle:{},range:[],limit:[]},c.value={},l.value={},u.value=null,f.value=null,m.value=null,b.value=null,g.value='list'}function W(){let e=`handle_${Date.now()}`;for(;c.value[e];)e=`handle_${Date.now()}_${Math.random().toString(36).substr(2,5)}`;s.value.handle||(s.value.handle={}),s.value.handle[e]={order:0,loop:1,if:'',op:''},c.value[e]=e,l.value[e]=!0}function P(e){p.collectedPaths.includes(e)?toastr.warning('路径已在收集箱中',''):(p.collectedPaths.push(e),toastr.success('路径已复制到收集箱',''))}function q(e,n){if(S.value=e,j.value=n,'__RULE_IF__'===n)D.value=s.value.if||'';else{const t=s.value.handle[n];t&&t[e]?D.value=t[e]:D.value=''}F.value=!0}function K(){F.value=!1,D.value='',j.value=''}function H(e){if('__RULE_IF__'===j.value)return s.value.if=e,Ae('规则条件已应用','success'),K(),void(i.value&&U());if(!j.value)return void Ae('未找到对应的handle','error');const n=s.value.handle[j.value];n&&(n[S.value]=e,Ae('表达式已应用','success'),i.value&&U()),K()}function Q(e,n){const t=s.value.handle[n];t&&(t[e]='')}function X(){y.value=!1,w.value=''}async function Z(){if(w.value)try{delete t.value[w.value],delete r.value[w.value],await L(),Ae(`规则 "${w.value}" 删除成功`,'success')}catch(e){Ae('删除失败: '+e,'error')}finally{X()}}function ee(){try{const e=h(t.value),n=new Blob([e],{type:'application/json'}),a=URL.createObjectURL(n),o=document.createElement('a');o.href=a,o.download=`era-rules-${(new Date).toISOString().slice(0,10)}.json`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a),Ae('规则导出成功','success')}catch(e){Ae('导出失败: '+e,'error')}}function ne(e,n){try{const n=function(e){try{const n=JSON.parse(e);if(!n||'object'!=typeof n)throw new Error('无效的JSON格式');let t;t=n.rules&&'object'==typeof n.rules?n.rules:n;for(const e of Object.keys(t)){const n=t[e];n&&'object'==typeof n&&(void 0===n.enable&&(n.enable=!0),void 0===n.order&&(n.order=0),void 0===n.loop&&(n.loop=1),void 0===n.handle&&(n.handle={}))}return t}catch(e){throw x.j.error('导入规则失败:',e),new Error('解析规则文件失败')}}(e);if(!n||'object'!=typeof n)return void Ae('导入失败：文件格式不正确','error');t.value=n,r.value={},Object.keys(t.value).forEach(e=>r.value[e]=!0),L(),Ae('规则导入成功','success')}catch(e){Ae('导入失败：'+e,'error')}}function oe(e){Ae(e,'error')}function Ae(e,n){V.value={text:e,type:n},setTimeout(()=>{V.value=null},3e3)}(0,a.onMounted)(async()=>{const{stat_data:e}=getVariables({type:'chat'});n.value=e||{},await async function(){try{await O.getEraDataRules(),t.value=O.eraDataRule||{},Ae('规则加载成功','success')}catch(e){Ae('规则加载失败: '+e,'error')}}(),Object.keys(t.value).forEach(e=>r.value[e]=!0)});const re=e=>{n.value=e};function le(){const e={},n=Object.keys(t.value);n.sort((e,n)=>(t.value[e].order??Number.MAX_SAFE_INTEGER)-(t.value[n].order??Number.MAX_SAFE_INTEGER)),n.forEach(n=>{const a={...t.value[n]};if(a.handle&&Object.keys(a.handle).length>0){const e=Object.entries(a.handle);e.sort(([,e],[,n])=>(e.order??Number.MAX_SAFE_INTEGER)-(n.order??Number.MAX_SAFE_INTEGER)),a.handle={},e.forEach(([e,n])=>{a.handle[e]=n})}e[n]=a}),t.value=e,L(),Ae('规则和Handle已按Order排序','success')}const ie=(0,a.ref)(''),de=(0,a.computed)(()=>{if(!ie.value)return n.value;const e=ie.value.toLowerCase();const t=function n(t,a=''){if(null==t)return t;if('object'==typeof t&&!Array.isArray(t)){const o={};let A=!1;for(const[r,l]of Object.entries(t)){const t=a?`${a}.${r}`:r;if(r.toLowerCase().includes(e))o[r]=l,A=!0;else if('object'==typeof l&&null!==l){const e=n(l,t);void 0!==e&&(o[r]=e,A=!0)}else String(l).toLowerCase().includes(e)&&(o[r]=l,A=!0)}return A?o:void 0}if(Array.isArray(t)){const o=[];let A=!1;for(let r=0;r<t.length;r++){const l=a?`${a}[${r}]`:`[${r}]`,i=t[r];if(l.toLowerCase().includes(e))o.push(i),A=!0;else if('object'==typeof i&&null!==i){const t=n(i,l);void 0!==t?(o.push(t),A=!0):String(i).toLowerCase().includes(e)&&(o.push(i),A=!0)}else String(i).toLowerCase().includes(e)&&(o.push(i),A=!0)}return A?o:''===e?[]:void 0}return String(t).toLowerCase().includes(e)?t:void 0}(n.value);return void 0!==t?t:{}});return(e,o)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',Re,[(0,a.createCommentVNode)(' 页签导航 '),(0,a.createElementVNode)('div',Ye,[(0,a.createElementVNode)('div',Le,[((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(I,e=>(0,a.createElementVNode)('button',{key:e.key,class:(0,a.normalizeClass)({active:g.value===e.key}),onClick:n=>g.value=e.key},(0,a.toDisplayString)(e.label),11,Je)),64))])]),(0,a.createCommentVNode)(' 路径收集框 '),'rule'===g.value?((0,a.openBlock)(),(0,a.createBlock)(se,{key:0,'is-expanded':C.value,'onUpdate:isExpanded':o[0]||(o[0]=e=>C.value=e)},null,8,['is-expanded'])):(0,a.createCommentVNode)('v-if',!0),(0,a.createElementVNode)('div',We,[(0,a.createCommentVNode)(' 1.查看数据 '),(0,a.withDirectives)((0,a.createElementVNode)('section',null,[o[20]||(o[20]=(0,a.createElementVNode)('h2',null,'当前 stat_data（只读）',-1)),(0,a.createCommentVNode)(' 添加搜索框 '),(0,a.createVNode)(Te.A,{modelValue:ie.value,'onUpdate:modelValue':o[1]||(o[1]=e=>ie.value=e)},null,8,['modelValue']),(0,a.createElementVNode)('div',Pe,[(0,a.createCommentVNode)(' 修改为使用过滤后的数据 '),(0,a.createVNode)(v,{data:de.value,onSendPath:P},null,8,['data'])])],512),[[a.vShow,'data'===g.value]]),(0,a.createCommentVNode)(' 2. 查看规则（默认折叠） '),(0,a.withDirectives)((0,a.createElementVNode)('section',null,[o[30]||(o[30]=(0,a.createElementVNode)('h2',null,'规则列表',-1)),(0,a.createElementVNode)('div',qe,[(0,a.createElementVNode)('div',Ke,[(0,a.createVNode)(ae.A,{'import-text':'导入规则','export-text':'导出规则','confirm-title':'导入规则','confirm-content':'导入新规则将覆盖当前所有规则，确定要继续吗？',onExportData:ee,onImportConfirmed:ne,onError:oe})]),(0,a.createElementVNode)('div',{class:'sort-controls'},[(0,a.createElementVNode)('button',{class:'btn small',onClick:le},'按优先级排序')])]),(0,a.createCommentVNode)(' 空状态提示 '),0===Object.keys(t.value).length?((0,a.openBlock)(),(0,a.createElementBlock)('div',He,[...o[21]||(o[21]=[(0,a.createElementVNode)('svg',{xmlns:'http://www.w3.org/2000/svg',viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,a.createElementVNode)('path',{d:'M9 12h6m-6 4h6m2 5H7a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5.586a1 1 0 0 1 .707.293l5.414 5.414a1 1 0 0 1 .293.707V19a2 2 0 0 1-2 2z'})],-1),(0,a.createElementVNode)('p',null,'暂无规则，从规则编辑添加或从数据面板中选择路径',-1)])])):(0,a.createCommentVNode)('v-if',!0),(0,a.createCommentVNode)(' 规则列表 '),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(t.value,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:n,class:'rule-card'},[(0,a.createElementVNode)('div',{class:'rule-header',onClick:e=>function(e){r.value[e]=!r.value[e]}(n)},[(0,a.createElementVNode)('div',Xe,[(0,a.createElementVNode)('span',Ze,(0,a.toDisplayString)(n),1),(0,a.createElementVNode)('span',en,[(0,a.createElementVNode)('span',{class:(0,a.normalizeClass)(['status-indicator',{enabled:!1!==e.enable}])},null,2),(0,a.createTextVNode)(' '+(0,a.toDisplayString)(!1!==e.enable?'启用':'禁用'),1)])]),(0,a.createElementVNode)('div',nn,[(0,a.createCommentVNode)(' 恢复测试按钮 '),(0,a.createElementVNode)('button',{class:'btn small',onClick:(0,a.withModifiers)(e=>function(e){const n=t.value[e];if(!n)return void Ae('找不到指定的规则','warning');g.value='test';const o={[e]:n};(0,a.nextTick)(()=>{G.value?G.value.openDslTesterWithRules(o):Ae('测试组件尚未加载','error')})}(n),['stop'])},'测试 DSL',8,tn),(0,a.createElementVNode)('span',an,(0,a.toDisplayString)(r.value[n]?'›':'⌄'),1)])],8,Qe),(0,a.withDirectives)((0,a.createElementVNode)('div',on,[(0,a.createElementVNode)('div',An,[(0,a.createElementVNode)('div',rn,[(0,a.createElementVNode)('div',null,[o[22]||(o[22]=(0,a.createElementVNode)('strong',null,'路径:',-1)),(0,a.createTextVNode)(' '+(0,a.toDisplayString)(e.path),1)]),e.if?((0,a.openBlock)(),(0,a.createElementBlock)('div',ln,[o[23]||(o[23]=(0,a.createElementVNode)('strong',null,'条件:',-1)),(0,a.createTextVNode)(' '+(0,a.toDisplayString)((0,a.unref)(E.w).exprToHumanView(e.if)),1)])):(0,a.createCommentVNode)('v-if',!0),(0,a.createElementVNode)('div',null,[o[24]||(o[24]=(0,a.createElementVNode)('strong',null,'顺序:',-1)),(0,a.createTextVNode)(' '+(0,a.toDisplayString)(e.order),1)]),e.loop?((0,a.openBlock)(),(0,a.createElementBlock)('div',dn,[o[25]||(o[25]=(0,a.createElementVNode)('strong',null,'循环:',-1)),(0,a.createTextVNode)(' '+(0,a.toDisplayString)(e.loop),1)])):(0,a.createCommentVNode)('v-if',!0),e.range?((0,a.openBlock)(),(0,a.createElementBlock)('div',sn,[o[26]||(o[26]=(0,a.createElementVNode)('strong',null,'范围:',-1)),(0,a.createTextVNode)(' ['+(0,a.toDisplayString)(e.range[0])+', '+(0,a.toDisplayString)(e.range[1])+']',1)])):(0,a.createCommentVNode)('v-if',!0),e.limit?((0,a.openBlock)(),(0,a.createElementBlock)('div',cn,[o[27]||(o[27]=(0,a.createElementVNode)('strong',null,'限制:',-1)),(0,a.createTextVNode)(' ['+(0,a.toDisplayString)(e.limit[0])+', '+(0,a.toDisplayString)(e.limit[1])+']',1)])):(0,a.createCommentVNode)('v-if',!0)]),(0,a.createCommentVNode)(' handle 列表 '),e.handle&&Object.keys(e.handle).length>0?((0,a.openBlock)(),(0,a.createElementBlock)('div',pn,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.handle,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:n,class:'handle-item'},[(0,a.createElementVNode)('div',Cn,[(0,a.createElementVNode)('strong',null,(0,a.toDisplayString)(n),1),(0,a.createTextVNode)(' (顺序: '+(0,a.toDisplayString)(e.order)+', 循环: '+(0,a.toDisplayString)(e.loop)+') ',1)]),e.if?((0,a.openBlock)(),(0,a.createElementBlock)('div',un,[o[28]||(o[28]=(0,a.createElementVNode)('strong',null,'条件:',-1)),(0,a.createTextVNode)(' '+(0,a.toDisplayString)((0,a.unref)(E.w).exprToHumanView(e.if)),1)])):(0,a.createCommentVNode)('v-if',!0),(0,a.createElementVNode)('div',fn,[o[29]||(o[29]=(0,a.createElementVNode)('strong',null,'操作:',-1)),(0,a.createTextVNode)(' '+(0,a.toDisplayString)((0,a.unref)(E.w).exprToHumanView(e.op)),1)])]))),128))])):(0,a.createCommentVNode)('v-if',!0),(0,a.createElementVNode)('div',mn,[(0,a.createElementVNode)('button',{class:'btn primary',onClick:e=>function(e){i.value=e,d.value=!0,w.value=e,s.value=JSON.parse(JSON.stringify(t.value[e])),void 0===s.value.if&&(s.value.if=''),c.value={},s.value.handle&&Object.keys(s.value.handle).forEach(e=>{c.value[e]=e,l.value[e]=!0}),void 0===s.value.enable&&(s.value.enable=!0),s.value.range&&Array.isArray(s.value.range)&&s.value.range.length>=2?(u.value=s.value.range[0],f.value=s.value.range[1]):(u.value=null,f.value=null),s.value.limit&&Array.isArray(s.value.limit)&&s.value.limit.length>=2?(m.value=s.value.limit[0],b.value=s.value.limit[1]):(m.value=null,b.value=null),g.value='rule'}(n)},'编辑',8,bn),(0,a.createElementVNode)('button',{class:'btn',onClick:e=>function(e){const n=t.value[e],a=JSON.parse(JSON.stringify(n));let o=`${e}_copy`,A=1;for(;t.value[o];)o=`${e}_copy${A}`,A++;t.value[o]=a,r.value[o]=!0,L(),Ae(`规则 "${e}" 已复制为 "${o}"`,'success')}(n)},'复制',8,gn),(0,a.createElementVNode)('button',{class:'btn danger',onClick:e=>function(e){w.value=e,y.value=!0}(n)},'删除',8,vn)])])],512),[[a.vShow,!r.value[n]]])]))),128))],512),[[a.vShow,'list'===g.value]]),(0,a.createCommentVNode)(' 3. 编辑规则 '),(0,a.withDirectives)((0,a.createElementVNode)('section',null,[(0,a.createElementVNode)('h2',null,(0,a.toDisplayString)(i.value?'更新规则':'新增规则'),1),(0,a.createElementVNode)('div',xn,[o[31]||(o[31]=(0,a.createElementVNode)('label',null,'规则名称:',-1)),(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':o[2]||(o[2]=e=>i.value=e),placeholder:'唯一标识，如: 好感度rule1'},null,512),[[a.vModelText,i.value]])]),(0,a.createElementVNode)('div',hn,[o[33]||(o[33]=(0,a.createElementVNode)('label',null,'启用:',-1)),(0,a.createElementVNode)('div',kn,[(0,a.withDirectives)((0,a.createElementVNode)('input',{id:'enableToggle','onUpdate:modelValue':o[3]||(o[3]=e=>s.value.enable=e),type:'checkbox','true-value':!0,'false-value':!1},null,512),[[a.vModelCheckbox,s.value.enable]]),o[32]||(o[32]=(0,a.createElementVNode)('label',{for:'enableToggle',class:'toggle-label'},null,-1))])]),(0,a.createElementVNode)('div',En,[o[34]||(o[34]=(0,a.createElementVNode)('label',null,'路径:',-1)),(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':o[4]||(o[4]=e=>s.value.path=e),placeholder:'角色.*.特殊状态.好感度'},null,512),[[a.vModelText,s.value.path]])]),(0,a.createElementVNode)('div',yn,[o[35]||(o[35]=(0,a.createElementVNode)('label',null,'排序:',-1)),(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':o[5]||(o[5]=e=>s.value.order=e),type:'number',min:'0'},null,512),[[a.vModelText,s.value.order,void 0,{number:!0}]])]),(0,a.createElementVNode)('div',wn,[o[36]||(o[36]=(0,a.createElementVNode)('label',null,'规则循环:',-1)),(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':o[6]||(o[6]=e=>s.value.loop=e),type:'number',min:'1',max:'10000',placeholder:'1'},null,512),[[a.vModelText,s.value.loop,void 0,{number:!0}]])]),(0,a.createElementVNode)('div',Bn,[o[37]||(o[37]=(0,a.createElementVNode)('label',null,'范围限制:',-1)),(0,a.createElementVNode)('div',Nn,[(0,a.createElementVNode)('div',Vn,[(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':o[7]||(o[7]=e=>u.value=e),type:'number',placeholder:'最小值'},null,512),[[a.vModelText,u.value,void 0,{number:!0}]])]),(0,a.createElementVNode)('div',Fn,[(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':o[8]||(o[8]=e=>f.value=e),type:'number',placeholder:'最大值'},null,512),[[a.vModelText,f.value,void 0,{number:!0}]])])])]),(0,a.createElementVNode)('div',Sn,[o[38]||(o[38]=(0,a.createElementVNode)('label',null,'变化值限制:',-1)),(0,a.createElementVNode)('div',jn,[(0,a.createElementVNode)('div',zn,[(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':o[9]||(o[9]=e=>m.value=e),type:'number',placeholder:'负向最大'},null,512),[[a.vModelText,m.value,void 0,{number:!0}]])]),(0,a.createElementVNode)('div',Dn,[(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':o[10]||(o[10]=e=>b.value=e),type:'number',placeholder:'正向最大'},null,512),[[a.vModelText,b.value,void 0,{number:!0}]])])])]),(0,a.createElementVNode)('div',Gn,[(0,a.createElementVNode)('div',{class:'handle-area-header'},[o[39]||(o[39]=(0,a.createElementVNode)('span',null,'handle 运算配置:',-1)),(0,a.createElementVNode)('button',{class:'btn small primary',onClick:W},'+ 添加 handle')]),(0,a.createCommentVNode)(' 规则级别的 IF 配置 '),(0,a.createElementVNode)('div',In,[(0,a.createElementVNode)('div',On,[(0,a.createElementVNode)('div',Mn,[o[40]||(o[40]=(0,a.createElementVNode)('label',null,[(0,a.createTextVNode)('规则执行条件 (if): '),(0,a.createElementVNode)('span',{style:{'font-size':'0.85em',color:'#666','font-weight':'normal'}},'(控制所有Handle规则的执行)')],-1)),(0,a.createElementVNode)('div',Un,[(0,a.createElementVNode)('button',{class:'btn small',onClick:o[11]||(o[11]=e=>q('if','__RULE_IF__'))},'构建'),s.value.if?((0,a.openBlock)(),(0,a.createElementBlock)('button',{key:0,class:'btn small danger',onClick:o[12]||(o[12]=e=>s.value.if='')},'清空')):(0,a.createCommentVNode)('v-if',!0)])]),(0,a.createElementVNode)('div',_n,[(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':o[13]||(o[13]=e=>s.value.if=e),readonly:'',placeholder:'点击\'构建\'按钮创建规则条件表达式，为空则默认执行',onClick:o[14]||(o[14]=e=>q('if','__RULE_IF__'))},null,512),[[a.vModelText,s.value.if]])])])]),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(s.value.handle,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:n,class:'handle-editor'},[(0,a.createElementVNode)('div',{class:'handle-header',onClick:e=>l.value[n]=!l.value[n]},[(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':e=>c.value[n]=e,placeholder:'handle名称',class:'handle-name-input'},null,8,Tn),[[a.vModelText,c.value[n]]]),(0,a.createElementVNode)('div',Rn,[(0,a.createElementVNode)('span',Yn,(0,a.toDisplayString)(l.value[n]?'›':'⌄'),1),(0,a.createElementVNode)('button',{class:'btn small danger',onClick:(0,a.withModifiers)(e=>{return t=n,delete s.value.handle[t],delete c.value[t],void delete l.value[t];var t},['stop'])},'删除',8,Ln)])],8,$n),(0,a.withDirectives)((0,a.createElementVNode)('div',null,[(0,a.createElementVNode)('div',Jn,[o[41]||(o[41]=(0,a.createElementVNode)('label',null,'处理顺序:',-1)),(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':n=>e.order=n,type:'number',min:'0',placeholder:'0'},null,8,Wn),[[a.vModelText,e.order,void 0,{number:!0}]])]),(0,a.createElementVNode)('div',Pn,[o[42]||(o[42]=(0,a.createElementVNode)('label',null,'循环次数:',-1)),(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':n=>e.loop=n,type:'number',min:'1',max:'1000',placeholder:'1'},null,8,qn),[[a.vModelText,e.loop,void 0,{number:!0}]])]),(0,a.createElementVNode)('div',Kn,[(0,a.createElementVNode)('div',Hn,[o[43]||(o[43]=(0,a.createElementVNode)('label',null,'条件表达式 (if):',-1)),(0,a.createElementVNode)('div',Qn,[(0,a.createElementVNode)('button',{class:'btn small',onClick:e=>q('if',n)},'构建',8,Xn),e.if?((0,a.openBlock)(),(0,a.createElementBlock)('button',{key:0,class:'btn small danger',onClick:e=>Q('if',n)},' 清空 ',8,Zn)):(0,a.createCommentVNode)('v-if',!0)])]),(0,a.createElementVNode)('div',et,[(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':n=>e.if=n,readonly:'',placeholder:'点击\'构建\'按钮创建条件表达式',onClick:e=>q('if',n)},null,8,nt),[[a.vModelText,e.if]])])]),(0,a.createElementVNode)('div',tt,[(0,a.createElementVNode)('div',at,[o[44]||(o[44]=(0,a.createElementVNode)('label',null,'操作表达式 (op):',-1)),(0,a.createElementVNode)('div',ot,[(0,a.createElementVNode)('button',{class:'btn small',onClick:e=>q('op',n)},'构建',8,At),e.op?((0,a.openBlock)(),(0,a.createElementBlock)('button',{key:0,class:'btn small danger',onClick:e=>Q('op',n)},' 清空 ',8,rt)):(0,a.createCommentVNode)('v-if',!0)])]),(0,a.createElementVNode)('div',lt,[(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':n=>e.op=n,readonly:'',placeholder:'点击\'构建\'按钮创建操作表达式',onClick:e=>q('op',n)},null,8,it),[[a.vModelText,e.op]])])])],512),[[a.vShow,!l.value[n]]])]))),128))]),o[45]||(o[45]=(0,a.createElementVNode)('hr',null,null,-1)),(0,a.createElementVNode)('div',{class:'button-group'},[(0,a.createElementVNode)('button',{class:'btn primary',onClick:M},'保存'),(0,a.createElementVNode)('button',{class:'btn',onClick:J},'取消')])],512),[[a.vShow,'rule'===g.value]]),(0,a.createCommentVNode)(' 4. 测试模拟 '),(0,a.withDirectives)((0,a.createElementVNode)('section',null,[(0,a.createCommentVNode)(' 添加 ref 引用 '),(0,a.createVNode)($e,{ref_key:'simulationTestRef',ref:G,rules:t.value,'stat-data':n.value,onUpdateStatData:re},null,8,['rules','stat-data'])],512),[[a.vShow,'test'===g.value]])]),(0,a.createCommentVNode)(' DSL 构建器模态框 '),(0,a.createVNode)(te,{visible:F.value,'onUpdate:visible':o[15]||(o[15]=e=>F.value=e),expression:D.value,'onUpdate:expression':o[16]||(o[16]=e=>D.value=e),type:S.value,'selected-path':s.value.path||'',onApply:H,onClose:K},null,8,['visible','expression','type','selected-path']),(0,a.createCommentVNode)(' 自定义弹窗组件 '),(0,a.createVNode)(k.A,{visible:y.value,'onUpdate:visible':o[17]||(o[17]=e=>y.value=e),title:'确认删除',content:'确定要删除该规则吗？此操作不可恢复',type:'confirm','confirm-text':'确认删除','cancel-text':'取消',onConfirm:Z,onCancel:X},null,8,['visible']),(0,a.createVNode)(k.A,{visible:B.value,'onUpdate:visible':o[18]||(o[18]=e=>B.value=e),title:'规则名称重复',content:'已存在同名规则，是否覆盖？',type:'confirm','confirm-text':'覆盖','cancel-text':'取消',onConfirm:R,onCancel:Y},null,8,['visible']),(0,a.createVNode)(k.A,{visible:N.value,'onUpdate:visible':o[19]||(o[19]=e=>N.value=e),title:'Handle名称重复',content:'已存在同名Handle，是否覆盖？',type:'confirm','confirm-text':'覆盖','cancel-text':'取消',onConfirm:R,onCancel:Y},null,8,['visible']),(0,a.createCommentVNode)(' 消息提示 '),V.value?((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:1,class:(0,a.normalizeClass)(['status-message',V.value.type])},(0,a.toDisplayString)(V.value.text),3)):(0,a.createCommentVNode)('v-if',!0)]))}});t(8838);const st=(0,f.A)(dt,[['__scopeId','data-v-2c7a51c3']])},7460:(e,n,t)=>{t.r(n),t.d(n,{default:()=>l});var a=t(1314),o=t.n(a),A=t(5378),r=t.n(A)()(o());r.push([e.id,'[data-v-5ea9f1f0]{box-sizing:border-box}.title[data-v-5ea9f1f0]{margin:8px 0 16px;font-size:18px;font-weight:600;color:#111827;padding-top:4px}.switch-row[data-v-5ea9f1f0]{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;cursor:pointer;-webkit-user-select:none;user-select:none}.switch-row input[type=checkbox][data-v-5ea9f1f0]{display:none}.switch[data-v-5ea9f1f0]{position:relative;width:40px;height:22px;background:#d1d5db;border-radius:11px;transition:background .3s}.switch[data-v-5ea9f1f0]::after{content:"";position:absolute;top:2px;left:2px;width:18px;height:18px;background:#fff;border-radius:50%;transition:left .3s}.switch-row input:checked+.switch[data-v-5ea9f1f0]{background:#6366f1}.switch-row input:checked+.switch[data-v-5ea9f1f0]::after{left:20px}.tip-card[data-v-5ea9f1f0]{display:block;background:#fffbeb;border:1px solid #fde68a;color:#b45309;padding:8px 12px;border-radius:8px;font-size:13px;margin-bottom:16px}.row[data-v-5ea9f1f0]{display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:12px}.row span[data-v-5ea9f1f0]:first-child{width:130px;font-size:14px;color:#4b5563;flex-shrink:0}.row input[data-v-5ea9f1f0],.row select[data-v-5ea9f1f0]{flex:1;padding:6px 10px;border:1px solid #e5e7eb;border-radius:8px;font-size:14px;color:#111827;background:#dcd8d8;box-shadow:inset 0 1px 2px rgba(0,0,0,.03);transition:border-color .2s,box-shadow .2s}.row input[data-v-5ea9f1f0]:focus,.row select[data-v-5ea9f1f0]:focus{outline:none;border-color:#6366f1;box-shadow:0 0 0 3px rgba(99,102,241,.15),inset 0 1px 2px rgba(0,0,0,.03)}.row select[data-v-5ea9f1f0],.row select option[data-v-5ea9f1f0]{background:#dcd8d8 !important;color:#111827 !important}@media (prefers-color-scheme:dark){.row select[data-v-5ea9f1f0],.row select option[data-v-5ea9f1f0]{background:#dcd8d8 !important;color:#111827 !important}.content[data-v-5ea9f1f0]{background:#dcd8d8;color:#111827}}.btn[data-v-5ea9f1f0]{padding:6px 16px;border:none;border-radius:8px;font-size:14px;cursor:pointer;transition:background .2s,color .2s,transform .15s;background:#f3f4f6;color:#111827;box-shadow:0 1px 2px 0 rgba(0,0,0,.05)}.btn[data-v-5ea9f1f0]:hover{background:#e5e7eb}.btn.small[data-v-5ea9f1f0]{padding:4px 12px;font-size:13px}.btn.primary[data-v-5ea9f1f0]{background:#6366f1;color:#fff}.btn.primary[data-v-5ea9f1f0]:hover{background:#4f46e5}.btn.danger[data-v-5ea9f1f0]{background:#ef4444;color:#fff}.btn.danger[data-v-5ea9f1f0]:hover{background:#dc2626}.footer[data-v-5ea9f1f0]{display:flex;justify-content:flex-end;gap:8px;margin-top:16px}.list-item[data-v-5ea9f1f0]{display:flex;align-items:center;justify-content:space-between;padding:8px 12px;background:#f9fafb;border-radius:6px;margin-bottom:8px;border:1px solid #e5e7eb}.list-item[data-v-5ea9f1f0]:last-child{margin-bottom:0}.tag[data-v-5ea9f1f0]{display:inline-block;padding:2px 8px;background:#e0e7ff;color:#3730a3;border-radius:4px;font-size:12px;margin-right:6px;margin-bottom:4px}.message[data-v-5ea9f1f0]{padding:8px 12px;border-radius:6px;margin-bottom:12px;font-size:13px}.message.success[data-v-5ea9f1f0]{background:#d1fae5;color:#065f46;border:1px solid #a7f3d0}.message.error[data-v-5ea9f1f0]{background:#fee2e2;color:#991b1b;border:1px solid #fecaca}.message.warning[data-v-5ea9f1f0]{background:#fef3c7;color:#92400e;border:1px solid #fde68a}.message.info[data-v-5ea9f1f0]{background:#e0f2fe;color:#1e40af;border:1px solid #bae6fd}.form-group[data-v-5ea9f1f0]{margin-bottom:16px}.form-group label[data-v-5ea9f1f0]{display:block;margin-bottom:6px;font-size:14px;color:#374151;font-weight:500}.divider[data-v-5ea9f1f0]{height:1px;background:#e5e7eb;margin:16px 0;border:none}.card-container[data-v-5ea9f1f0]{background:#dcd8d8;border:1px solid #e5e7eb;border-radius:8px;padding:16px;margin-bottom:16px;box-shadow:0 1px 3px 0 rgba(0,0,0,.1)}.loading[data-v-5ea9f1f0]{display:inline-block;width:20px;height:20px;border:2px solid #f3f4f6;border-top:2px solid #6366f1;border-radius:50%;animation:spin-5ea9f1f0 1s linear infinite}@keyframes spin-5ea9f1f0{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.tooltip[data-v-5ea9f1f0]{position:relative;display:inline-block;cursor:help;margin-left:4px}.tooltip[data-v-5ea9f1f0]::after{content:attr(data-tooltip);position:absolute;bottom:100%;left:50%;transform:translateX(-50%);background:#111827;color:#fff;padding:6px 10px;border-radius:4px;font-size:12px;white-space:nowrap;opacity:0;visibility:hidden;transition:opacity .2s}.tooltip[data-v-5ea9f1f0]:hover::after{opacity:1;visibility:visible}.page-tabs[data-v-5ea9f1f0]{display:flex;margin-bottom:20px;border-bottom:1px solid #e5e7eb}.tab-button[data-v-5ea9f1f0]{padding:10px 20px;border:none;background:rgba(0,0,0,0);cursor:pointer;font-size:14px;color:#6b7280;border-bottom:2px solid rgba(0,0,0,0)}.tab-button.active[data-v-5ea9f1f0]{color:#6366f1;border-bottom:2px solid #6366f1}.tab-button[data-v-5ea9f1f0]:hover:not(.active){color:#111827}','',{version:3,sources:['webpack://./src/ERA助手/UI/view/AsyncAnalyze.vue'],names:[],mappings:'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',sourcesContent:['\n/************ 通用 ************/\n* {\n  box-sizing: border-box;\n}\n\n/* 确保标题有足够的上边距 */\n.title {\n  margin: 8px 0 16px; /* 增加上边距 */\n  font-size: 18px;\n  font-weight: 600;\n  color: #111827;\n  padding-top: 4px; /* 额外内边距 */\n}\n\n/************ 开关 ************/\n.switch-row {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 16px;\n  cursor: pointer;\n  user-select: none;\n}\n.switch-row input[type=\'checkbox\'] {\n  display: none;\n}\n.switch {\n  position: relative;\n  width: 40px;\n  height: 22px;\n  background: #d1d5db;\n  border-radius: 11px;\n  transition: background 0.3s;\n}\n.switch::after {\n  content: \'\';\n  position: absolute;\n  top: 2px;\n  left: 2px;\n  width: 18px;\n  height: 18px;\n  background: #fff;\n  border-radius: 50%;\n  transition: left 0.3s;\n}\n.switch-row input:checked + .switch {\n  background: #6366f1;\n}\n.switch-row input:checked + .switch::after {\n  left: 20px;\n}\n\n/************ 提示卡片 ************/\n.tip-card {\n  display: block;\n  background: #fffbeb;\n  border: 1px solid #fde68a;\n  color: #b45309;\n  padding: 8px 12px;\n  border-radius: 8px;\n  font-size: 13px;\n  margin-bottom: 16px;\n}\n\n/************ 行 ************/\n.row {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 12px;\n  margin-bottom: 12px;\n}\n.row span:first-child {\n  width: 130px;\n  font-size: 14px;\n  color: #4b5563;\n  flex-shrink: 0;\n}\n.row input,\n.row select {\n  flex: 1;\n  padding: 6px 10px;\n  border: 1px solid #e5e7eb;\n  border-radius: 8px;\n  font-size: 14px;\n  color: #111827;\n  background: #dcd8d8;\n  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.03);\n  transition:\n    border-color 0.2s,\n    box-shadow 0.2s;\n}\n.row input:focus,\n.row select:focus {\n  outline: none;\n  border-color: #6366f1;\n  box-shadow:\n    0 0 0 3px rgba(99, 102, 241, 0.15),\n    inset 0 1px 2px rgba(0, 0, 0, 0.03);\n}\n\n/* 强制浅色 select */\n.row select,\n.row select option {\n  background: #dcd8d8 !important;\n  color: #111827 !important;\n}\n/* 为深色模式提供回退 */\n@media (prefers-color-scheme: dark) {\n  .row select,\n  .row select option {\n    background: #dcd8d8 !important;\n    color: #111827 !important;\n  }\n\n  /* 确保在深色模式下卡片内容保持浅色 */\n  .content {\n    background: #dcd8d8;\n    color: #111827;\n  }\n}\n\n/************ 按钮 ************/\n.btn {\n  padding: 6px 16px;\n  border: none;\n  border-radius: 8px;\n  font-size: 14px;\n  cursor: pointer;\n  transition:\n    background 0.2s,\n    color 0.2s,\n    transform 0.15s;\n  background: #f3f4f6;\n  color: #111827;\n  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n}\n.btn:hover {\n  background: #e5e7eb;\n}\n.btn.small {\n  padding: 4px 12px;\n  font-size: 13px;\n}\n.btn.primary {\n  background: #6366f1;\n  color: #fff;\n}\n.btn.primary:hover {\n  background: #4f46e5;\n}\n.btn.danger {\n  background: #ef4444;\n  color: #fff;\n}\n.btn.danger:hover {\n  background: #dc2626;\n}\n\n/************ 底部操作区 ************/\n.footer {\n  display: flex;\n  justify-content: flex-end;\n  gap: 8px;\n  margin-top: 16px;\n}\n\n/************ 列表样式 ************/\n.list-item {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 8px 12px;\n  background: #f9fafb;\n  border-radius: 6px;\n  margin-bottom: 8px;\n  border: 1px solid #e5e7eb;\n}\n.list-item:last-child {\n  margin-bottom: 0;\n}\n\n/************ 标签样式 ************/\n.tag {\n  display: inline-block;\n  padding: 2px 8px;\n  background: #e0e7ff;\n  color: #3730a3;\n  border-radius: 4px;\n  font-size: 12px;\n  margin-right: 6px;\n  margin-bottom: 4px;\n}\n\n/************ 消息提示 ************/\n.message {\n  padding: 8px 12px;\n  border-radius: 6px;\n  margin-bottom: 12px;\n  font-size: 13px;\n}\n.message.success {\n  background: #d1fae5;\n  color: #065f46;\n  border: 1px solid #a7f3d0;\n}\n.message.error {\n  background: #fee2e2;\n  color: #991b1b;\n  border: 1px solid #fecaca;\n}\n.message.warning {\n  background: #fef3c7;\n  color: #92400e;\n  border: 1px solid #fde68a;\n}\n.message.info {\n  background: #e0f2fe;\n  color: #1e40af;\n  border: 1px solid #bae6fd;\n}\n\n/************ 表单组 ************/\n.form-group {\n  margin-bottom: 16px;\n}\n.form-group label {\n  display: block;\n  margin-bottom: 6px;\n  font-size: 14px;\n  color: #374151;\n  font-weight: 500;\n}\n\n/************ 分隔线 ************/\n.divider {\n  height: 1px;\n  background: #e5e7eb;\n  margin: 16px 0;\n  border: none;\n}\n\n/************ 卡片容器 ************/\n.card-container {\n  background: #dcd8d8;\n  border: 1px solid #e5e7eb;\n  border-radius: 8px;\n  padding: 16px;\n  margin-bottom: 16px;\n  box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);\n}\n\n/************ 加载状态 ************/\n.loading {\n  display: inline-block;\n  width: 20px;\n  height: 20px;\n  border: 2px solid #f3f4f6;\n  border-top: 2px solid #6366f1;\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n}\n@keyframes spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n\n/************ 工具提示 ************/\n.tooltip {\n  position: relative;\n  display: inline-block;\n  cursor: help;\n  margin-left: 4px;\n}\n.tooltip::after {\n  content: attr(data-tooltip);\n  position: absolute;\n  bottom: 100%;\n  left: 50%;\n  transform: translateX(-50%);\n  background: #111827;\n  color: white;\n  padding: 6px 10px;\n  border-radius: 4px;\n  font-size: 12px;\n  white-space: nowrap;\n  opacity: 0;\n  visibility: hidden;\n  transition: opacity 0.2s;\n}\n.tooltip:hover::after {\n  opacity: 1;\n  visibility: visible;\n}\n\n/************ 页面标签 ************/\n.page-tabs {\n  display: flex;\n  margin-bottom: 20px;\n  border-bottom: 1px solid #e5e7eb;\n}\n\n.tab-button {\n  padding: 10px 20px;\n  border: none;\n  background: transparent;\n  cursor: pointer;\n  font-size: 14px;\n  color: #6b7280;\n  border-bottom: 2px solid transparent;\n\n  &.active {\n    color: #6366f1;\n    border-bottom: 2px solid #6366f1;\n  }\n\n  &:hover:not(.active) {\n    color: #111827;\n  }\n}\n'],sourceRoot:''}]);const l=r},7562:(e,n,t)=>{t.r(n),t.d(n,{default:()=>l});var a=t(1314),o=t.n(a),A=t(5378),r=t.n(A)()(o());r.push([e.id,'.json-node[data-v-170e8619]{position:relative}.line[data-v-170e8619]{display:flex;align-items:center;gap:6px;padding:4px;border-radius:4px;transition:background-color .2s}.line[data-v-170e8619]:hover{background-color:#f1f5f9}.line:hover .actions[data-v-170e8619]{opacity:1}.arrow[data-v-170e8619]{cursor:pointer;width:16px;text-align:center;font-size:10px;color:#94a3b8;transition:transform .2s}.arrow.expanded[data-v-170e8619]{transform:rotate(90deg)}.space[data-v-170e8619]{width:16px}.key[data-v-170e8619]{color:#1e293b;font-weight:600}.value[data-v-170e8619]{cursor:pointer}.value.type-string[data-v-170e8619]{color:#059669}.value.type-number[data-v-170e8619]{color:#dc2626}.value.type-boolean[data-v-170e8619]{color:#7c3aed}.value.type-null[data-v-170e8619]{color:#64748b;font-style:italic}.preview[data-v-170e8619]{color:#94a3b8;font-style:italic}.editor-container[data-v-170e8619]{display:flex;gap:6px;align-items:center}.edit-select[data-v-170e8619],.edit-input[data-v-170e8619]{padding:2px 6px;font-size:12px;border:1px solid #cbd5e1;border-radius:4px;background-color:#fff !important;color:#1e293b !important;font-family:monospace}.edit-select option[data-v-170e8619]{background:#fff !important;color:#1e293b !important}.actions[data-v-170e8619]{margin-left:auto;display:flex;gap:4px;opacity:0;transition:opacity .2s}.btn-action[data-v-170e8619]{border:none;background:rgba(0,0,0,0);cursor:pointer;color:#64748b;font-size:14px;width:24px;height:24px;border-radius:4px;display:flex;align-items:center;justify-content:center}.btn-action[data-v-170e8619]:hover{background-color:#e2e8f0;color:#1e293b}.btn-action.danger[data-v-170e8619]:hover{background-color:#fee2e2;color:#ef4444}.btn-action.save[data-v-170e8619]{color:#10b981}.btn-action.cancel[data-v-170e8619]{color:#ef4444}.children-container[data-v-170e8619]{padding-left:10px;border-left:1px dashed #e2e8f0}','',{version:3,sources:['webpack://./src/ERA助手/UI/components/JsonNode/JsonNodeEdit.vue'],names:[],mappings:'AACA,4BACE,iBAAA,CAGF,uBACE,YAAA,CACA,kBAAA,CACA,OAAA,CACA,WAAA,CACA,iBAAA,CACA,+BAAA,CAEA,6BACE,wBAAA,CACA,sCACE,SAAA,CAKN,wBACE,cAAA,CACA,UAAA,CACA,iBAAA,CACA,cAAA,CACA,aAAA,CACA,wBAAA,CACA,iCACE,uBAAA,CAIJ,wBACE,UAAA,CAGF,sBACE,aAAA,CACA,eAAA,CAGF,wBACE,cAAA,CACA,oCACE,aAAA,CAEF,oCACE,aAAA,CAEF,qCACE,aAAA,CAEF,kCACE,aAAA,CACA,iBAAA,CAIJ,0BACE,aAAA,CACA,iBAAA,CAGF,mCACE,YAAA,CACA,OAAA,CACA,kBAAA,CAGF,2DAEE,eAAA,CACA,cAAA,CACA,wBAAA,CACA,iBAAA,CACA,gCAAA,CACA,wBAAA,CACA,qBAAA,CAIF,qCACE,0BAAA,CACA,wBAAA,CAIF,0BACE,gBAAA,CACA,YAAA,CACA,OAAA,CACA,SAAA,CACA,sBAAA,CAGF,6BACE,WAAA,CACA,wBAAA,CACA,cAAA,CACA,aAAA,CACA,cAAA,CACA,UAAA,CACA,WAAA,CACA,iBAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CACA,mCACE,wBAAA,CACA,aAAA,CAEF,0CACE,wBAAA,CACA,aAAA,CAEF,kCACE,aAAA,CAEF,oCACE,aAAA,CAIJ,qCACE,iBAAA,CACA,8BAAA',sourcesContent:['\n.json-node {\n  position: relative;\n}\n\n.line {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 4px;\n  border-radius: 4px;\n  transition: background-color 0.2s;\n\n  &:hover {\n    background-color: #f1f5f9;\n    .actions {\n      opacity: 1;\n    }\n  }\n}\n\n.arrow {\n  cursor: pointer;\n  width: 16px;\n  text-align: center;\n  font-size: 10px;\n  color: #94a3b8;\n  transition: transform 0.2s;\n  &.expanded {\n    transform: rotate(90deg);\n  }\n}\n\n.space {\n  width: 16px;\n}\n\n.key {\n  color: #1e293b;\n  font-weight: 600;\n}\n\n.value {\n  cursor: pointer;\n  &.type-string {\n    color: #059669;\n  }\n  &.type-number {\n    color: #dc2626;\n  }\n  &.type-boolean {\n    color: #7c3aed;\n  }\n  &.type-null {\n    color: #64748b;\n    font-style: italic;\n  }\n}\n\n.preview {\n  color: #94a3b8;\n  font-style: italic;\n}\n\n.editor-container {\n  display: flex;\n  gap: 6px;\n  align-items: center;\n}\n\n.edit-select,\n.edit-input {\n  padding: 2px 6px;\n  font-size: 12px;\n  border: 1px solid #cbd5e1;\n  border-radius: 4px;\n  background-color: #fff !important;\n  color: #1e293b !important;\n  font-family: monospace;\n}\n\n/* 强制下拉框选项的颜色 */\n.edit-select option {\n  background: #fff !important;\n  color: #1e293b !important;\n}\n\n// 操作按钮区域 (Flexbox 布局)\n.actions {\n  margin-left: auto; // 关键：将按钮推到最右边\n  display: flex;\n  gap: 4px;\n  opacity: 0; // 默认隐藏\n  transition: opacity 0.2s;\n}\n\n.btn-action {\n  border: none;\n  background: transparent;\n  cursor: pointer;\n  color: #64748b;\n  font-size: 14px;\n  width: 24px;\n  height: 24px;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  &:hover {\n    background-color: #e2e8f0;\n    color: #1e293b;\n  }\n  &.danger:hover {\n    background-color: #fee2e2;\n    color: #ef4444;\n  }\n  &.save {\n    color: #10b981;\n  }\n  &.cancel {\n    color: #ef4444;\n  }\n}\n\n.children-container {\n  padding-left: 10px;\n  border-left: 1px dashed #e2e8f0;\n}\n'],sourceRoot:''}]);const l=r},7664:(e,n,t)=>{t.d(n,{l:()=>s});var a=t(3035),o=(t(6328),t(8521));const A=async e=>{await eventEmit(o.e.DELETE_BY_OBJECT,e)},r=async e=>{await eventEmit(o.e.UPDATE_BY_OBJECT,e)},l=async e=>{await eventEmit(o.e.INSERT_BY_OBJECT,e)},i=async e=>{await eventEmit(o.e.FORCE_SYNC,{mode:e})};var d=t(9761);const s=(0,a.defineStore)('KatEraEdit',()=>{const e=async()=>{const{stat_data:e}=getVariables({type:'chat'});return d.j.log('获取stat_data内容: ',e),e||{}},n=(e,n,t,a)=>{let o=e;for(const e of n)o[e]||(o[e]={}),o=o[e];o[t]=a};return{getStatData:e,saveEraEdit:async t=>{if(!t||'object'!=typeof t)return;const a=await e(),d={},s={},c={},p=(e,t,a=[])=>{const o=new Set(e&&'object'==typeof e&&!Array.isArray(e)?Object.keys(e):[]),A=new Set(t&&'object'==typeof t&&!Array.isArray(t)?Object.keys(t):[]);o.forEach(t=>{if(!A.has(t)){const o=e[t],A=o&&'object'==typeof o&&!Array.isArray(o)&&Object.keys(o).length>0;n(d,a,t,A?{}:null)}}),A.forEach(e=>{o.has(e)||n(c,a,e,t[e])}),A.forEach(A=>{if(o.has(A)){const o=e[A],r=t[A];o&&r&&'object'==typeof o&&'object'==typeof r&&!Array.isArray(o)&&!Array.isArray(r)?p(o,r,[...a,A]):JSON.stringify(o)!==JSON.stringify(r)&&n(s,a,A,r)}})};p(a,t,[]),Object.keys(d).length>0&&await A(d),Object.keys(s).length>0&&await r(s),Object.keys(c).length>0&&await l(c),await i(o.e.SYNC_MODE.LATEST)}}})},8137:(e,n,t)=>{var a=t(2478);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(4424).A)('6833d7f8',a,!1,{ssrId:!0})},8386:(e,n,t)=>{t.r(n),t.d(n,{default:()=>l});var a=t(1314),o=t.n(a),A=t(5378),r=t.n(A)()(o());r.push([e.id,'.era-rule-panel[data-v-2c7a51c3]{margin:8px 0 16px;display:flex;flex-direction:column;flex:1;background:#f5f6fa;font-size:12px;color:#111827;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.1);position:relative}.sticky-tabs[data-v-2c7a51c3]{position:sticky;top:0;z-index:10;background:#f5f6fa;border-bottom:1px solid #e5e7eb}.tabs-container[data-v-2c7a51c3]{display:flex;gap:8px;padding:12px 16px 8px;background:#f5f6fa}.tabs-container button[data-v-2c7a51c3]{padding:8px 16px;border:none;background:none;font-size:13px;color:#111827;cursor:pointer;position:relative;transition:color .2s;border-radius:6px;font-weight:600}.tabs-container button[data-v-2c7a51c3]::after{content:"";position:absolute;left:0;right:0;bottom:-9px;height:2px;background:#6366f1;transform:scaleX(0);transition:transform .2s}.tabs-container button.active[data-v-2c7a51c3]{color:#4f46e5;font-weight:700}.tabs-container button.active[data-v-2c7a51c3]::after{transform:scaleX(1)}.tabs-container button[data-v-2c7a51c3]:hover{background:rgba(99,102,241,.08)}.content-wrapper[data-v-2c7a51c3]{flex:1;min-height:0;overflow-y:auto;padding:0 16px 16px}section[data-v-2c7a51c3]{min-height:0;display:flex;flex-direction:column;gap:12px;padding-top:12px}h2[data-v-2c7a51c3]{margin:0 0 8px;font-size:15px;font-weight:600;color:#111827}.json-tree-box[data-v-2c7a51c3]{flex:1;min-height:0;overflow:auto;background:#fff;border:1px solid #e5e7eb;border-radius:6px;padding:8px;box-shadow:0 1px 2px 0 rgba(0,0,0,.05)}.rule-card[data-v-2c7a51c3]{background:#fff;border:1px solid #e5e7eb;border-radius:6px;overflow:hidden;box-shadow:0 1px 2px 0 rgba(0,0,0,.05)}.rule-header[data-v-2c7a51c3]{display:flex;justify-content:space-between;align-items:center;padding:8px 10px;background:#f9fafb;cursor:pointer;-webkit-user-select:none;user-select:none;font-weight:500}.rule-body[data-v-2c7a51c3]{padding:10px;border-top:1px solid #e5e7eb}.field[data-v-2c7a51c3]{display:flex;align-items:center;gap:8px;margin-bottom:8px}.field label[data-v-2c7a51c3]{width:70px;font-size:12px;color:#111827;flex-shrink:0;font-weight:500}.field input[data-v-2c7a51c3],.field select[data-v-2c7a51c3]{flex:1;padding:5px 8px;border:1px solid #e5e7eb;border-radius:6px;font-size:12px;color:#111827;background:#fff;box-shadow:inset 0 1px 2px rgba(0,0,0,.03);transition:border-color .2s,box-shadow .2s}.field input[data-v-2c7a51c3]:focus,.field select[data-v-2c7a51c3]:focus{outline:none;border-color:#6366f1;box-shadow:0 0 0 3px rgba(99,102,241,.15),inset 0 1px 2px rgba(0,0,0,.03)}.handle-area[data-v-2c7a51c3]{margin-top:10px;padding:10px;background:#f9fafb;border-radius:6px}.btn[data-v-2c7a51c3]{padding:5px 12px;border:none;border-radius:6px;font-size:12px;cursor:pointer;transition:background .2s,color .2s,transform .15s;background:#f3f4f6;color:#111827;box-shadow:0 1px 2px 0 rgba(0,0,0,.05);font-weight:500}.btn[data-v-2c7a51c3]:hover{background:#e5e7eb;color:#000}.btn.primary[data-v-2c7a51c3]{background:#4f46e5;color:#fff;font-weight:500}.btn.primary[data-v-2c7a51c3]:hover{background:#4338ca;color:#fff}.btn.danger[data-v-2c7a51c3]{background:#dc2626;color:#fff;font-weight:500}.btn.danger[data-v-2c7a51c3]:hover{background:#b91c1c;color:#fff}.button-group[data-v-2c7a51c3]{display:flex;gap:8px;margin-top:12px;justify-content:flex-end}hr[data-v-2c7a51c3]{border:none;border-top:1px solid #e5e7eb;margin:10px 0}.status-message[data-v-2c7a51c3]{padding:6px 10px;border-radius:4px;font-size:11px;margin-bottom:8px}.status-message.success[data-v-2c7a51c3]{background:#d1fae5;color:#065f46;border:1px solid #a7f3d0}.status-message.error[data-v-2c7a51c3]{background:#fee2e2;color:#991b1b;border:1px solid #fecaca}.status-message.warning[data-v-2c7a51c3]{background:#fef3c7;color:#92400e;border:1px solid #fde68a}.empty-state[data-v-2c7a51c3]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px;color:#6b7280;font-size:11px;text-align:center}.empty-state svg[data-v-2c7a51c3]{width:24px;height:24px;margin-bottom:8px;opacity:.5}.content-wrapper[data-v-2c7a51c3]::-webkit-scrollbar{width:8px}.content-wrapper[data-v-2c7a51c3]::-webkit-scrollbar-track{background:rgba(0,0,0,0)}.content-wrapper[data-v-2c7a51c3]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:4px}.content-wrapper[data-v-2c7a51c3]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.json-tree-box[data-v-2c7a51c3]::-webkit-scrollbar{width:6px}.json-tree-box[data-v-2c7a51c3]::-webkit-scrollbar-track{background:#f1f5f9;border-radius:3px}.json-tree-box[data-v-2c7a51c3]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.json-tree-box[data-v-2c7a51c3]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.rule-operations[data-v-2c7a51c3]{display:flex;gap:8px;margin-top:8px}.rule-operations .btn[data-v-2c7a51c3]{flex:1;min-width:60px}.rule-status[data-v-2c7a51c3]{margin-left:8px;font-size:11px;color:#6b7280;display:flex;align-items:center;gap:4px}.status-indicator[data-v-2c7a51c3]{width:8px;height:8px;border-radius:50%;background:#ef4444}.status-indicator.enabled[data-v-2c7a51c3]{background:#10b981}.rule-name-container[data-v-2c7a51c3]{display:flex;align-items:center}.toggle-switch[data-v-2c7a51c3]{position:relative;width:44px;height:22px}.toggle-switch input[data-v-2c7a51c3]{opacity:0;width:0;height:0}.toggle-label[data-v-2c7a51c3]{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#e5e7eb;transition:.3s;border-radius:22px}.toggle-label[data-v-2c7a51c3]:before{position:absolute;content:"";height:16px;width:16px;left:3px;bottom:3px;background-color:#fff;transition:.3s;border-radius:50%}input:checked+.toggle-label[data-v-2c7a51c3]{background-color:#10b981}input:checked+.toggle-label[data-v-2c7a51c3]:before{transform:translateX(40px)}.btn.small[data-v-2c7a51c3]{padding:3px 8px;font-size:11px}.rule-list-controls[data-v-2c7a51c3]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.import-export-buttons[data-v-2c7a51c3]{display:flex;gap:8px}.sort-controls[data-v-2c7a51c3]{display:flex;gap:8px}.range-limit-inputs[data-v-2c7a51c3]{display:flex;gap:8px;flex:1}.input-group[data-v-2c7a51c3]{display:flex;align-items:center;flex:1;gap:4px;min-width:0}.input-label[data-v-2c7a51c3]{font-size:11px;color:#111827;min-width:28px;white-space:nowrap;font-weight:500}.range-limit-inputs input[data-v-2c7a51c3]{flex:1;padding:4px 6px;border:1px solid #e5e7eb;border-radius:4px;font-size:11px;min-width:0}.handle-area[data-v-2c7a51c3]{margin-top:16px}.handle-area-header[data-v-2c7a51c3]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.handle-editor[data-v-2c7a51c3]{margin-bottom:16px;padding:12px;background:#f9fafb;border:1px solid #e5e7eb;border-radius:6px}.handle-header[data-v-2c7a51c3]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;padding-bottom:8px;border-bottom:1px solid #e5e7eb;cursor:pointer;-webkit-user-select:none;user-select:none}.handle-name-input[data-v-2c7a51c3]{font-weight:bold;border:1px solid #d1d5db;border-radius:4px;padding:4px 8px;width:auto;min-width:120px;color:#111827;cursor:text}.handle-name-input[data-v-2c7a51c3]:focus{outline:none;border-color:#6366f1;box-shadow:0 0 0 3px rgba(99,102,241,.15)}.handle-actions[data-v-2c7a51c3]{display:flex;align-items:center;gap:8px}.fold-indicator[data-v-2c7a51c3]{font-size:16px;font-weight:bold;color:#6b7280;transition:transform .2s;cursor:pointer}.dsl-builder[data-v-2c7a51c3]{margin:8px 0}.dsl-header[data-v-2c7a51c3]{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}.dsl-header label[data-v-2c7a51c3]{font-size:12px;font-weight:600;color:#111827}.dsl-preview input[data-v-2c7a51c3]{width:100%;padding:6px 8px;border:1px solid #e5e7eb;border-radius:4px;font-size:11px;background:#f8fafc;cursor:pointer;color:#111827;font-weight:500}.dsl-preview input[data-v-2c7a51c3]:hover{background:#f1f5f9}.handle-list[data-v-2c7a51c3]{margin:12px 0}.handle-list .handle-item[data-v-2c7a51c3]{margin-bottom:8px;padding:8px;background:#f8fafc;border:1px solid #e2e8f0;border-radius:4px}.handle-expression[data-v-2c7a51c3]{margin:4px 0;font-size:11px;color:#111827;overflow-x:auto;word-break:break-all}.handle-expression strong[data-v-2c7a51c3]{color:#000;font-weight:600}.rule-details[data-v-2c7a51c3]{margin-bottom:12px;font-size:12px;color:#111827}.rule-details div[data-v-2c7a51c3]{margin:4px 0;color:#111827}@media (max-width:768px){.sticky-tabs[data-v-2c7a51c3]{padding:0}.tabs-container[data-v-2c7a51c3]{padding:10px 12px 6px;gap:4px}.tabs-container button[data-v-2c7a51c3]{padding:6px 10px;font-size:12px}.content-wrapper[data-v-2c7a51c3]{padding:0 12px 12px}.range-limit-inputs[data-v-2c7a51c3]{flex-direction:column;gap:2px}.input-group[data-v-2c7a51c3]{min-width:calc(50% - 4px)}}','',{version:3,sources:['webpack://./src/ERA助手/UI/view/EraDataHandle.vue'],names:[],mappings:'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',sourcesContent:['\n.era-rule-panel {\n  margin: 8px 0 16px;\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  background: #f5f6fa;\n  font-size: 12px;\n  color: #111827;\n  border-radius: 8px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n  position: relative;\n}\n\n/* 2. 固定的页签容器 */\n.sticky-tabs {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background: #f5f6fa;\n  border-bottom: 1px solid #e5e7eb;\n}\n\n.tabs-container {\n  display: flex;\n  gap: 8px;\n  padding: 12px 16px 8px;\n  background: #f5f6fa;\n}\n\n.tabs-container button {\n  padding: 8px 16px;\n  border: none;\n  background: none;\n  font-size: 13px;\n  color: #111827;\n  cursor: pointer;\n  position: relative;\n  transition: color 0.2s;\n  border-radius: 6px;\n  font-weight: 600;\n}\n\n.tabs-container button::after {\n  content: \'\';\n  position: absolute;\n  left: 0;\n  right: 0;\n  bottom: -9px;\n  height: 2px;\n  background: #6366f1;\n  transform: scaleX(0);\n  transition: transform 0.2s;\n}\n\n.tabs-container button.active {\n  color: #4f46e5;\n  font-weight: 700;\n}\n\n.tabs-container button.active::after {\n  transform: scaleX(1);\n}\n\n/* 悬停效果 */\n.tabs-container button:hover {\n  background: rgba(99, 102, 241, 0.08);\n}\n\n/* 3. 内容包装器 */\n.content-wrapper {\n  flex: 1;\n  min-height: 0;\n  overflow-y: auto;\n  padding: 0 16px 16px;\n}\n\n/* 4. 内容区统一卡片 */\nsection {\n  min-height: 0;\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  padding-top: 12px;\n}\n\nh2 {\n  margin: 0 0 8px;\n  font-size: 15px;\n  font-weight: 600;\n  color: #111827;\n}\n\n/* 5. JSON 展示区 */\n.json-tree-box {\n  flex: 1;\n  min-height: 0;\n  overflow: auto;\n  background: #ffffff;\n  border: 1px solid #e5e7eb;\n  border-radius: 6px;\n  padding: 8px;\n  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n}\n\n/* 6. 规则卡片 */\n.rule-card {\n  background: #ffffff;\n  border: 1px solid #e5e7eb;\n  border-radius: 6px;\n  overflow: hidden;\n  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n}\n\n.rule-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 8px 10px;\n  background: #f9fafb;\n  cursor: pointer;\n  user-select: none;\n  font-weight: 500;\n}\n\n.rule-body {\n  padding: 10px;\n  border-top: 1px solid #e5e7eb;\n}\n\n/* 7. 表单字段 */\n.field {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 8px;\n}\n\n.field label {\n  width: 70px;\n  font-size: 12px;\n  color: #111827;\n  flex-shrink: 0;\n  font-weight: 500;\n}\n\n.field input,\n.field select {\n  flex: 1;\n  padding: 5px 8px;\n  border: 1px solid #e5e7eb;\n  border-radius: 6px;\n  font-size: 12px;\n  color: #111827;\n  background: #ffffff;\n  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.03);\n  transition:\n    border-color 0.2s,\n    box-shadow 0.2s;\n}\n\n.field input:focus,\n.field select:focus {\n  outline: none;\n  border-color: #6366f1;\n  box-shadow:\n    0 0 0 3px rgba(99, 102, 241, 0.15),\n    inset 0 1px 2px rgba(0, 0, 0, 0.03);\n}\n\n/* 8. handle 区 */\n.handle-area {\n  margin-top: 10px;\n  padding: 10px;\n  background: #f9fafb;\n  border-radius: 6px;\n}\n\n/* 9. 按钮 */\n.btn {\n  padding: 5px 12px;\n  border: none;\n  border-radius: 6px;\n  font-size: 12px;\n  cursor: pointer;\n  transition:\n    background 0.2s,\n    color 0.2s,\n    transform 0.15s;\n  background: #f3f4f6;\n  color: #111827;\n  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n  font-weight: 500;\n}\n\n.btn:hover {\n  background: #e5e7eb;\n  color: #000000;\n}\n\n.btn.primary {\n  background: #4f46e5;\n  color: #ffffff;\n  font-weight: 500;\n}\n\n.btn.primary:hover {\n  background: #4338ca;\n  color: #ffffff;\n}\n\n.btn.danger {\n  background: #dc2626;\n  color: #ffffff;\n  font-weight: 500;\n}\n\n.btn.danger:hover {\n  background: #b91c1c;\n  color: #ffffff;\n}\n\n/* 10. 底部按钮组 */\n.button-group {\n  display: flex;\n  gap: 8px;\n  margin-top: 12px;\n  justify-content: flex-end;\n}\n\n/* 11. 分隔线 */\nhr {\n  border: none;\n  border-top: 1px solid #e5e7eb;\n  margin: 10px 0;\n}\n\n/* 12. 状态提示 */\n.status-message {\n  padding: 6px 10px;\n  border-radius: 4px;\n  font-size: 11px;\n  margin-bottom: 8px;\n}\n\n.status-message.success {\n  background: #d1fae5;\n  color: #065f46;\n  border: 1px solid #a7f3d0;\n}\n\n.status-message.error {\n  background: #fee2e2;\n  color: #991b1b;\n  border: 1px solid #fecaca;\n}\n\n.status-message.warning {\n  background: #fef3c7;\n  color: #92400e;\n  border: 1px solid #fde68a;\n}\n\n/* 14. 空状态 */\n.empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 20px;\n  color: #6b7280;\n  font-size: 11px;\n  text-align: center;\n}\n\n.empty-state svg {\n  width: 24px;\n  height: 24px;\n  margin-bottom: 8px;\n  opacity: 0.5;\n}\n\n/* 15. 滚动条美化 */\n.content-wrapper::-webkit-scrollbar {\n  width: 8px;\n}\n\n.content-wrapper::-webkit-scrollbar-track {\n  background: transparent;\n}\n\n.content-wrapper::-webkit-scrollbar-thumb {\n  background: #cbd5e1;\n  border-radius: 4px;\n}\n\n.content-wrapper::-webkit-scrollbar-thumb:hover {\n  background: #94a3b8;\n}\n\n.json-tree-box::-webkit-scrollbar {\n  width: 6px;\n}\n\n.json-tree-box::-webkit-scrollbar-track {\n  background: #f1f5f9;\n  border-radius: 3px;\n}\n\n.json-tree-box::-webkit-scrollbar-thumb {\n  background: #cbd5e1;\n  border-radius: 3px;\n}\n\n.json-tree-box::-webkit-scrollbar-thumb:hover {\n  background: #94a3b8;\n}\n\n/* 17. 规则操作按钮 */\n.rule-operations {\n  display: flex;\n  gap: 8px;\n  margin-top: 8px;\n}\n\n.rule-operations .btn {\n  flex: 1;\n  min-width: 60px;\n}\n\n/* 启用状态指示器 */\n.rule-status {\n  margin-left: 8px;\n  font-size: 11px;\n  color: #6b7280;\n  display: flex;\n  align-items: center;\n  gap: 4px;\n}\n\n.status-indicator {\n  width: 8px;\n  height: 8px;\n  border-radius: 50%;\n  background: #ef4444;\n}\n\n.status-indicator.enabled {\n  background: #10b981;\n}\n\n.rule-name-container {\n  display: flex;\n  align-items: center;\n}\n\n/* 启用开关 */\n.toggle-switch {\n  position: relative;\n  width: 44px;\n  height: 22px;\n}\n\n.toggle-switch input {\n  opacity: 0;\n  width: 0;\n  height: 0;\n}\n\n.toggle-label {\n  position: absolute;\n  cursor: pointer;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: #e5e7eb;\n  transition: 0.3s;\n  border-radius: 22px;\n}\n\n.toggle-label:before {\n  position: absolute;\n  content: \'\';\n  height: 16px;\n  width: 16px;\n  left: 3px;\n  bottom: 3px;\n  background-color: white;\n  transition: 0.3s;\n  border-radius: 50%;\n}\n\ninput:checked + .toggle-label {\n  background-color: #10b981;\n}\n\ninput:checked + .toggle-label:before {\n  transform: translateX(40px);\n}\n\n.btn.small {\n  padding: 3px 8px;\n  font-size: 11px;\n}\n\n.rule-list-controls {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 12px;\n}\n\n.import-export-buttons {\n  display: flex;\n  gap: 8px;\n}\n\n.sort-controls {\n  display: flex;\n  gap: 8px;\n}\n\n/* 更新范围限制的样式 */\n.range-limit-inputs {\n  display: flex;\n  gap: 8px;\n  flex: 1;\n}\n\n.input-group {\n  display: flex;\n  align-items: center;\n  flex: 1;\n  gap: 4px;\n  min-width: 0;\n}\n\n.input-label {\n  font-size: 11px;\n  color: #111827;\n  min-width: 28px;\n  white-space: nowrap;\n  font-weight: 500;\n}\n\n.range-limit-inputs input {\n  flex: 1;\n  padding: 4px 6px;\n  border: 1px solid #e5e7eb;\n  border-radius: 4px;\n  font-size: 11px;\n  min-width: 0;\n}\n\n/* handle 区域样式更新 */\n.handle-area {\n  margin-top: 16px;\n}\n\n.handle-area-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 12px;\n}\n\n.handle-editor {\n  margin-bottom: 16px;\n  padding: 12px;\n  background: #f9fafb;\n  border: 1px solid #e5e7eb;\n  border-radius: 6px;\n}\n\n.handle-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 8px;\n  padding-bottom: 8px;\n  border-bottom: 1px solid #e5e7eb;\n  cursor: pointer;\n  user-select: none;\n}\n\n.handle-name-input {\n  font-weight: bold;\n  border: 1px solid #d1d5db;\n  border-radius: 4px;\n  padding: 4px 8px;\n  width: auto;\n  min-width: 120px;\n  color: #111827; /* 更深的颜色使文字更清晰 */\n  cursor: text;\n}\n\n.handle-name-input:focus {\n  outline: none;\n  border-color: #6366f1;\n  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15);\n}\n\n.handle-actions {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.fold-indicator {\n  font-size: 16px;\n  font-weight: bold;\n  color: #6b7280;\n  transition: transform 0.2s;\n  cursor: pointer;\n}\n\n.dsl-builder {\n  margin: 8px 0;\n}\n\n.dsl-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 6px;\n}\n\n.dsl-header label {\n  font-size: 12px;\n  font-weight: 600;\n  color: #111827;\n}\n\n.dsl-preview input {\n  width: 100%;\n  padding: 6px 8px;\n  border: 1px solid #e5e7eb;\n  border-radius: 4px;\n  font-size: 11px;\n  background: #f8fafc;\n  cursor: pointer;\n  color: #111827;\n  font-weight: 500;\n}\n\n.dsl-preview input:hover {\n  background: #f1f5f9;\n}\n\n/* 规则列表中的 handle 显示 */\n.handle-list {\n  margin: 12px 0;\n}\n\n.handle-list .handle-item {\n  margin-bottom: 8px;\n  padding: 8px;\n  background: #f8fafc;\n  border: 1px solid #e2e8f0;\n  border-radius: 4px;\n}\n\n.handle-expression {\n  margin: 4px 0;\n  font-size: 11px;\n  color: #111827;\n  overflow-x: auto;\n  word-break: break-all;\n}\n\n.handle-expression strong {\n  color: #000000;\n  font-weight: 600;\n}\n\n/* 规则详情显示 */\n.rule-details {\n  margin-bottom: 12px;\n  font-size: 12px;\n  color: #111827;\n}\n\n.rule-details div {\n  margin: 4px 0;\n  color: #111827;\n}\n\n/* 响应式调整 */\n@media (max-width: 768px) {\n  .sticky-tabs {\n    padding: 0;\n  }\n\n  .tabs-container {\n    padding: 10px 12px 6px;\n    gap: 4px;\n  }\n\n  .tabs-container button {\n    padding: 6px 10px;\n    font-size: 12px;\n  }\n\n  .content-wrapper {\n    padding: 0 12px 12px;\n  }\n\n  .range-limit-inputs {\n    flex-direction: column;\n    gap: 2px;\n  }\n\n  .input-group {\n    min-width: calc(50% - 4px);\n  }\n}\n'],sourceRoot:''}]);const l=r},8521:(e,n,t)=>{t.d(n,{e:()=>a});const a={INSERT_BY_OBJECT:'era:insertByObject',UPDATE_BY_OBJECT:'era:updateByObject',DELETE_BY_OBJECT:'era:deleteByObject',GET_SNAPSHOT_AT_MK:'era:getSnapshotAtMk',FORCE_SYNC:'era:forceSync',SYNC_MODE:{AUTO:'auto',FULL:'full',LATEST:'latest',ROLLBACK_TO:'rollbackTo'}}},8586:(e,n,t)=>{var a=t(6678);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(4424).A)('5df0e246',a,!1,{ssrId:!0})},8838:(e,n,t)=>{var a=t(8386);a.__esModule&&(a=a.default),'string'==typeof a&&(a=[[e.id,a,'']]),a.locals&&(e.exports=a.locals);(0,t(4424).A)('797c7b8f',a,!1,{ssrId:!0})},8840:(e,n,t)=>{t.d(n,{G:()=>o});var a=t(5241);class o{data;pathInfos=[];foundContexts=[];maxWildcardOrdinal=0;constructor(e){this.data=e}getContexts(e){return this.parseExpressionStructure(e),0===this.maxWildcardOrdinal?[new Map]:(this.resolveWildcards(1,new Map),this.foundContexts)}expand(e){return this.getContexts(e).map(n=>{let t=e;return this.pathInfos.forEach(e=>{t=t.replace(e.originalPath,this.reconstructPath(e,n))}),t})}parseExpressionStructure(e){this.pathInfos=[],this.foundContexts=[],this.maxWildcardOrdinal=0;e.match(/\$\[([^\]]+)\]/g)?.forEach(e=>{const n=e.slice(2,-1).split('.'),t=new Map;let a=0;n.forEach((e,n)=>{'*'===e&&(a++,t.set(n,a))}),this.pathInfos.push({originalPath:e,segments:n,wildcardOrdinalMap:t}),a>this.maxWildcardOrdinal&&(this.maxWildcardOrdinal=a)})}resolveWildcards(e,n){if(e>this.maxWildcardOrdinal)return void this.foundContexts.push(new Map(n));const t=this.pathInfos.filter(n=>n.wildcardOrdinalMap.size>=e);if(0===t.length)return void this.resolveWildcards(e+1,n);const o=t[0],A=this.getPathPrefixSegments(o,e,n),r=(0,a.Em)(this.data,A);if('object'!=typeof r||null===r)return;const l=Object.keys(r).filter(o=>t.every(t=>{const A=this.getPathPrefixSegments(t,e,n),r=(0,a.Em)(this.data,A);if(!r||'object'!=typeof r||!Object.prototype.hasOwnProperty.call(r,o))return!1;let l=-1;for(const[n,a]of t.wildcardOrdinalMap)if(a===e){l=n;break}let i=t.segments.length;for(const[n,a]of t.wildcardOrdinalMap)a>e&&n<i&&(i=n);const d=[...A,o];for(let e=l+1;e<i;e++)d.push(t.segments[e]);return void 0!==(0,a.Em)(this.data,d)}));for(const t of l){const a=new Map(n);a.set(e,t),this.resolveWildcards(e+1,a)}}getPathPrefixSegments(e,n,t){let a=-1;for(const[t,o]of e.wildcardOrdinalMap.entries())if(o===n){a=t;break}if(-1===a)return[];const o=[];for(let n=0;n<a;n++){const a=e.segments[n];if('*'===a){const a=e.wildcardOrdinalMap.get(n);o.push(t.get(a))}else o.push(a)}return o}reconstructPath(e,n){return`$[${e.segments.map((t,a)=>{if('*'===t){const t=e.wildcardOrdinalMap.get(a);return n.get(t)}return t}).join('.')}]`}}},9068:(e,n,t)=>{t.r(n),t.d(n,{default:()=>l});var a=t(1314),o=t.n(a),A=t(5378),r=t.n(A)()(o());r.push([e.id,'.dsl-builder-modal[data-v-799db43a]{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1000}.dsl-builder-content[data-v-799db43a]{background:#fff;width:90%;max-width:1000px;height:85vh;border-radius:8px;display:flex;flex-direction:column;overflow:hidden}.dsl-header[data-v-799db43a]{display:flex;justify-content:space-between;align-items:center;padding:16px;background:#f8fafc;border-bottom:1px solid #e2e8f0}.dsl-builder-body[data-v-799db43a]{display:flex;flex:1;min-height:0;overflow:hidden}.dsl-components[data-v-799db43a]{flex:0 0 40%;padding:16px;overflow-y:auto;border-right:1px solid #e2e8f0;background:#f9fafb}.component-section[data-v-799db43a]{margin-bottom:20px}.component-section h4[data-v-799db43a]{margin:0 0 8px 0;font-size:13px;color:#111827;font-weight:600}.path-selection-row[data-v-799db43a]{display:flex;gap:8px;align-items:center;margin-bottom:8px}.path-dropdown-container[data-v-799db43a]{flex:1}.path-dropdown[data-v-799db43a]{width:100%;padding:4px 6px;border:1px solid #e5e7eb;border-radius:4px;font-size:12px;color:#111827;background:#fff !important;-webkit-text-fill-color:#111827 !important}.operator-grid[data-v-799db43a]{display:grid;grid-template-columns:repeat(2,1fr);gap:6px;margin-bottom:8px}.operator-grid.three-columns[data-v-799db43a]{grid-template-columns:repeat(3,1fr)}.value-input[data-v-799db43a]{display:flex;gap:6px;align-items:center}.value-input input[data-v-799db43a],.value-input select[data-v-799db43a]{flex:1;padding:4px 6px;border:1px solid #e5e7eb;border-radius:4px;font-size:12px;color:#111827;background:#fff !important;-webkit-text-fill-color:#111827 !important}.selected-path[data-v-799db43a]{margin-top:8px;padding:6px;background:#e8f4fd;border:1px solid #b3d4fc;border-radius:4px;font-size:11px;color:#0369a1;font-weight:500}.dsl-preview-area[data-v-799db43a]{flex:0 0 60%;padding:16px;display:flex;flex-direction:column;gap:16px;overflow-y:auto}.expression-preview[data-v-799db43a],.expression-editor[data-v-799db43a]{font-size:15px;background:#fff;border:1px solid #e2e8f0;border-radius:6px;padding:12px}.expression-preview.readable[data-v-799db43a]{background:#f0fdf4;border-color:#bbf7d0}.preview-header[data-v-799db43a]{display:flex;align-items:center;gap:8px;margin-bottom:8px;font-size:13px;color:#374151}.preview-header .hint[data-v-799db43a]{font-size:11px;color:#6b7280;font-weight:normal}.expression-display[data-v-799db43a]{padding:10px;background:#f8fafc;border-radius:4px;font-family:"Monaco","Menlo","Ubuntu Mono",monospace;font-size:12px;overflow-x:auto;white-space:pre-wrap;word-break:break-all}.readable-text[data-v-799db43a]{background:rgba(0,0,0,0);color:#15803d;font-weight:600;font-size:14px;line-height:1.5}.expression-raw[data-v-799db43a]{font-size:11px;color:#111827}.expression-raw pre[data-v-799db43a]{margin:0;padding:8px;background:#f3f4f6;border-radius:4px;overflow-x:auto;white-space:pre-wrap;word-break:break-all;color:#4b5563;font-weight:500}.expression-editor textarea[data-v-799db43a]{width:100%;padding:8px;border:1px solid #e5e7eb;border-radius:4px;font-family:"Monaco","Menlo","Ubuntu Mono",monospace;font-size:12px;resize:vertical;background:#fff !important;color:#111827 !important;-webkit-text-fill-color:#111827 !important}.editor-actions[data-v-799db43a]{display:flex;gap:8px;margin-top:8px}.dsl-actions[data-v-799db43a]{display:flex;gap:8px;margin-top:16px;justify-content:flex-end}.btn[data-v-799db43a]{padding:5px 12px;border:none;border-radius:6px;font-size:12px;cursor:pointer;transition:all .2s;background:#f3f4f6;color:#111827;box-shadow:0 1px 2px 0 rgba(0,0,0,.05);font-weight:500}.btn[data-v-799db43a]:hover{background:#e5e7eb;color:#000}.btn.small[data-v-799db43a]{padding:3px 8px;font-size:11px}.btn.primary[data-v-799db43a]{background:#4f46e5;color:#fff;font-weight:500}.btn.primary[data-v-799db43a]:hover{background:#4338ca;color:#fff}.btn.danger[data-v-799db43a]{background:#dc2626;color:#fff;font-weight:500}.btn.danger[data-v-799db43a]:hover{background:#b91c1c;color:#fff}@media (max-width:768px){.dsl-builder-body[data-v-799db43a]{flex-direction:column}.dsl-components[data-v-799db43a],.dsl-preview-area[data-v-799db43a]{flex:none;width:100%;height:auto;max-height:50%;overflow-y:auto}.dsl-components[data-v-799db43a]{border-right:none;border-bottom:1px solid #e2e8f0}.operator-grid[data-v-799db43a]{grid-template-columns:repeat(3,1fr)}.path-selection-row[data-v-799db43a]{flex-direction:column;align-items:stretch}}.light-theme[data-v-799db43a]{background:#fff !important;color:#111827 !important;-webkit-text-fill-color:#111827 !important}','',{version:3,sources:['webpack://./src/ERA助手/UI/components/DSL/DSLBuilderModal.vue'],names:[],mappings:'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',sourcesContent:['\n.dsl-builder-modal {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.dsl-builder-content {\n  background: white;\n  width: 90%;\n  max-width: 1000px;\n  height: 85vh; /* 稍微增加高度以容纳新区域 */\n  border-radius: 8px;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n}\n\n.dsl-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px;\n  background: #f8fafc;\n  border-bottom: 1px solid #e2e8f0;\n}\n\n.dsl-builder-body {\n  display: flex;\n  flex: 1;\n  min-height: 0;\n  overflow: hidden;\n}\n\n.dsl-components {\n  flex: 0 0 40%;\n  padding: 16px;\n  overflow-y: auto;\n  border-right: 1px solid #e2e8f0;\n  background: #f9fafb;\n}\n\n.component-section {\n  margin-bottom: 20px;\n}\n\n.component-section h4 {\n  margin: 0 0 8px 0;\n  font-size: 13px;\n  color: #111827;\n  font-weight: 600;\n}\n\n.path-selection-row {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n  margin-bottom: 8px;\n}\n\n.path-dropdown-container {\n  flex: 1;\n}\n\n.path-dropdown {\n  width: 100%;\n  padding: 4px 6px;\n  border: 1px solid #e5e7eb;\n  border-radius: 4px;\n  font-size: 12px;\n  color: #111827;\n  background: white !important;\n  -webkit-text-fill-color: #111827 !important;\n}\n\n.operator-grid {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 6px;\n  margin-bottom: 8px;\n}\n\n/* 新增：三列布局 */\n.operator-grid.three-columns {\n  grid-template-columns: repeat(3, 1fr);\n}\n\n.value-input {\n  display: flex;\n  gap: 6px;\n  align-items: center;\n}\n\n.value-input input,\n.value-input select {\n  flex: 1;\n  padding: 4px 6px;\n  border: 1px solid #e5e7eb;\n  border-radius: 4px;\n  font-size: 12px;\n  color: #111827;\n  background: white !important;\n  -webkit-text-fill-color: #111827 !important;\n}\n\n.selected-path {\n  margin-top: 8px;\n  padding: 6px;\n  background: #e8f4fd;\n  border: 1px solid #b3d4fc;\n  border-radius: 4px;\n  font-size: 11px;\n  color: #0369a1;\n  font-weight: 500;\n}\n\n.dsl-preview-area {\n  flex: 0 0 60%;\n  padding: 16px;\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n  overflow-y: auto;\n}\n\n.expression-preview,\n.expression-editor {\n  font-size: 15px;\n  background: white;\n  border: 1px solid #e2e8f0;\n  border-radius: 6px;\n  padding: 12px;\n}\n\n/* 新增：可读预览样式 */\n.expression-preview.readable {\n  background: #f0fdf4; /* 浅绿色背景 */\n  border-color: #bbf7d0;\n}\n\n.preview-header {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 8px;\n  font-size: 13px;\n  color: #374151;\n}\n\n.preview-header .hint {\n  font-size: 11px;\n  color: #6b7280;\n  font-weight: normal;\n}\n\n.expression-display {\n  padding: 10px;\n  background: #f8fafc;\n  border-radius: 4px;\n  font-family: \'Monaco\', \'Menlo\', \'Ubuntu Mono\', monospace;\n  font-size: 12px;\n  overflow-x: auto;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.readable-text {\n  background: transparent;\n  color: #15803d; /* 深绿色文字 */\n  font-weight: 600;\n  font-size: 14px;\n  line-height: 1.5;\n}\n\n.expression-raw {\n  font-size: 11px;\n  color: #111827;\n}\n\n.expression-raw pre {\n  margin: 0;\n  padding: 8px;\n  background: #f3f4f6;\n  border-radius: 4px;\n  overflow-x: auto;\n  white-space: pre-wrap;\n  word-break: break-all;\n  color: #4b5563;\n  font-weight: 500;\n}\n\n.expression-editor textarea {\n  width: 100%;\n  padding: 8px;\n  border: 1px solid #e5e7eb;\n  border-radius: 4px;\n  font-family: \'Monaco\', \'Menlo\', \'Ubuntu Mono\', monospace;\n  font-size: 12px;\n  resize: vertical;\n  background: white !important;\n  color: #111827 !important;\n  -webkit-text-fill-color: #111827 !important;\n}\n\n.editor-actions {\n  display: flex;\n  gap: 8px;\n  margin-top: 8px;\n}\n\n.dsl-actions {\n  display: flex;\n  gap: 8px;\n  margin-top: 16px;\n  justify-content: flex-end;\n}\n\n.btn {\n  padding: 5px 12px;\n  border: none;\n  border-radius: 6px;\n  font-size: 12px;\n  cursor: pointer;\n  transition: all 0.2s;\n  background: #f3f4f6;\n  color: #111827;\n  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n  font-weight: 500;\n}\n\n.btn:hover {\n  background: #e5e7eb;\n  color: #000000;\n}\n\n.btn.small {\n  padding: 3px 8px;\n  font-size: 11px;\n}\n\n.btn.primary {\n  background: #4f46e5;\n  color: #ffffff;\n  font-weight: 500;\n}\n\n.btn.primary:hover {\n  background: #4338ca;\n  color: #ffffff;\n}\n\n.btn.danger {\n  background: #dc2626;\n  color: #ffffff;\n  font-weight: 500;\n}\n\n.btn.danger:hover {\n  background: #b91c1c;\n  color: #ffffff;\n}\n\n@media (max-width: 768px) {\n  .dsl-builder-body {\n    flex-direction: column;\n  }\n\n  .dsl-components,\n  .dsl-preview-area {\n    flex: none;\n    width: 100%;\n    height: auto;\n    max-height: 50%;\n    overflow-y: auto;\n  }\n\n  .dsl-components {\n    border-right: none;\n    border-bottom: 1px solid #e2e8f0;\n  }\n\n  .operator-grid {\n    grid-template-columns: repeat(3, 1fr);\n  }\n\n  .path-selection-row {\n    flex-direction: column;\n    align-items: stretch;\n  }\n}\n\n/* 强制浅色主题 */\n.light-theme {\n  background: white !important;\n  color: #111827 !important;\n  -webkit-text-fill-color: #111827 !important;\n}\n'],sourceRoot:''}]);const l=r},9466:(e,n,t)=>{t.r(n),t.d(n,{default:()=>l});var a=t(1314),o=t.n(a),A=t(5378),r=t.n(A)()(o());r.push([e.id,'.dsl-tester-modal[data-v-6a116073]{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(15,23,42,.65);backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:1000}.dsl-tester-content[data-v-6a116073]{background:#fff;width:90%;max-width:1000px;height:85vh;border-radius:12px;display:flex;flex-direction:column;box-shadow:0 25px 50px -12px rgba(0,0,0,.25);overflow:hidden;border:1px solid hsla(0,0%,100%,.1)}.tester-header[data-v-6a116073]{height:60px;display:flex;justify-content:space-between;align-items:center;padding:0 20px;background:#fff;border-bottom:1px solid #e2e8f0;flex-shrink:0}.tester-header .header-left[data-v-6a116073]{display:flex;align-items:center;gap:12px}.tester-header .header-left h3[data-v-6a116073]{margin:0;font-size:16px;font-weight:700;color:#1e293b;letter-spacing:-0.02em}.tester-header .header-left .data-badge[data-v-6a116073]{background:#ecfdf5;color:#059669;font-size:11px;font-weight:600;padding:2px 8px;border-radius:99px;border:1px solid #a7f3d0}.tester-header .header-actions[data-v-6a116073]{display:flex;align-items:center;gap:10px}.tester-header .header-actions .divider[data-v-6a116073]{width:1px;height:24px;background:#e2e8f0;margin:0 4px}.tester-body[data-v-6a116073]{flex:1;display:flex;min-height:0;background:#f8fafc}.panel-left[data-v-6a116073]{flex:0 0 320px;display:flex;flex-direction:column;border-right:1px solid #e2e8f0;background:#fcfcfc}.panel-right[data-v-6a116073]{flex:1;display:flex;flex-direction:column;background:#1e1e1e;min-width:0}.panel-header[data-v-6a116073]{height:40px;padding:0 16px;font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.05em;color:#64748b;border-bottom:1px solid #e2e8f0;display:flex;justify-content:space-between;align-items:center;background:#fff;flex-shrink:0}.panel-header .count-badge[data-v-6a116073]{background:#f1f5f9;color:#64748b;padding:1px 6px;border-radius:4px;font-size:10px}.panel-header .clear-btn[data-v-6a116073]{background:none;border:none;color:#666;font-size:11px;cursor:pointer}.panel-header .clear-btn[data-v-6a116073]:hover{color:#fff}.panel-right .panel-header[data-v-6a116073]{background:#252526;border-bottom:1px solid #333;color:#858585}.rules-container[data-v-6a116073]{flex:1;overflow-y:auto;padding:12px}.rule-card[data-v-6a116073]{background:#fff;border:1px solid #e2e8f0;border-radius:6px;padding:10px;margin-bottom:8px;transition:all .2s;cursor:default}.rule-card[data-v-6a116073]:hover{border-color:#cbd5e1;box-shadow:0 2px 4px rgba(0,0,0,.02)}.rule-card .rule-header[data-v-6a116073]{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}.rule-card .rule-header .rule-name[data-v-6a116073]{font-weight:600;font-size:13px;color:#1e293b;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:200px}.rule-card .rule-header .status-dot[data-v-6a116073]{width:6px;height:6px;border-radius:50%;background:#cbd5e1;flex-shrink:0}.rule-card .rule-header .status-dot.active[data-v-6a116073]{background:#10b981;box-shadow:0 0 0 2px rgba(16,185,129,.15)}.rule-card .rule-detail .path-code[data-v-6a116073]{display:block;font-family:"Menlo",monospace;font-size:10px;background:#f1f5f9;padding:3px 6px;border-radius:3px;color:#64748b;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.output-container[data-v-6a116073]{flex:1;overflow-y:auto;padding:0;position:relative}.output-container[data-v-6a116073]::-webkit-scrollbar{width:10px;height:10px}.output-container[data-v-6a116073]::-webkit-scrollbar-track{background:#1e1e1e}.output-container[data-v-6a116073]::-webkit-scrollbar-thumb{background:#424242;border-radius:5px;border:2px solid #1e1e1e}.output-container[data-v-6a116073]::-webkit-scrollbar-thumb:hover{background:#4f4f4f}.console-output[data-v-6a116073]{margin:0;padding:16px;font-family:"JetBrains Mono","Consolas",monospace;font-size:13px;line-height:1.6;color:#d4d4d4;white-space:pre-wrap;word-wrap:break-word}.empty-state[data-v-6a116073],.empty-result[data-v-6a116073]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;color:#64748b;font-size:13px;gap:8px;-webkit-user-select:none;user-select:none}.empty-result[data-v-6a116073]{color:#52525b}.empty-result .icon-placeholder[data-v-6a116073]{font-size:24px;opacity:.5}.btn[data-v-6a116073]{height:32px;padding:0 14px;border-radius:6px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s;border:1px solid rgba(0,0,0,0);display:inline-flex;align-items:center;gap:6px;white-space:nowrap}.btn.primary[data-v-6a116073]{background:#6366f1;color:#fff}.btn.primary[data-v-6a116073]:hover{background:#5558e0}.btn.primary[data-v-6a116073]:disabled{background:#94a3b8;cursor:not-allowed;opacity:.7}.close-btn[data-v-6a116073]{width:32px;height:32px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:none;color:#64748b;cursor:pointer;border-radius:6px;transition:all .2s}.close-btn[data-v-6a116073]:hover{background:#f1f5f9;color:#ef4444}[data-v-6a116073] .file-import-export{display:inline-block}[data-v-6a116073] .file-import-export button{height:32px;padding:0 14px;border-radius:6px;font-size:13px;background:#fff;border:1px solid #e2e8f0;color:#1e293b;cursor:pointer;transition:all .2s}[data-v-6a116073] .file-import-export button:hover{background:#f8fafc;border-color:#cbd5e1}@media (max-width:768px){.tester-body[data-v-6a116073]{flex-direction:column}.panel-left[data-v-6a116073]{flex:0 0 40%;border-right:none;border-bottom:1px solid #e2e8f0}.panel-right[data-v-6a116073]{flex:1}.tester-header[data-v-6a116073]{padding:0 12px}.header-left h3[data-v-6a116073]{font-size:14px}.btn[data-v-6a116073]{padding:0 10px;font-size:12px}}','',{version:3,sources:['webpack://./src/ERA助手/UI/components/DSL/DSLTesterModal.vue'],names:[],mappings:'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',sourcesContent:['\n/* 变量定义 */\n$border-color: #e2e8f0;\n$bg-color: #f8fafc;\n$primary-color: #6366f1;\n$text-main: #1e293b;\n$text-sub: #64748b;\n$header-height: 60px;\n\n.dsl-tester-modal {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(15, 23, 42, 0.65);\n  backdrop-filter: blur(4px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.dsl-tester-content {\n  background: white;\n  width: 90%;\n  max-width: 1000px;\n  height: 85vh; /* 增加高度 */\n  border-radius: 12px;\n  display: flex;\n  flex-direction: column;\n  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);\n  overflow: hidden;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n/* Header & Toolbar */\n.tester-header {\n  height: $header-height;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0 20px;\n  background: white;\n  border-bottom: 1px solid $border-color;\n  flex-shrink: 0;\n\n  .header-left {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n\n    h3 {\n      margin: 0;\n      font-size: 16px;\n      font-weight: 700;\n      color: $text-main;\n      letter-spacing: -0.02em;\n    }\n\n    .data-badge {\n      background: #ecfdf5;\n      color: #059669;\n      font-size: 11px;\n      font-weight: 600;\n      padding: 2px 8px;\n      border-radius: 99px;\n      border: 1px solid #a7f3d0;\n    }\n  }\n\n  .header-actions {\n    display: flex;\n    align-items: center;\n    gap: 10px;\n\n    .divider {\n      width: 1px;\n      height: 24px;\n      background: $border-color;\n      margin: 0 4px;\n    }\n  }\n}\n\n/* Body */\n.tester-body {\n  flex: 1;\n  display: flex;\n  min-height: 0;\n  background: $bg-color;\n}\n\n/* Left Panel */\n.panel-left {\n  flex: 0 0 320px;\n  display: flex;\n  flex-direction: column;\n  border-right: 1px solid $border-color;\n  background: #fcfcfc;\n}\n\n/* Right Panel */\n.panel-right {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  background: #1e1e1e; /* Dark theme for console */\n  min-width: 0;\n}\n\n.panel-header {\n  height: 40px;\n  padding: 0 16px;\n  font-size: 12px;\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 0.05em;\n  color: $text-sub;\n  border-bottom: 1px solid $border-color;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  background: white;\n  flex-shrink: 0;\n\n  .count-badge {\n    background: #f1f5f9;\n    color: $text-sub;\n    padding: 1px 6px;\n    border-radius: 4px;\n    font-size: 10px;\n  }\n\n  .clear-btn {\n    background: none;\n    border: none;\n    color: #666;\n    font-size: 11px;\n    cursor: pointer;\n    &:hover {\n      color: #fff;\n    }\n  }\n}\n\n.panel-right .panel-header {\n  background: #252526;\n  border-bottom: 1px solid #333;\n  color: #858585;\n}\n\n/* Rules List */\n.rules-container {\n  flex: 1;\n  overflow-y: auto;\n  padding: 12px;\n}\n\n.rule-card {\n  background: white;\n  border: 1px solid $border-color;\n  border-radius: 6px;\n  padding: 10px;\n  margin-bottom: 8px;\n  transition: all 0.2s;\n  cursor: default;\n\n  &:hover {\n    border-color: #cbd5e1;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.02);\n  }\n\n  .rule-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 6px;\n\n    .rule-name {\n      font-weight: 600;\n      font-size: 13px;\n      color: $text-main;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      max-width: 200px;\n    }\n\n    .status-dot {\n      width: 6px;\n      height: 6px;\n      border-radius: 50%;\n      background: #cbd5e1;\n      flex-shrink: 0;\n\n      &.active {\n        background: #10b981;\n        box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.15);\n      }\n    }\n  }\n\n  .rule-detail {\n    .path-code {\n      display: block;\n      font-family: \'Menlo\', monospace;\n      font-size: 10px;\n      background: #f1f5f9;\n      padding: 3px 6px;\n      border-radius: 3px;\n      color: #64748b;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n  }\n}\n\n/* Output Area */\n.output-container {\n  flex: 1;\n  overflow-y: auto;\n  padding: 0;\n  position: relative;\n\n  /* 自定义滚动条 (Dark) */\n  &::-webkit-scrollbar {\n    width: 10px;\n    height: 10px;\n  }\n  &::-webkit-scrollbar-track {\n    background: #1e1e1e;\n  }\n  &::-webkit-scrollbar-thumb {\n    background: #424242;\n    border-radius: 5px;\n    border: 2px solid #1e1e1e;\n  }\n  &::-webkit-scrollbar-thumb:hover {\n    background: #4f4f4f;\n  }\n}\n\n.console-output {\n  margin: 0;\n  padding: 16px;\n  font-family: \'JetBrains Mono\', \'Consolas\', monospace;\n  font-size: 13px;\n  line-height: 1.6;\n  color: #d4d4d4;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n}\n\n.empty-state,\n.empty-result {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  color: $text-sub;\n  font-size: 13px;\n  gap: 8px;\n  user-select: none;\n}\n\n.empty-result {\n  color: #52525b;\n  .icon-placeholder {\n    font-size: 24px;\n    opacity: 0.5;\n  }\n}\n\n/* Buttons & Controls */\n.btn {\n  height: 32px;\n  padding: 0 14px;\n  border-radius: 6px;\n  font-size: 13px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s;\n  border: 1px solid transparent;\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  white-space: nowrap;\n\n  &.primary {\n    background: $primary-color;\n    color: white;\n    &:hover {\n      background: #5558e0;\n    }\n    &:disabled {\n      background: #94a3b8;\n      cursor: not-allowed;\n      opacity: 0.7;\n    }\n  }\n}\n\n.close-btn {\n  width: 32px;\n  height: 32px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: transparent;\n  border: none;\n  color: $text-sub;\n  cursor: pointer;\n  border-radius: 6px;\n  transition: all 0.2s;\n\n  &:hover {\n    background: #f1f5f9;\n    color: #ef4444; /* Red on hover for close */\n  }\n}\n\n/* 针对 FileImportExport 组件的样式覆盖 */\n:deep(.file-import-export) {\n  display: inline-block;\n}\n:deep(.file-import-export button) {\n  height: 32px;\n  padding: 0 14px;\n  border-radius: 6px;\n  font-size: 13px;\n  background: white;\n  border: 1px solid $border-color;\n  color: $text-main;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n:deep(.file-import-export button:hover) {\n  background: #f8fafc;\n  border-color: #cbd5e1;\n}\n\n/* Responsive */\n@media (max-width: 768px) {\n  .tester-body {\n    flex-direction: column;\n  }\n  .panel-left {\n    flex: 0 0 40%;\n    border-right: none;\n    border-bottom: 1px solid $border-color;\n  }\n  .panel-right {\n    flex: 1;\n  }\n  .tester-header {\n    padding: 0 12px;\n  }\n  .header-left h3 {\n    font-size: 14px;\n  }\n  .btn {\n    padding: 0 10px;\n    font-size: 12px;\n  }\n}\n'],sourceRoot:''}]);const l=r},9731:(e,n,t)=>{t.r(n),t.d(n,{default:()=>l});var a=t(1314),o=t.n(a),A=t(5378),r=t.n(A)()(o());r.push([e.id,'.config-container[data-v-20e294dc]{margin-top:15px;padding:12px;background:#f8f9fa;border-radius:6px}.collapsible-section[data-v-20e294dc]{margin-bottom:15px;border:1px solid #e5e7eb;border-radius:6px;overflow:hidden}.section-header[data-v-20e294dc]{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;background:#fff;cursor:pointer;-webkit-user-select:none;user-select:none;font-weight:500;color:#111827;font-size:14px}.header-actions[data-v-20e294dc]{display:flex;align-items:center;gap:8px}.refresh-btn[data-v-20e294dc]{background:#f3f4f6;border:1px solid #e5e7eb;border-radius:4px;padding:2px 6px;cursor:pointer;display:flex;align-items:center}.refresh-btn[data-v-20e294dc]:hover{background:#e5e7eb}.refresh-icon[data-v-20e294dc]{font-size:14px}.subsection-header[data-v-20e294dc]{display:flex;justify-content:space-between;align-items:center;padding:8px 0;cursor:pointer;-webkit-user-select:none;user-select:none;font-weight:500;color:#4b5563}.toggle-icon[data-v-20e294dc]{font-size:18px;font-weight:bold}.section-content[data-v-20e294dc]{padding:12px;background:#f9fafb}.config-section[data-v-20e294dc]{margin-bottom:15px}.config-section[data-v-20e294dc]:last-child{margin-bottom:0}.config-section h5[data-v-20e294dc]{margin:0 0 8px 0;font-size:13px;color:#4b5563}.entry-list .entry-item[data-v-20e294dc]{display:flex;gap:6px;margin-bottom:6px}.entry-list .entry-item[data-v-20e294dc]:last-child{margin-bottom:10px}.entry-list .entry-select[data-v-20e294dc],.entry-list .regex-input[data-v-20e294dc]{flex:1;padding:4px 8px;border:1px solid #e5e7eb;border-radius:4px;font-size:12px;background:#fff}.entry-list .entry-select.light-theme[data-v-20e294dc],.entry-list .regex-input.light-theme[data-v-20e294dc]{background:#fff !important;color:#000 !important}.entry-list .regex-input[data-v-20e294dc]{font-weight:600}.entry-list .btn[data-v-20e294dc]{padding:4px 8px;border:none;border-radius:4px;cursor:pointer;font-size:12px;transition:background .2s}.entry-list .btn.add-btn[data-v-20e294dc]{background:#6366f1;color:#fff}.entry-list .btn.add-btn[data-v-20e294dc]:hover{background:#4f46e5}.entry-list .btn.remove-btn[data-v-20e294dc]{background:#ef4444;color:#fff;width:24px;padding:0}.entry-list .btn.remove-btn[data-v-20e294dc]:hover{background:#dc2626}.actions[data-v-20e294dc]{display:flex;justify-content:flex-end;gap:6px;margin-top:15px}.actions .btn[data-v-20e294dc]{padding:4px 10px;border:none;border-radius:4px;font-size:11px;cursor:pointer;transition:all .2s;background:#f3f4f6;color:#111827;box-shadow:0 1px 2px 0 rgba(0,0,0,.05);font-weight:500;display:inline-flex;align-items:center;gap:3px}.actions .btn.primary[data-v-20e294dc]{background:#4f46e5;color:#fff;font-weight:500}.actions .btn.primary[data-v-20e294dc]:hover:not(:disabled){background:#4338ca;color:#fff}.actions .btn.danger[data-v-20e294dc]{background:#ef4444;color:#fff}.actions .btn.danger[data-v-20e294dc]:hover:not(:disabled){background:#dc2626}.actions .btn[data-v-20e294dc]:hover:not(.disabled){background:#e5e7eb;color:#000}.actions .btn.disabled[data-v-20e294dc]{opacity:.6;cursor:not-allowed}','',{version:3,sources:['webpack://./src/ERA助手/UI/components/WorldInfoAndRegexConfig.vue'],names:[],mappings:'AACA,mCACE,eAAA,CACA,YAAA,CACA,kBAAA,CACA,iBAAA,CAGF,sCACE,kBAAA,CACA,wBAAA,CACA,iBAAA,CACA,eAAA,CAGF,iCACE,YAAA,CACA,6BAAA,CACA,kBAAA,CACA,gBAAA,CACA,eAAA,CACA,cAAA,CACA,wBAAA,CAAA,gBAAA,CACA,eAAA,CACA,aAAA,CACA,cAAA,CAGF,iCACE,YAAA,CACA,kBAAA,CACA,OAAA,CAGF,8BACE,kBAAA,CACA,wBAAA,CACA,iBAAA,CACA,eAAA,CACA,cAAA,CACA,YAAA,CACA,kBAAA,CAEA,oCACE,kBAAA,CAIJ,+BACE,cAAA,CAGF,oCACE,YAAA,CACA,6BAAA,CACA,kBAAA,CACA,aAAA,CACA,cAAA,CACA,wBAAA,CAAA,gBAAA,CACA,eAAA,CACA,aAAA,CAGF,8BACE,cAAA,CACA,gBAAA,CAGF,kCACE,YAAA,CACA,kBAAA,CAGF,iCACE,kBAAA,CAEA,4CACE,eAAA,CAGF,oCACE,gBAAA,CACA,cAAA,CACA,aAAA,CAKF,yCACE,YAAA,CACA,OAAA,CACA,iBAAA,CAEA,oDACE,kBAAA,CAIJ,qFAEE,MAAA,CACA,eAAA,CACA,wBAAA,CACA,iBAAA,CACA,cAAA,CACA,eAAA,CAGF,6GAEE,0BAAA,CACA,qBAAA,CAGF,0CACE,eAAA,CAGF,kCACE,eAAA,CACA,WAAA,CACA,iBAAA,CACA,cAAA,CACA,cAAA,CACA,yBAAA,CAEA,0CACE,kBAAA,CACA,UAAA,CAEA,gDACE,kBAAA,CAIJ,6CACE,kBAAA,CACA,UAAA,CACA,UAAA,CACA,SAAA,CAEA,mDACE,kBAAA,CAMR,0BACE,YAAA,CACA,wBAAA,CACA,OAAA,CACA,eAAA,CAEA,+BACE,gBAAA,CACA,WAAA,CACA,iBAAA,CACA,cAAA,CACA,cAAA,CACA,kBAAA,CACA,kBAAA,CACA,aAAA,CACA,sCAAA,CACA,eAAA,CACA,mBAAA,CACA,kBAAA,CACA,OAAA,CAEA,uCACE,kBAAA,CACA,UAAA,CACA,eAAA,CAEA,4DACE,kBAAA,CACA,UAAA,CAIJ,sCACE,kBAAA,CACA,UAAA,CAEA,2DACE,kBAAA,CAIJ,oDACE,kBAAA,CACA,UAAA,CAGF,wCACE,UAAA,CACA,kBAAA',sourcesContent:['\n.config-container {\n  margin-top: 15px;\n  padding: 12px;\n  background: #f8f9fa;\n  border-radius: 6px;\n}\n\n.collapsible-section {\n  margin-bottom: 15px;\n  border: 1px solid #e5e7eb;\n  border-radius: 6px;\n  overflow: hidden;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 8px 12px;\n  background: #ffffff;\n  cursor: pointer;\n  user-select: none;\n  font-weight: 500;\n  color: #111827;\n  font-size: 14px;\n}\n\n.header-actions {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.refresh-btn {\n  background: #f3f4f6;\n  border: 1px solid #e5e7eb;\n  border-radius: 4px;\n  padding: 2px 6px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n\n  &:hover {\n    background: #e5e7eb;\n  }\n}\n\n.refresh-icon {\n  font-size: 14px;\n}\n\n.subsection-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 8px 0;\n  cursor: pointer;\n  user-select: none;\n  font-weight: 500;\n  color: #4b5563;\n}\n\n.toggle-icon {\n  font-size: 18px;\n  font-weight: bold;\n}\n\n.section-content {\n  padding: 12px;\n  background: #f9fafb;\n}\n\n.config-section {\n  margin-bottom: 15px;\n\n  &:last-child {\n    margin-bottom: 0;\n  }\n\n  h5 {\n    margin: 0 0 8px 0;\n    font-size: 13px;\n    color: #4b5563;\n  }\n}\n\n.entry-list {\n  .entry-item {\n    display: flex;\n    gap: 6px;\n    margin-bottom: 6px;\n\n    &:last-child {\n      margin-bottom: 10px;\n    }\n  }\n\n  .entry-select,\n  .regex-input {\n    flex: 1;\n    padding: 4px 8px;\n    border: 1px solid #e5e7eb;\n    border-radius: 4px;\n    font-size: 12px;\n    background: white;\n  }\n\n  .entry-select.light-theme,\n  .regex-input.light-theme {\n    background: white !important;\n    color: black !important;\n  }\n\n  .regex-input {\n    font-weight: 600; // 加深字体\n  }\n\n  .btn {\n    padding: 4px 8px;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 12px;\n    transition: background 0.2s;\n\n    &.add-btn {\n      background: #6366f1;\n      color: white;\n\n      &:hover {\n        background: #4f46e5;\n      }\n    }\n\n    &.remove-btn {\n      background: #ef4444;\n      color: white;\n      width: 24px;\n      padding: 0;\n\n      &:hover {\n        background: #dc2626;\n      }\n    }\n  }\n}\n\n.actions {\n  display: flex;\n  justify-content: flex-end;\n  gap: 6px;\n  margin-top: 15px;\n\n  .btn {\n    padding: 4px 10px;\n    border: none;\n    border-radius: 4px;\n    font-size: 11px;\n    cursor: pointer;\n    transition: all 0.2s;\n    background: #f3f4f6;\n    color: #111827;\n    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n    font-weight: 500;\n    display: inline-flex;\n    align-items: center;\n    gap: 3px;\n\n    &.primary {\n      background: #4f46e5;\n      color: #ffffff;\n      font-weight: 500;\n\n      &:hover:not(:disabled) {\n        background: #4338ca;\n        color: #ffffff;\n      }\n    }\n\n    &.danger {\n      background: #ef4444;\n      color: white;\n\n      &:hover:not(:disabled) {\n        background: #dc2626;\n      }\n    }\n\n    &:hover:not(.disabled) {\n      background: #e5e7eb;\n      color: #000000;\n    }\n\n    &.disabled {\n      opacity: 0.6;\n      cursor: not-allowed;\n    }\n  }\n}\n'],sourceRoot:''}]);const l=r},9761:(e,n,t)=>{t.d(n,{j:()=>a});const a=new class{prefix;constructor(e='[app] '){this.prefix=e}log(...e){console.log(`%c🗒️ ${this.prefix}`,'color: green; font-weight: bold;',...e)}debug(...e){console.debug(`%c⚙️ ${this.prefix}`,'color: orange; font-weight: bold;',...e)}info(...e){console.info(`%cℹ️ ${this.prefix}`,'color: blue; font-weight: bold;',...e)}warn(...e){console.warn(`%c⚠️ ${this.prefix}`,'color: orange; font-weight: bold;',...e)}error(...e){console.error(`%c❌ ${this.prefix}`,'color: red; font-weight: bold;',...e)}}('[EraHelperLog]: ')}},t={};function a(e){var o=t[e];if(void 0!==o)return o.exports;var A=t[e]={id:e,exports:{}};return n[e](A,A.exports,a),A.exports}a.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return a.d(n,{a:n}),n},a.d=(e,n)=>{for(var t in n)a.o(n,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},a.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),a.r=e=>{'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})};var o=a(3035),A=a(4061);var r=a(1400);const l={},i=(0,r.A)(l,[['render',function(e,n){const t=(0,A.resolveComponent)('RouterView');return(0,A.openBlock)(),(0,A.createBlock)(t)}]]);var d=a(688);function s(){const e=getScriptId();$(`head > div[script_id="${e}"]`).remove();const n=$('<div>').attr('script_id',e).append($(document).find('head > style').clone());$('head').append(n)}var c=a(4167);const p=async(e,n,t,a,o,A)=>{let r;console.log('Before RegisterMacro'),SillyTavern.registerMacro('lastUserMessage',()=>e),console.log('After RegisterMacro');try{A&&(console.log('切换预设',A),r=(await window.SillyTavern.executeSlashCommands('/profile')).pipe,await window.SillyTavern.executeSlashCommands(`/profile ${A}`)),await window.EjsTemplate.refreshWorldInfo(),await new Promise(e=>setTimeout(e,1e3));return await generate({user_input:e,injects:n,max_chat_history:t,should_stream:a,...o&&{custom_api:{apiurl:o.baseURL,key:o.apiKey,model:o.modelName,temperature:Number(o.temperature),frequency_penalty:Number(o.frequencyPenalty),presence_penalty:Number(o.presencePenalty),max_tokens:Number(o.maxTokens)}}})}finally{A&&await window.SillyTavern.executeSlashCommands(`/profile ${r}`)}};var C=a(6328);var u=a(8521),f=a(9761),m=a(7021);const b=()=>window.AsyncAnalyzeStore,g=(0,A.computed)(()=>!!b()?.isAsync),v=(0,A.computed)(()=>!!b()?.isUpdateEra),x=(0,A.computed)(()=>g.value?g.value&&!v.value?[...b()?.updateRores||[],...b()?.analyzeRores||[]]:b()?.ignoreRores:b()?.analyzeRores),h=(0,A.computed)(()=>b()?.regexList),k=(0,A.ref)(!1),E=(0,A.computed)(()=>b()?.modelSource),y=(0,A.computed)(()=>b()?.customModelSettings),w=(0,A.computed)(()=>b()?.profileSetting),B=async e=>{if(0!=getLastMessageId()&&0!=e&&g.value)if(v.value)toastr.warning('已有正在处理的分步分析');else{if(C.a.getMessageById(e).length<200)throw toastr.error('空回了喵~请重roll喵~'),new Error('空回了喵~请重roll喵~');toastr.info('开始分步分析，等待era事件完成'),f.j.info('开始分步分析，等待era事件完成'),b().isUpdateEra=!0,await F()}},N=async e=>{if(g.value)return void f.j.info('处于分步分析模式,跳过接收消息时的处理');const n=getChatMessages(e)[0].message,t=await V(n);await setChatMessages([{message_id:e,message:t}])};async function V(e){const n=e.match(/<VariableEdit>((?:(?!<VariableEdit>)[\s\S])*?)<\/VariableEdit>(?![\s\S]*<VariableEdit>[\s\S]*<\/VariableEdit>)/);if(n&&n[1])try{const t=JSON.parse(n[1]),a=await window.EraEditStore.getStatData();if(null==a)return toastr.error('快照数据为空,跳过处理'),e;const o=window.EraDataStore.eraDataRule,{data:A}=await m.$.applyRule(t,a,o),r=JSON.stringify(A);e=e.replace(/<VariableEdit>[\s\S]*?<\/VariableEdit>/,`<VariableEdit>\n${r}\n</VariableEdit>`)}catch(e){f.j.error('变量更新失败：',e),toastr.error('变量更新失败')}return e}const F=async()=>{if(!v.value)return toastr.warning('[isUpdateEra]标识异常'),void f.j.error('[isUpdateEra]标识异常');var e;await(e=1e3,Promise.race([new Promise(n=>setTimeout(n,e))]));try{toastr.info('正在构建提示词并请求AI分析'),f.j.info('正在构建提示词并请求AI分析');const e='本次不生成故事，处理ERA变量',n=2,t=!1,a=[{id:'1145141919',position:'in_chat',depth:0,should_scan:!1,role:'user',content:e}];f.j.log('模型来源: ',E.value);const o='sample'==E.value?await p(e,a,n,t,null,null):'profile'==E.value?await p(e,a,n,t,null,w.value):await p(e,a,n,t,y.value,null);f.j.log('接收到的分析结果原文: ',o),await async function(e){if(e.length<200)throw toastr.error('接收的分析结果为空，哈！'),new Error('接收的分析结果为空，哈！');const n=[];h.value.forEach(t=>{const a=new RegExp(t,'gi');e.match(a)&&n.push(a)}),await C.a.removeContentByRegex(getLastMessageId(),n),e=await V(e);let t='';n.map(n=>{t+=e.match(n)?.join('')??''}),await C.a.mergeContentToMessage(getLastMessageId(),t)}(o),toastr.success('分步分析处理完成')}catch(e){toastr.error('分步分析处理失败'),f.j.error('分步分析处理失败: ',e)}finally{await eventEmit(u.e.FORCE_SYNC),b().isUpdateEra=!1}},S=async e=>{f.j.log('WORLDINFO_ENTRIES_LOADED: ',e),await c.X.removeLoresByArray(e,x.value,k.value)};var j=a(5114);const D=VueRouter,G={key:0,class:'mask'},I={class:'card'},O={class:'top-button-group'},M={class:'router-view-container'},U={class:'content'},T=(0,A.defineComponent)({__name:'Layout',setup(e){const n=(0,d.n)(),t=(0,A.computed)(()=>n.showUI),a=(0,D.useRouter)(),o=(0,D.useRoute)(),r=(0,A.ref)(o.path);(0,A.watch)(()=>o.path,e=>{r.value=e});const l=()=>{n.showUI=!1},i=e=>{a.push(e)};return(e,n)=>{const a=(0,A.resolveComponent)('router-view');return t.value?((0,A.openBlock)(),(0,A.createElementBlock)('div',G,[(0,A.createElementVNode)('div',I,[(0,A.createCommentVNode)(' 顶部按钮组 '),(0,A.createElementVNode)('div',O,[(0,A.createElementVNode)('button',{class:(0,A.normalizeClass)(['btn',{active:'/AsyncAnalyze'===r.value}]),onClick:n[0]||(n[0]=e=>i('/AsyncAnalyze'))},[...n[4]||(n[4]=[(0,A.createElementVNode)('span',{class:'btn-text'},'📊分步分析配置',-1)])],2),(0,A.createElementVNode)('button',{class:(0,A.normalizeClass)(['btn',{active:'/EraDataHandle'===r.value}]),onClick:n[1]||(n[1]=e=>i('/EraDataHandle'))},[...n[5]||(n[5]=[(0,A.createElementVNode)('span',{class:'btn-text'},'⚙️Era规则配置',-1)])],2),(0,A.createElementVNode)('button',{class:(0,A.normalizeClass)(['btn',{active:'/EraDataEdit'===r.value}]),onClick:n[2]||(n[2]=e=>i('/EraDataEdit'))},[...n[6]||(n[6]=[(0,A.createElementVNode)('span',{class:'btn-text'},'📝Era变量编辑',-1)])],2),(0,A.createElementVNode)('button',{class:(0,A.normalizeClass)(['btn',{active:'/Version'===r.value}]),onClick:n[3]||(n[3]=e=>i('/Version'))},[...n[7]||(n[7]=[(0,A.createElementVNode)('span',{class:'btn-text'},'🍎版本信息',-1)])],2),(0,A.createCommentVNode)('        <button'),(0,A.createCommentVNode)('          v-if="true"'),(0,A.createCommentVNode)('          class="btn"'),(0,A.createCommentVNode)('          :class="{ active: currentRoute === \'/tempTest\' }"'),(0,A.createCommentVNode)('          @click="goToRoute(\'/tempTest\')"'),(0,A.createCommentVNode)('        >'),(0,A.createCommentVNode)('          <span class="btn-text">临时测试</span>'),(0,A.createCommentVNode)('        </button>')]),(0,A.createCommentVNode)(' 关闭按钮 '),(0,A.createElementVNode)('button',{class:'close-x',title:'关闭',onClick:l},'×'),(0,A.createCommentVNode)(' 新增：专门的 router-view 容器区域 '),(0,A.createElementVNode)('div',M,[(0,A.createCommentVNode)(' 内容区 '),(0,A.createElementVNode)('div',U,[(0,A.createVNode)(a)])])])])):(0,A.createCommentVNode)('v-if',!0)}}});a(1e3);const R=(0,r.A)(T,[['__scopeId','data-v-8bc54d56']]),Y=(0,D.createRouter)({history:(0,D.createMemoryHistory)(),routes:[{path:'/',component:R,redirect:'/AsyncAnalyze',children:[{path:'/AsyncAnalyze',name:'AsyncAnalyze',component:()=>Promise.resolve().then(a.bind(a,2431))},{path:'/EraDataHandle',name:'EraDataHandle',component:()=>Promise.resolve().then(a.bind(a,7200))},{path:'/EraDataEdit',name:'EraDataEdit',component:()=>Promise.resolve().then(a.bind(a,4558))},{path:'/tempTest',name:'tempTest',component:()=>Promise.resolve().then(a.bind(a,4208))},{path:'/Version',name:'Version',component:()=>Promise.resolve().then(a.bind(a,3722))}]}]});var L=a(6584),J=a(7664);let W=null,P=null;function q(){f.j.log('unloadUI','UI 脚本开始卸载'),W&&(f.j.debug('unmountVueApp','卸载 Vue 实例'),W.unmount(),W=null),$(`head > div[script_id="${getScriptId()}"]`).remove(),P&&(f.j.debug('unloadUI','销毁挂载点'),$(`div#era-ui-mount-point-${getScriptId()}`).remove(),P=null),window.removeEventListener('pagehide',q),f.j.log('unloadUI','UI 脚本卸载完成'),eventClearAll()}$(()=>{f.j.log('initialize','UI 脚本开始初始化'),P=$('<div>').attr('id',`era-ui-mount-point-${getScriptId()}`).css({position:'fixed',bottom:'20px',left:'20px','z-index':1e4}),f.j.debug('$(document).ready','创建挂载点',P),$('body').append(P),f.j.debug('$(document).ready','挂载点已添加到 body'),W=(0,A.createApp)(i);const e=(0,o.createPinia)();W.use(e),W.use(Y),W.mount(P[0]),f.j.debug('initialize','正在初始化 store 实例'),window.UiStore=(0,d.n)(e),window.AsyncAnalyzeStore=(0,j.$)(e),(0,j.$)().getModelSettings(),(0,j.$)().getWorldInfoFilterConfig(),(0,j.$)().getRegexConfig(),window.EraDataStore=(0,L.D)(e),(0,L.D)().getEraDataRules(),window.EraEditStore=(0,J.l)(e),s(),f.j.debug('initialize','Vue App 已挂载，样式已传送'),Y.afterEach(()=>{setTimeout(()=>{s()},50)}),window.removeEventListener('pagehide',q),window.addEventListener('pagehide',q),eventOn(tavern_events.WORLDINFO_ENTRIES_LOADED,S),eventOn(tavern_events.MESSAGE_RECEIVED,B),eventOn(tavern_events.MESSAGE_RECEIVED,N)}),$(()=>{replaceScriptButtons([{name:'🐱ERA助手',visible:!0},{name:'🍬重新分析变量',visible:!0}]),eventOn(getButtonEvent('🐱ERA助手'),()=>{(0,d.n)().showUI=!(0,d.n)().showUI}),eventOn(getButtonEvent('🍬重新分析变量'),async()=>{await(async()=>{if(0==getLastMessageId())return void toastr.warning('请不要重算0层变量','你在干嘛😡');toastr.info('开始变量重算，等待era事件完成');const e=b().isAsync;try{toastr.info('正在将era回滚到上次更新'),await eventEmit('era:forceSync',{mode:'rollbackTo',message_id:getLastMessageId()-1}),b().isUpdateEra=!0,g.value||(toastr.info('临时开启分步分析模式'),b().isAsync=!0),await F()}catch(e){toastr.error('分步分析处理失败'),f.j.error('分步分析处理失败: ',e),await eventEmit('era:forceSync')}finally{b().isAsync=e,b().isUpdateEra=!1}})()})});
//# sourceMappingURL=index.js.map
